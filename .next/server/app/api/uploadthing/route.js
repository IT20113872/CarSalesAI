(()=>{var a={};a.id=735,a.ids=[735],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8704:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{HTTPAccessErrorStatus:function(){return c},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return e},getAccessFallbackErrorTypeByStatus:function(){return h},getAccessFallbackHTTPStatus:function(){return g},isHTTPAccessFallbackError:function(){return f}});let c={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},d=new Set(Object.values(c)),e="NEXT_HTTP_ERROR_FALLBACK";function f(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===e&&d.has(Number(c))}function g(a){return Number(a.digest.split(";")[1])}function h(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29163:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});var d=c(96330);let e=globalThis.prisma||new d.PrismaClient},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31162:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=c(8704),e=c(49026);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},33231:(a,b,c)=>{"use strict";c.d(b,{CI:()=>k,Y9:()=>i,j2:()=>l});var d=c(25546),e=c(73560),f=c(56056),g=c(16467),h=c(29163);let{handlers:i,signIn:j,signOut:k,auth:l}=(0,d.Ay)({adapter:(0,g.y)(h.z),providers:[(0,e.A)({clientId:process.env.GITHUB_CLIENT_ID,clientSecret:process.env.GITHUB_CLIENT_SECRET}),(0,f.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],events:{async createUser({user:a}){if(!a.email)return;let b=a.email.split("@")[0];try{await h.z.company.create({data:{userId:a.id,name:b,location:"Default Location",about:"Default about text",logo:"/logo.png",website:`https://${b}.com`}}),await h.z.user.update({where:{id:a.id},data:{onboardingCompleted:!0}})}catch(a){console.error("Error creating default company:",a)}}},callbacks:{session:async({session:a,user:b})=>(a.user&&(a.user.id=b.id,a.user.userType=b.userType,a.user.onboardingCompleted=b.onboardingCompleted),a)}})},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},49026:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{REDIRECT_ERROR_CODE:function(){return e},RedirectType:function(){return f},isRedirectError:function(){return g}});let d=c(52836),e="NEXT_REDIRECT";var f=function(a){return a.push="push",a.replace="replace",a}({});function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,f]=b,g=b.slice(2,-2).join(";"),h=Number(b.at(-2));return c===e&&("replace"===f||"push"===f)&&"string"==typeof g&&!isNaN(h)&&h in d.RedirectStatusCode}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},51846:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BailoutToCSRError:function(){return d},isBailoutToCSRError:function(){return e}});let c="BAILOUT_TO_CLIENT_SIDE_RENDERING";class d extends Error{constructor(a){super("Bail out to client-side rendering: "+a),this.reason=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===c}},52637:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isPostpone",{enumerable:!0,get:function(){return d}});let c=Symbol.for("react.postpone");function d(a){return"object"==typeof a&&null!==a&&a.$$typeof===c}},55511:a=>{"use strict";a.exports=require("crypto")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66169:(a,b,c)=>{"use strict";c.d(b,{J:()=>f});var d=c(39916),e=c(33231);async function f(){let a=await (0,e.j2)();return a?.user?a.user:(0,d.redirect)("/login")}},66946:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(30898),e=c(42471),f=c(47912);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},68687:(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;c.r(b),c.d(b,{handler:()=>Qc,patchFetch:()=>Qb,routeModule:()=>P7,serverHooks:()=>Qa,workAsyncStorage:()=>P8,workUnitAsyncStorage:()=>P9});var A,B,C={};c.r(C),c.d(C,{LoggerTypeId:()=>O0,add:()=>O2,addEffect:()=>O3,addScoped:()=>O4,batched:()=>O9,defaultLogger:()=>Pr,filterLogLevel:()=>O7,isLogger:()=>PE,json:()=>Pz,jsonLogger:()=>Ps,logFmt:()=>PA,logfmtLogger:()=>Pt,make:()=>O1,map:()=>O8,mapInput:()=>O5,mapInputOptions:()=>O6,minimumLogLevel:()=>PD,none:()=>Pd,pretty:()=>PB,prettyLogger:()=>Pv,prettyLoggerDefault:()=>Pw,remove:()=>Pe,replace:()=>Pf,replaceEffect:()=>Pg,replaceScoped:()=>Ph,simple:()=>Pi,stringLogger:()=>Pu,structured:()=>PC,structuredLogger:()=>Px,succeed:()=>Pj,sync:()=>Pk,test:()=>Pl,tracerLogger:()=>Py,withConsoleError:()=>Pc,withConsoleLog:()=>Pa,withLeveledConsole:()=>Pb,withMinimumLogLevel:()=>Pm,withSpanAnnotations:()=>Pn,zip:()=>Po,zipLeft:()=>Pp,zipRight:()=>Pq});var D={};c.r(D),c.d(D,{GET:()=>P5,POST:()=>P6});var E=c(96559),F=c(48088),G=c(37719),H=c(26191),I=c(81289),J=c(261),K=c(92603),L=c(39893),M=c(14823),N=c(47220),O=c(66946),P=c(47912),Q=c(99786),R=c(46143),S=c(86439),T=c(43365),U="7.7.3";let V=a=>{console.warn(`⚠️ [uploadthing][deprecated] ${a}`)},W=function(a,b){if("function"==typeof a)return function(){return a(arguments)?b.apply(this,arguments):a=>b(a,...arguments)};switch(a){case 0:case 1:throw RangeError(`Invalid arity ${a}`);case 2:return function(a,c){return arguments.length>=2?b(a,c):function(c){return b(c,a)}};case 3:return function(a,c,d){return arguments.length>=3?b(a,c,d):function(d){return b(d,a,c)}};case 4:return function(a,c,d,e){return arguments.length>=4?b(a,c,d,e):function(e){return b(e,a,c,d)}};case 5:return function(a,c,d,e,f){return arguments.length>=5?b(a,c,d,e,f):function(f){return b(f,a,c,d,e)}};default:return function(){if(arguments.length>=a)return b.apply(this,arguments);let c=arguments;return function(a){return b(a,...c)}}}},X=a=>a,Y=a=>()=>a,Z=Y(!0),$=Y(!1),_=Y(void 0);function aa(a,b,c,d,e,f,g,h,i){switch(arguments.length){case 1:return a;case 2:return b(a);case 3:return c(b(a));case 4:return d(c(b(a)));case 5:return e(d(c(b(a))));case 6:return f(e(d(c(b(a)))));case 7:return g(f(e(d(c(b(a))))));case 8:return h(g(f(e(d(c(b(a)))))));case 9:return i(h(g(f(e(d(c(b(a))))))));default:{let a=arguments[0];for(let b=1;b<arguments.length;b++)a=arguments[b](a);return a}}}let ab=()=>"3.16.8",ac=`effect/GlobalValue/globalStoreId/${ab()}`,ad=(a,b)=>(d||(globalThis[ac]??=new Map,d=globalThis[ac]),d.has(a)||d.set(a,b()),d.get(a)),ae=a=>"string"==typeof a,af=a=>"number"==typeof a,ag=a=>"boolean"==typeof a,ah=a=>"bigint"==typeof a,ai=a=>"symbol"==typeof a,aj=a=>void 0===a,ak=a=>void 0!==a,al=a=>null!==a,am=a=>!1,an=a=>"object"==typeof a&&null!==a,ao=a=>an(a)||"function"==typeof a,ap=W(2,(a,b)=>ao(a)&&b in a),aq=W(2,(a,b)=>ap(a,"_tag")&&a._tag===b),ar=a=>null!=a,as=a=>a instanceof Uint8Array,at=a=>a instanceof Date,au=a=>ap(a,Symbol.iterator),av=a=>an(a)&&!Array.isArray(a),aw=a=>ap(a,"then")&&"function"==typeof a.then,ax=((a,b)=>c=>a(c)||b(c),a=>`BUG: ${a} - please report an issue at https://github.com/Effect-TS/effect/issues`);Symbol.iterator;class ay{constructor(a){this.called=!1,this.self=a}next(a){return this.called?{value:a,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(a){return{value:a,done:!0}}throw(a){throw a}[Symbol.iterator](){return new ay(this.self)}}class az{constructor(a,b,c,d){return null==b&&null==a?(b=0xffffffff*Math.random()>>>0,a=0):null==b&&(b=a,a=0),null==d&&null==c?(d=this._state?this._state[3]:0xf767814f,c=this._state?this._state[2]:0x14057b7e):null==d&&(d=c,c=0),this._state=new Int32Array([0,0,c>>>0,(1|(d||0))>>>0]),this._next(),aA(this._state,this._state[0],this._state[1],a>>>0,b>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(a){this._state[0]=a[0],this._state[1]=a[1],this._state[2]=a[2],this._state[3]=1|a[3]}integer(a){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%a}number(){return(0x8000000*((0x3ffffff&this._next())*1)+(0x7ffffff&this._next())*1)/0x20000000000000}_next(){var a,b,c,d;let e,f,g,h,i=this._state[0]>>>0,j=this._state[1]>>>0;a=this._state,b=i,d=0x4c957f2d,e=((c=j)>>>16)*32557>>>0,f=(65535&c)*(d>>>16)>>>0,g=(65535&c)*(65535&d)>>>0,h=(c>>>16)*(d>>>16)+((f>>>16)+(e>>>16))>>>0,(g=g+(f=f<<16>>>0)>>>0)>>>0<f>>>0&&(h=h+1>>>0),(g=g+(e=e<<16>>>0)>>>0)>>>0<e>>>0&&(h=h+1>>>0),h=(h=h+Math.imul(c,0x5851f42d)>>>0)+Math.imul(b,d)>>>0,a[0]=h,a[1]=g,aA(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let k=i>>>18,l=(j>>>18|i<<14)>>>0;k=(k^i)>>>0;let m=((l=(l^j)>>>0)>>>27|k<<5)>>>0,n=i>>>27;return(m>>>n|m<<((-n>>>0&31)>>>0))>>>0}}function aA(a,b,c,d,e){let f=b+d>>>0,g=c+e>>>0;g>>>0<c>>>0&&(f=f+1|0),a[0]=f,a[1]=g}let aB=Symbol.for("effect/Utils/YieldWrap");class aC{#a;constructor(a){this.#a=a}[aB](){return this.#a}}function aD(a){if("object"==typeof a&&null!==a&&aB in a)return a[aB]();throw Error(ax("yieldWrapGet"))}let aE=ad("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),aF={effect_internal_function:a=>a()},aG=aF.effect_internal_function(()=>Error().stack)?.includes("effect_internal_function")===!0?aF.effect_internal_function:a=>a(),aH=(function*(){}).constructor,aI=ad(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),aJ=Symbol.for("effect/Hash"),aK=a=>{if(!0===aE.enabled)return 0;switch(typeof a){case"number":return aP(a);case"bigint":return aQ(a.toString(10));case"boolean":case"symbol":return aQ(String(a));case"string":return aQ(a);case"undefined":return aQ("undefined");case"function":case"object":if(null===a)return aQ("null");if(a instanceof Date)return aK(a.toISOString());if(a instanceof URL)return aK(a.href);else if(aO(a))return a[aJ]();else return aL(a);default:throw Error(`BUG: unhandled typeof ${typeof a} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},aL=a=>(aI.has(a)||aI.set(a,aP(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),aI.get(a)),aM=a=>b=>53*b^a,aN=a=>0xbfffffff&a|a>>>1&0x40000000,aO=a=>ap(a,aJ),aP=a=>{if(a!=a||a===1/0)return 0;let b=0|a;for(b!==a&&(b^=0xffffffff*a);a>0xffffffff;)b^=a/=0xffffffff;return aN(b)},aQ=a=>{let b=5381,c=a.length;for(;c;)b=33*b^a.charCodeAt(--c);return aN(b)},aR=a=>((a,b)=>{let c=12289;for(let d=0;d<b.length;d++)c^=aa(aQ(b[d]),aM(aK(a[b[d]])));return aN(c)})(a,Object.keys(a)),aS=a=>{let b=6151;for(let c=0;c<a.length;c++)b=aa(b,aM(aK(a[c])));return aN(b)},aT=function(){if(1==arguments.length){let a=arguments[0];return function(b){return Object.defineProperty(a,aJ,{value:()=>b,enumerable:!1}),b}}let a=arguments[0],b=arguments[1];return Object.defineProperty(a,aJ,{value:()=>b,enumerable:!1}),b},aU=Symbol.for("effect/Equal");function aV(){return 1==arguments.length?a=>aW(a,arguments[0]):aW(arguments[0],arguments[1])}function aW(a,b){if(a===b)return!0;let c=typeof a;if(c!==typeof b)return!1;if("object"===c||"function"===c){if(null!==a&&null!==b){if(aX(a)&&aX(b))if(aK(a)===aK(b)&&a[aU](b))return!0;else return!!aE.enabled&&!!aE.tester&&aE.tester(a,b);else if(a instanceof Date&&b instanceof Date)return a.toISOString()===b.toISOString();else if(a instanceof URL&&b instanceof URL)return a.href===b.href}if(aE.enabled){if(Array.isArray(a)&&Array.isArray(b))return a.length===b.length&&a.every((a,c)=>aW(a,b[c]));if(Object.getPrototypeOf(a)===Object.prototype&&Object.getPrototypeOf(a)===Object.prototype){let c=Object.keys(a),d=Object.keys(b);if(c.length===d.length){for(let d of c)if(!(d in b&&aW(a[d],b[d])))return!!aE.tester&&aE.tester(a,b);return!0}}return!!aE.tester&&aE.tester(a,b)}}return!!aE.enabled&&!!aE.tester&&aE.tester(a,b)}let aX=a=>ap(a,aU),aY=Symbol.for("nodejs.util.inspect.custom"),aZ=a=>{try{let b;if(ap(a,"toJSON")&&(b=a.toJSON,"function"==typeof b)&&0===a.toJSON.length)return a.toJSON();if(Array.isArray(a))return a.map(aZ)}catch{return{}}return a6(a)},a$=a=>JSON.stringify(a,null,2),a_={toJSON(){return aZ(this)},[aY](){return this.toJSON()},toString(){return a$(this.toJSON())}};class a0{[aY](){return this.toJSON()}toString(){return a$(this.toJSON())}}let a1=(a,b=2)=>{if("string"==typeof a)return a;try{return"object"==typeof a?a2(a,b):String(a)}catch{return String(a)}},a2=(a,b)=>{let c=[],d=JSON.stringify(a,(a,b)=>"object"==typeof b&&null!==b?c.includes(b)?void 0:c.push(b)&&(void 0!==a5.fiberRefs&&a4(b)?b[a3](a5.fiberRefs):b):b,b);return c=void 0,d},a3=Symbol.for("effect/Inspectable/Redactable"),a4=a=>"object"==typeof a&&null!==a&&a3 in a,a5=ad("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),a6=a=>a4(a)&&void 0!==a5.fiberRefs?a[a3](a5.fiberRefs):a,a7=(a,b)=>{switch(b.length){case 0:return a;case 1:return b[0](a);case 2:return b[1](b[0](a));case 3:return b[2](b[1](b[0](a)));case 4:return b[3](b[2](b[1](b[0](a))));case 5:return b[4](b[3](b[2](b[1](b[0](a)))));case 6:return b[5](b[4](b[3](b[2](b[1](b[0](a))))));case 7:return b[6](b[5](b[4](b[3](b[2](b[1](b[0](a)))))));case 8:return b[7](b[6](b[5](b[4](b[3](b[2](b[1](b[0](a))))))));case 9:return b[8](b[7](b[6](b[5](b[4](b[3](b[2](b[1](b[0](a)))))))));default:{let c=a;for(let a=0,d=b.length;a<d;a++)c=b[a](c);return c}}},a8="Async",a9="Commit",ba="Failure",bb="OnFailure",bc="OnSuccess",bd="OnSuccessAndFailure",be="Success",bf="Sync",bg="UpdateRuntimeFlags",bh="While",bi="Iterator",bj="WithRuntime",bk="Yield",bl="RevertFlags",bm=Symbol.for("effect/Effect"),bn=Symbol.for("effect/Stream"),bo=Symbol.for("effect/Sink"),bp=Symbol.for("effect/Channel"),bq={_R:a=>a,_E:a=>a,_A:a=>a,_V:ab()},br={[bm]:bq,[bn]:bq,[bo]:{_A:a=>a,_In:a=>a,_L:a=>a,_E:a=>a,_R:a=>a},[bp]:{_Env:a=>a,_InErr:a=>a,_InElem:a=>a,_InDone:a=>a,_OutErr:a=>a,_OutElem:a=>a,_OutDone:a=>a},[aU](a){return this===a},[aJ](){return aT(this,aL(this))},[Symbol.iterator](){return new ay(new aC(this))},pipe(){return a7(this,arguments)}},bs={[aJ](){return aT(this,aR(this))},[aU](a){let b=Object.keys(this),c=Object.keys(a);if(b.length!==c.length)return!1;for(let c of b)if(!(c in a&&aV(this[c],a[c])))return!1;return!0}},bt={...br,_op:a9},bu={...bt,...bs},bv=function(){function a(){}return a.prototype=bt,a}(),bw=function(){function a(){}return a.prototype=bu,a}(),bx=Symbol.for("effect/Option"),by={...br,[bx]:{_A:a=>a},[aY](){return this.toJSON()},toString(){return a$(this.toJSON())}},bz=Object.assign(Object.create(by),{_tag:"Some",_op:"Some",[aU](a){return bC(a)&&bE(a)&&aV(this.value,a.value)},[aJ](){return aT(this,aM(aK(this._tag))(aK(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:aZ(this.value)}}}),bA=aK("None"),bB=Object.assign(Object.create(by),{_tag:"None",_op:"None",[aU]:a=>bC(a)&&bD(a),[aJ]:()=>bA,toJSON(){return{_id:"Option",_tag:this._tag}}}),bC=a=>ap(a,bx),bD=a=>"None"===a._tag,bE=a=>"Some"===a._tag,bF=Object.create(bB),bG=a=>{let b=Object.create(bz);return b.value=a,b},bH=Symbol.for("effect/Context/Tag"),bI=Symbol.for("effect/Context/Reference"),bJ=Symbol.for("effect/STM"),bK={...br,_op:"Tag",[bJ]:bq,[bH]:{_Service:a=>a,_Identifier:a=>a},toString(){return a$(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[aY](){return this.toJSON()},of:a=>a,context(a){return bR(this,a)}},bL={...bK,[bI]:bI},bM=Symbol.for("effect/Context"),bN={[bM]:{_Services:a=>a},[aU](a){if(bP(a)&&this.unsafeMap.size===a.unsafeMap.size){for(let b of this.unsafeMap.keys())if(!a.unsafeMap.has(b)||!aV(this.unsafeMap.get(b),a.unsafeMap.get(b)))return!1;return!0}return!1},[aJ](){return aT(this,aP(this.unsafeMap.size))},pipe(){return a7(this,arguments)},toString(){return a$(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(aZ)}},[aY](){return this.toJSON()}},bO=a=>{let b=Object.create(bN);return b.unsafeMap=a,b},bP=a=>ap(a,bM),bQ=bO(new Map),bR=(a,b)=>bO(new Map([[a.key,b]])),bS=W(3,(a,b,c)=>{let d=new Map(a.unsafeMap);return d.set(b.key,c),bO(d)}),bT=ad("effect/Context/defaultValueCache",()=>new Map),bU=a=>{if(bT.has(a.key))return bT.get(a.key);let b=a.defaultValue();return bT.set(a.key,b),b},bV=W(2,(a,b)=>{if(!a.unsafeMap.has(b.key)){if(bI in b)return bU(b);throw(a=>{let b=Error(`Service not found${a.key?`: ${String(a.key)}`:""}`);if(a.stack){let c=a.stack.split("\n");if(c.length>2){let a=c[2].match(/at (.*)/);a&&(b.message=b.message+` (defined at ${a[1]})`)}}if(b.stack){let a=b.stack.split("\n");a.splice(1,3),b.stack=a.join("\n")}return b})(b)}return a.unsafeMap.get(b.key)}),bW=W(2,(a,b)=>a.unsafeMap.has(b.key)?bG(a.unsafeMap.get(b.key)):ap(b,bI)?bG(bU(b)):bF),bX=W(2,(a,b)=>{let c=new Map(a.unsafeMap);for(let[a,d]of b.unsafeMap)c.set(a,d);return bO(c)}),bY=a=>{let b=Error.stackTraceLimit;Error.stackTraceLimit=2;let c=Error();Error.stackTraceLimit=b;let d=Object.create(bK);return Object.defineProperty(d,"stack",{get:()=>c.stack}),d.key=a,d},bZ=a=>ap(a,bH),b$=a=>()=>{let b=Error.stackTraceLimit;Error.stackTraceLimit=2;let c=Error();function d(){}return Error.stackTraceLimit=b,Object.setPrototypeOf(d,bK),d.key=a,Object.defineProperty(d,"stack",{get:()=>c.stack}),d},b_=()=>(a,b)=>{let c=Error.stackTraceLimit;Error.stackTraceLimit=2;let d=Error();function e(){}return Error.stackTraceLimit=c,Object.setPrototypeOf(e,bL),e.key=a,e.defaultValue=b.defaultValue,Object.defineProperty(e,"stack",{get:()=>d.stack}),e},b0=bv,b1=bw;class b2 extends b0{}class b3 extends b1{}let b4=Symbol.for("effect/Micro"),b5=Symbol.for("effect/Micro/MicroExit"),b6=Symbol.for("effect/Micro/MicroCause"),b7={_E:X};class b8 extends globalThis.Error{constructor(a,b,c){let d,e,f,g=`MicroCause.${a}`;if(b instanceof globalThis.Error){d=`(${g}) ${b.name}`;let a=(e=b.message).split("\n").length;f=b.stack?`(${g}) ${b.stack.split("\n").slice(0,a+3).join("\n")}`:`${d}: ${e}`}else d=g,e=a1(b,0),f=`${d}: ${e}`;c.length>0&&(f+=`
    ${c.join("\n    ")}`),super(e),this._tag=a,this.traces=c,this[b6]=b7,this.name=d,this.stack=f}pipe(){return a7(this,arguments)}toString(){return this.stack}[aY](){return this.stack}}class b9 extends b8{constructor(a,b=[]){super("Fail",a,b),this.error=a}}let ca=(a,b=[])=>new b9(a,b);class cb extends b8{constructor(a,b=[]){super("Die",a,b),this.defect=a}}let cc=(a,b=[])=>new cb(a,b);class cd extends b8{constructor(a=[]){super("Interrupt","interrupted",a)}}let ce=(a=[])=>new cd(a),cf=a=>"Fail"===a._tag,cg=a=>"Interrupt"===a._tag,ch=W(2,(a,b)=>{let c=[...a.traces,b];switch(a._tag){case"Die":return cc(a.defect,c);case"Interrupt":return ce(c);case"Fail":return ca(a.error,c)}}),ci=Symbol.for("effect/Micro/MicroFiber"),cj={_A:X,_E:X};class ck{constructor(a,b=!0){this._stack=[],this._observers=[],this.currentOpCount=0,this._interrupted=!1,this._yielded=void 0,this.context=a,this.interruptible=b,this[ci]=cj}getRef(a){let b;return b=this.context,b.unsafeMap.has(a.key)?b.unsafeMap.get(a.key):bU(a)}addObserver(a){return this._exit?(a(this._exit),_):(this._observers.push(a),()=>{let b=this._observers.indexOf(a);b>=0&&this._observers.splice(b,1)})}unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(cR))}unsafePoll(){return this._exit}evaluate(a){if(this._exit)return;if(void 0!==this._yielded){let a=this._yielded;this._yielded=void 0,a()}let b=this.runLoop(a);if(b===cs)return;let c=cl.interruptChildren&&cl.interruptChildren(this);if(void 0!==c)return this.evaluate(cM(c,()=>b));this._exit=b;for(let a=0;a<this._observers.length;a++)this._observers[a](b);this._observers.length=0}runLoop(a){let b=!1,c=a;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!b&&this.getRef(c$).shouldYield(this)){b=!0;let a=c;c=cM(cD,()=>a)}if((c=c[co](this))===cs){let a=this._yielded;if(b5 in a)return this._yielded=void 0,a;return cs}}}catch(a){if(!ap(c,co))return cS(`MicroFiber.runLoop: Not a valid effect: ${String(c)}`);return cS(a)}}getCont(a){for(;;){let b=this._stack.pop();if(!b)return;let c=b[cr]&&b[cr](this);if(c)return{[a]:c};if(b[a])return b}}yieldWith(a){return this._yielded=a,cs}children(){return this._children??=new Set}}let cl=ad("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),cm=Symbol.for("effect/Micro/identifier"),cn=Symbol.for("effect/Micro/args"),co=Symbol.for("effect/Micro/evaluate"),cp=Symbol.for("effect/Micro/successCont"),cq=Symbol.for("effect/Micro/failureCont"),cr=Symbol.for("effect/Micro/ensureCont"),cs=Symbol.for("effect/Micro/Yield"),ct={...br,_op:"Micro",[b4]:{_A:X,_E:X,_R:X},pipe(){return a7(this,arguments)},[Symbol.iterator](){return new ay(new aC(this))},toJSON(){return{_id:"Micro",op:this[cm],...cn in this?{args:this[cn]}:void 0}},toString(){return a$(this)},[aY](){return a$(this)}};function cu(a){return cS("Micro.evaluate: Not implemented")}let cv=a=>({...ct,[cm]:a.op,[co]:a.eval??cu,[cp]:a.contA,[cq]:a.contE,[cr]:a.ensure}),cw=a=>{let b=cv(a);return function(){let c=Object.create(b);return c[cn]=!1===a.single?arguments:arguments[0],c}},cx=a=>{let b={...cv(a),[b5]:b5,_tag:a.op,get[a.prop](){return this[cn]},toJSON(){return{_id:"MicroExit",_tag:a.op,[a.prop]:this[cn]}},[aU](b){return cP(b)&&b._tag===a.op&&aV(this[cn],b[cn])},[aJ](){return aT(this,aM(aQ(a.op))(aK(this[cn])))}};return function(a){let c=Object.create(b);return c[cn]=a,c[cp]=void 0,c[cq]=void 0,c[cr]=void 0,c}},cy=cx({op:"Success",prop:"value",eval(a){let b=a.getCont(cp);return b?b[cp](this[cn],a):a.yieldWith(this)}}),cz=cx({op:"Failure",prop:"cause",eval(a){let b=a.getCont(cq);for(;cg(this[cn])&&b&&a.interruptible;)b=a.getCont(cq);return b?b[cq](this[cn],a):a.yieldWith(this)}}),cA=a=>cz(ca(a)),cB=cw({op:"Sync",eval(a){let b=this[cn](),c=a.getCont(cp);return c?c[cp](b,a):a.yieldWith(cQ(b))}}),cC=cw({op:"Suspend",eval(a){return this[cn]()}}),cD=cw({op:"Yield",eval(a){let b=!1;return a.getRef(c$).scheduleTask(()=>{b||a.evaluate(cU)},this[cn]??0),a.yieldWith(()=>{b=!0})}})(0),cE=cy(void 0),cF=a=>cI(function(b,c){a(c).then(a=>b(cy(a)),a=>b(cS(a)))},0!==a.length),cG=a=>cI(function(b,c){try{a.try(c).then(a=>b(cy(a)),c=>b(cA(a.catch(c))))}catch(c){b(cA(a.catch(c)))}},0!==a.try.length),cH=cw({op:"WithMicroFiber",eval(a){return this[cn](a)}}),cI=cw({op:"Async",single:!1,eval(a){let b=this[cn][0],c=!1,d=!1,e=this[cn][1]?new AbortController:void 0,f=b(b=>{c||(c=!0,d?a.evaluate(b):d=b)},e?.signal);return!1!==d?d:(d=!0,a._yielded=()=>{c=!0},void 0===e&&void 0===f||a._stack.push(cJ(()=>(c=!0,e?.abort(),f??cU))),cs)}}),cJ=cw({op:"AsyncFinalizer",ensure(a){a.interruptible&&(a.interruptible=!1,a._stack.push(da(!0)))},contE(a,b){return cg(a)?cM(this[cn](),()=>cz(a)):cz(a)}}),cK=(...a)=>cC(()=>cL(1===a.length?a[0]():a[1].call(a[0]))),cL=cw({op:"Iterator",contA(a,b){let c=this[cn].next(a);return c.done?cy(c.value):(b._stack.push(this),aD(c.value))},eval(a){return this[cp](void 0,a)}}),cM=W(2,(a,b)=>{let c=Object.create(cN);return c[cn]=a,c[cp]=b,c}),cN=cv({op:"OnSuccess",eval(a){return a._stack.push(this),this[cn]}}),cO=W(2,(a,b)=>cM(a,a=>cy(b(a)))),cP=a=>ap(a,b5),cQ=cy,cR=cz(ce()),cS=a=>cz(cc(a)),cT=a=>"Failure"===a._tag,cU=cQ(void 0),cV="setImmediate"in globalThis?globalThis.setImmediate:a=>setTimeout(a,0);class cW{scheduleTask(a,b){this.tasks.push(a),this.running||(this.running=!0,cV(this.afterScheduled))}runTasks(){let a=this.tasks;this.tasks=[];for(let b=0,c=a.length;b<c;b++)a[b]()}shouldYield(a){return a.currentOpCount>=a.getRef(cZ)}flush(){for(;this.tasks.length>0;)this.runTasks()}constructor(){this.tasks=[],this.running=!1,this.afterScheduled=()=>{this.running=!1,this.runTasks()}}}let cX=W(2,(a,b)=>cH(c=>{let d=c.context;return c.context=b(d),c7(a,()=>(c.context=d,cE))})),cY=W(2,(a,b)=>cX(a,bX(b)));class cZ extends b_()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class c$ extends b_()("effect/Micro/currentScheduler",{defaultValue:()=>new cW}){}let c_=W(2,(a,b)=>{let c=Object.create(c0);return c[cn]=a,c[cq]=b,c}),c0=cv({op:"OnFailure",eval(a){return a._stack.push(this),this[cn]}}),c1=W(3,(a,b,c)=>c_(a,a=>b(a)?c(a):cz(a))),c2=W(2,(a,b)=>c1(a,cf,a=>b(a.error))),c3=W(2,(a,b)=>c2(a,a=>cB(b))),c4=function(){let a=globalThis.Error.stackTraceLimit;globalThis.Error.stackTraceLimit=2;let b=new globalThis.Error;globalThis.Error.stackTraceLimit=a;let c=a=>c=>c9(c,c=>cz(function(a,c){let d=b.stack;if(!d)return c;let e=d.split("\n")[2]?.trim().replace(/^at /,"");if(!e)return c;let f=e.match(/\((.*)\)$/);return ch(c,`at ${a} (${f?f[1]:e})`)}(a,c)));return 2==arguments.length?c(arguments[1])(arguments[0]):c(arguments[0])},c5=W(2,(a,b)=>{let c=Object.create(c6);return c[cn]=a,c[cp]=b.onSuccess,c[cq]=b.onFailure,c}),c6=cv({op:"OnSuccessAndFailure",eval(a){return a._stack.push(this),this[cn]}}),c7=W(2,(a,b)=>dc(c=>c5(c(a),{onFailure:a=>cM(b(cz(a)),()=>cz(a)),onSuccess:a=>cM(b(cQ(a)),()=>cy(a))}))),c8=W(3,(a,b,c)=>c7(a,a=>b(a)?c(a):cU)),c9=W(2,(a,b)=>c8(a,cT,a=>b(a.cause))),da=cw({op:"SetInterruptible",ensure(a){if(a.interruptible=this[cn],a._interrupted&&a.interruptible)return()=>cR}}),db=a=>cH(b=>b.interruptible?a:(b.interruptible=!0,b._stack.push(da(!1)),b._interrupted)?cR:a),dc=a=>cH(b=>b.interruptible?(b.interruptible=!1,b._stack.push(da(!0)),a(db)):a(X)),dd=function(){class a extends globalThis.Error{}return Object.assign(a.prototype,ct,bs,{[cm]:"Failure",[co](){return cA(this)},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[aY](){let a=this.stack;return a?`${this.toString()}
${a.split("\n").slice(1).join("\n")}`:this.toString()}}),a}(),de=class extends dd{constructor(a){super(),a&&Object.assign(this,a)}},df=a=>{class b extends de{constructor(...b){super(...b),this._tag=a}}return b.prototype.name=a,b},dg={"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applixware":{source:"apache",extensions:["aw"]},"application/atom+xml":{source:"iana",extensions:["atom"]},"application/atomcat+xml":{source:"iana",extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",extensions:["atomdeleted"]},"application/atomsvc+xml":{source:"iana",extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",extensions:["dwd"]},"application/atsc-held+xml":{source:"iana",extensions:["held"]},"application/atsc-rsat+xml":{source:"iana",extensions:["rsat"]},"application/calendar+xml":{source:"iana",extensions:["xcs"]},"application/ccxml+xml":{source:"iana",extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cpl+xml":{source:"iana",extensions:["cpl"]},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/dash+xml":{source:"iana",extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",extensions:["mpp"]},"application/davmount+xml":{source:"iana",extensions:["davmount"]},"application/dicom":{source:"iana",extensions:["dcm"]},"application/docbook+xml":{source:"apache",extensions:["dbk"]},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",extensions:["xdssc"]},"application/ecmascript":{source:"iana",extensions:["es","ecma"]},"application/emma+xml":{source:"iana",extensions:["emma"]},"application/emotionml+xml":{source:"iana",extensions:["emotionml"]},"application/epub+zip":{source:"iana",extensions:["epub"]},"application/exi":{source:"iana",extensions:["exi"]},"application/express":{source:"iana",extensions:["exp"]},"application/fdt+xml":{source:"iana",extensions:["fdt"]},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/geo+json":{source:"iana",extensions:["geojson"]},"application/gml+xml":{source:"iana",extensions:["gml"]},"application/gpx+xml":{source:"apache",extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",extensions:["gz"]},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/inkml+xml":{source:"iana",extensions:["ink","inkml"]},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/its+xml":{source:"iana",extensions:["its"]},"application/java-archive":{source:"apache",extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",extensions:["ser"]},"application/java-vm":{source:"apache",extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",extensions:["js","mjs"]},"application/json":{source:"iana",charset:"UTF-8",extensions:["json","map"]},"application/jsonml+json":{source:"apache",extensions:["jsonml"]},"application/ld+json":{source:"iana",extensions:["jsonld"]},"application/lgr+xml":{source:"iana",extensions:["lgr"]},"application/lost+xml":{source:"iana",extensions:["lostxml"]},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/mads+xml":{source:"iana",extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",extensions:["mathml"]},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",extensions:["mpf"]},"application/mediaservercontrol+xml":{source:"iana",extensions:["mscml"]},"application/metalink+xml":{source:"apache",extensions:["metalink"]},"application/metalink4+xml":{source:"iana",extensions:["meta4"]},"application/mets+xml":{source:"iana",extensions:["mets"]},"application/mmt-aei+xml":{source:"iana",extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",extensions:["musd"]},"application/mods+xml":{source:"iana",extensions:["mods"]},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/msword":{source:"iana",extensions:["doc","dot"]},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/node":{source:"iana",extensions:["cjs"]},"application/octet-stream":{source:"iana",extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/oebps-package+xml":{source:"iana",extensions:["opf"]},"application/ogg":{source:"iana",extensions:["ogx"]},"application/omdoc+xml":{source:"apache",extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p2p-overlay+xml":{source:"iana",extensions:["relo"]},"application/patch-ops-error+xml":{source:"iana",extensions:["xer"]},"application/pdf":{source:"iana",extensions:["pdf"]},"application/pgp-encrypted":{source:"iana",extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",extensions:["pls"]},"application/postscript":{source:"iana",extensions:["ai","eps","ps"]},"application/provenance+xml":{source:"iana",extensions:["provx"]},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/pskc+xml":{source:"iana",extensions:["pskcxml"]},"application/rdf+xml":{source:"iana",extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/resource-lists+xml":{source:"iana",extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",extensions:["rld"]},"application/rls-services+xml":{source:"iana",extensions:["rs"]},"application/route-apd+xml":{source:"iana",extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",extensions:["sls"]},"application/route-usd+xml":{source:"iana",extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rsd+xml":{source:"apache",extensions:["rsd"]},"application/rss+xml":{source:"apache",extensions:["rss"]},"application/rtf":{source:"iana",extensions:["rtf"]},"application/sbml+xml":{source:"iana",extensions:["sbml"]},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/senml+xml":{source:"iana",extensions:["senmlx"]},"application/sensml+xml":{source:"iana",extensions:["sensmlx"]},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/shf+xml":{source:"iana",extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/smil+xml":{source:"iana",extensions:["smi","smil"]},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",extensions:["srx"]},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",extensions:["grxml"]},"application/sru+xml":{source:"iana",extensions:["sru"]},"application/ssdl+xml":{source:"apache",extensions:["ssdl"]},"application/ssml+xml":{source:"iana",extensions:["ssml"]},"application/swid+xml":{source:"iana",extensions:["swidtag"]},"application/tei+xml":{source:"iana",extensions:["tei","teicorpus"]},"application/thraud+xml":{source:"iana",extensions:["tfi"]},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",extensions:["ttml"]},"application/urc-ressheet+xml":{source:"iana",extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",extensions:["td"]},"application/vnd.1000minds.decision-model+xml":{source:"iana",extensions:["1km"]},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",extensions:["air"]},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.xdp+xml":{source:"iana",extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.android.package-archive":{source:"apache",extensions:["apk"]},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apple.installer+xml":{source:"iana",extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.balsamiq.bmml+xml":{source:"iana",extensions:["bmml"]},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.chemdraw+xml":{source:"iana",extensions:["cdxml"]},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.citationstyles.style+xml":{source:"iana",extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",extensions:["wbs"]},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.dart":{source:"iana",extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.eszigno3+xml":{source:"iana",extensions:["es3","et3"]},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-earth.kml+xml":{source:"iana",extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",extensions:["kmz"]},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+xml":{source:"iana",extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las.las+xml":{source:"iana",extensions:["lasxml"]},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",extensions:["lbe"]},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.mozilla.xul+xml":{source:"iana",extensions:["xul"]},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-excel":{source:"iana",extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-powerpoint":{source:"iana",extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",extensions:["xps"]},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma.dd2+xml":{source:"iana",extensions:["dd2"]},"application/vnd.openblox.game+xml":{source:"iana",extensions:["obgx"]},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",extensions:["osm"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",extensions:["musicxml"]},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",extensions:["link66"]},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.software602.filler.form+xml":{source:"iana",extensions:["fo"]},"application/vnd.solent.sdkm+xml":{source:"iana",extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.sun.wadl+xml":{source:"iana",extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",extensions:["xdm"]},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",extensions:["ddf"]},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",extensions:["uoml"]},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",extensions:["osfpvg"]},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",extensions:["zaz"]},"application/voicexml+xml":{source:"iana",extensions:["vxml"]},"application/wasm":{source:"iana",extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",extensions:["wif"]},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wsdl+xml":{source:"iana",extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",extensions:["bz"]},"application/x-bzip2":{source:"apache",extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",extensions:["res"]},"application/x-dvi":{source:"apache",extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",extensions:["jnlp"]},"application/x-latex":{source:"apache",extensions:["latex"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-rar-compressed":{source:"apache",extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",extensions:["xlf"]},"application/x-xpinstall":{source:"apache",extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/xaml+xml":{source:"apache",extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",extensions:["xel"]},"application/xcap-ns+xml":{source:"iana",extensions:["xns"]},"application/xenc+xml":{source:"iana",extensions:["xenc"]},"application/xhtml+xml":{source:"iana",extensions:["xhtml","xht"]},"application/xliff+xml":{source:"iana",extensions:["xlf"]},"application/xml":{source:"iana",extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",extensions:["dtd"]},"application/xop+xml":{source:"iana",extensions:["xop"]},"application/xproc+xml":{source:"apache",extensions:["xpl"]},"application/xslt+xml":{source:"iana",extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",extensions:["xspf"]},"application/xv+xml":{source:"iana",extensions:["mxml","xhvml","xvml","xvm"]},"application/yaml":{source:"iana",extensions:["yaml","yml"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yin+xml":{source:"iana",extensions:["yin"]},"application/zip":{source:"iana",extensions:["zip"]},"audio/3gpp":{source:"iana",extensions:["3gpp"]},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/basic":{source:"iana",extensions:["au","snd"]},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp4":{source:"iana",extensions:["m4a","mp4a"]},"audio/mpeg":{source:"iana",extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/ogg":{source:"iana",extensions:["oga","ogg","spx","opus"]},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/silk":{source:"apache",extensions:["sil"]},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/webm":{source:"apache",extensions:["weba"]},"audio/x-aac":{source:"apache",extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/x-gsm":{source:"apache",extensions:["gsm"]},"audio/xm":{source:"apache",extensions:["xm"]},"image/aces":{source:"iana",extensions:["exr"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",extensions:["avif"]},"image/bmp":{source:"iana",extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",extensions:["jpeg","jpg","jpe","jfif","pjpeg","pjp"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",extensions:["jpm"]},"image/jpx":{source:"iana",extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/png":{source:"iana",extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.microsoft.icon":{source:"iana",extensions:["ico"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"text/cache-manifest":{source:"iana",extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/css":{source:"iana",charset:"UTF-8",extensions:["css"]},"text/csv":{source:"iana",extensions:["csv"]},"text/html":{source:"iana",extensions:["html","htm","shtml"]},"text/markdown":{source:"iana",extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/n3":{source:"iana",charset:"UTF-8",extensions:["n3"]},"text/plain":{source:"iana",extensions:["txt","text","conf","def","list","log","in","ini"]},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/richtext":{source:"iana",extensions:["rtx"]},"text/rtf":{source:"iana",extensions:["rtf"]},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shex":{source:"iana",extensions:["shex"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/tab-separated-values":{source:"iana",extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/uri-list":{source:"iana",extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",extensions:["vcard"]},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",extensions:["xml"]},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h264":{source:"iana",extensions:["h264"]},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",extensions:["mp4","mp4v","mpg4"]},"video/mpeg":{source:"iana",extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/ogg":{source:"iana",extensions:["ogv"]},"video/quicktime":{source:"iana",extensions:["qt","mov"]},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/webm":{source:"apache",extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",extensions:["otf"]},"font/ttf":{source:"iana",extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/rfc822":{source:"iana",extensions:["eml","mime"]},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/gltf+json":{source:"iana",extensions:["gltf"]},"model/gltf-binary":{source:"iana",extensions:["glb"]},"model/iges":{source:"iana",extensions:["igs","iges"]},"model/mesh":{source:"iana",extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana",extensions:[".p21",".stp",".step",".stpnc",".210"]},"model/step+xml":{source:"iana",extensions:["stpx"]},"model/step+zip":{source:"iana",extensions:["stpz"]},"model/step-xml+zip":{source:"iana",extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]}},dh={},di={},dj=!1,dk=Symbol.for("effect/Either"),dl={...br,[dk]:{_R:a=>a},[aY](){return this.toJSON()},toString(){return a$(this.toJSON())}},dm=Object.assign(Object.create(dl),{_tag:"Right",_op:"Right",[aU](a){return dp(a)&&dr(a)&&aV(this.right,a.right)},[aJ](){return aM(aK(this._tag))(aK(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:aZ(this.right)}}}),dn=Object.assign(Object.create(dl),{_tag:"Left",_op:"Left",[aU](a){return dp(a)&&dq(a)&&aV(this.left,a.left)},[aJ](){return aM(aK(this._tag))(aK(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:aZ(this.left)}}}),dp=a=>ap(a,dk),dq=a=>"Left"===a._tag,dr=a=>"Right"===a._tag,ds=a=>{let b=Object.create(dn);return b.left=a,b},dt=a=>{let b=Object.create(dm);return b.right=a,b},du=W(2,(a,b)=>bD(a)?ds(b()):dt(a.value)),dv=W(2,(a,{onLeft:b,onRight:c})=>dq(a)?ds(b(a.left)):dt(c(a.right))),dw=W(2,(a,b)=>dq(a)?ds(b(a.left)):dt(a.right)),dx=W(2,(a,b)=>dr(a)?dt(b(a.right)):ds(a.left)),dy=W(2,(a,{onLeft:b,onRight:c})=>dq(a)?b(a.left):c(a.right)),dz=dy({onLeft:X,onRight:X}),dA=W(2,(a,b)=>{if(dr(a))return a.right;throw b(a.left)}),dB=dA(()=>Error("getOrThrow called on a Left")),dC=Symbol.for("effect/Encoding/errors/Decode"),dD=(a,b)=>{let c={_tag:"DecodeException",[dC]:dC,input:a};return ae(b)&&(c.message=b),c},dE=Symbol.for("effect/Encoding/errors/Encode"),dF=new TextEncoder,dG=a=>{let b,c=a.length,d="";for(b=2;b<c;b+=3)d+=dJ[a[b-2]>>2],d+=dJ[(3&a[b-2])<<4|a[b-1]>>4],d+=dJ[(15&a[b-1])<<2|a[b]>>6],d+=dJ[63&a[b]];return b===c+1&&(d+=dJ[a[b-2]>>2],d+=dJ[(3&a[b-2])<<4],d+="=="),b===c&&(d+=dJ[a[b-2]>>2],d+=dJ[(3&a[b-2])<<4|a[b-1]>>4],d+=dJ[(15&a[b-1])<<2],d+="="),d},dH=a=>a.replace(/[\n\r]/g,"");function dI(a){if(a>=dK.length)throw TypeError(`Invalid character ${String.fromCharCode(a)}`);let b=dK[a];if(255===b)throw TypeError(`Invalid character ${String.fromCharCode(a)}`);return b}let dJ=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],dK=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],dL=a=>{let b="";for(let c=0;c<a.length;++c)b+=dM[a[c]];return b},dM=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],dN=a=>{if(48<=a&&a<=57)return a-48;if(97<=a&&a<=102)return a-97+10;if(65<=a&&a<=70)return a-65+10;throw TypeError("Invalid input")},dO=a=>(b,c)=>b===c||a(b,c),dP=(a,b)=>a===b,dQ=W(2,(a,b)=>dO((c,d)=>a(b(c),b(d)))),dR=dQ(dP,a=>a.getTime()),dS=a=>dO((b,c)=>{if(b.length!==c.length)return!1;for(let d=0;d<b.length;d++)if(!a(b[d],c[d]))return!1;return!0}),dT="effect/Redacted",dU=ad("effect/Redacted/redactedRegistry",()=>new WeakMap),dV=Symbol.for(dT),dW={[dV]:{_A:a=>a},pipe(){return a7(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[aY]:()=>"<redacted>",[aJ](){return aa(aK(dT),aM(aK(dU.get(this))),aT(this))},[aU](a){return dX(a)&&aV(dU.get(this),dU.get(a))}},dX=a=>ap(a,dV),dY=a=>{let b=Object.create(dW);return dU.set(b,a),b},dZ=a=>{if(dU.has(a))return dU.get(a);throw Error("Unable to get redacted value")},d$=a=>dO((b,c)=>a(dZ(b),dZ(c))),d_={alphabet:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",minLength:0,blocklist:new Set(["0rgasm","1d10t","1d1ot","1di0t","1diot","1eccacu10","1eccacu1o","1eccacul0","1eccaculo","1mbec11e","1mbec1le","1mbeci1e","1mbecile","a11upat0","a11upato","a1lupat0","a1lupato","aand","ah01e","ah0le","aho1e","ahole","al1upat0","al1upato","allupat0","allupato","ana1","ana1e","anal","anale","anus","arrapat0","arrapato","arsch","arse","ass","b00b","b00be","b01ata","b0ceta","b0iata","b0ob","b0obe","b0sta","b1tch","b1te","b1tte","ba1atkar","balatkar","bastard0","bastardo","batt0na","battona","bitch","bite","bitte","bo0b","bo0be","bo1ata","boceta","boiata","boob","boobe","bosta","bran1age","bran1er","bran1ette","bran1eur","bran1euse","branlage","branler","branlette","branleur","branleuse","c0ck","c0g110ne","c0g11one","c0g1i0ne","c0g1ione","c0gl10ne","c0gl1one","c0gli0ne","c0glione","c0na","c0nnard","c0nnasse","c0nne","c0u111es","c0u11les","c0u1l1es","c0u1lles","c0ui11es","c0ui1les","c0uil1es","c0uilles","c11t","c11t0","c11to","c1it","c1it0","c1ito","cabr0n","cabra0","cabrao","cabron","caca","cacca","cacete","cagante","cagar","cagare","cagna","cara1h0","cara1ho","caracu10","caracu1o","caracul0","caraculo","caralh0","caralho","cazz0","cazz1mma","cazzata","cazzimma","cazzo","ch00t1a","ch00t1ya","ch00tia","ch00tiya","ch0d","ch0ot1a","ch0ot1ya","ch0otia","ch0otiya","ch1asse","ch1avata","ch1er","ch1ng0","ch1ngadaz0s","ch1ngadazos","ch1ngader1ta","ch1ngaderita","ch1ngar","ch1ngo","ch1ngues","ch1nk","chatte","chiasse","chiavata","chier","ching0","chingadaz0s","chingadazos","chingader1ta","chingaderita","chingar","chingo","chingues","chink","cho0t1a","cho0t1ya","cho0tia","cho0tiya","chod","choot1a","choot1ya","chootia","chootiya","cl1t","cl1t0","cl1to","clit","clit0","clito","cock","cog110ne","cog11one","cog1i0ne","cog1ione","cogl10ne","cogl1one","cogli0ne","coglione","cona","connard","connasse","conne","cou111es","cou11les","cou1l1es","cou1lles","coui11es","coui1les","couil1es","couilles","cracker","crap","cu10","cu1att0ne","cu1attone","cu1er0","cu1ero","cu1o","cul0","culatt0ne","culattone","culer0","culero","culo","cum","cunt","d11d0","d11do","d1ck","d1ld0","d1ldo","damn","de1ch","deich","depp","di1d0","di1do","dick","dild0","dildo","dyke","encu1e","encule","enema","enf01re","enf0ire","enfo1re","enfoire","estup1d0","estup1do","estupid0","estupido","etr0n","etron","f0da","f0der","f0ttere","f0tters1","f0ttersi","f0tze","f0utre","f1ca","f1cker","f1ga","fag","fica","ficker","figa","foda","foder","fottere","fotters1","fottersi","fotze","foutre","fr0c10","fr0c1o","fr0ci0","fr0cio","fr0sc10","fr0sc1o","fr0sci0","fr0scio","froc10","froc1o","froci0","frocio","frosc10","frosc1o","frosci0","froscio","fuck","g00","g0o","g0u1ne","g0uine","gandu","go0","goo","gou1ne","gouine","gr0gnasse","grognasse","haram1","harami","haramzade","hund1n","hundin","id10t","id1ot","idi0t","idiot","imbec11e","imbec1le","imbeci1e","imbecile","j1zz","jerk","jizz","k1ke","kam1ne","kamine","kike","leccacu10","leccacu1o","leccacul0","leccaculo","m1erda","m1gn0tta","m1gnotta","m1nch1a","m1nchia","m1st","mam0n","mamahuev0","mamahuevo","mamon","masturbat10n","masturbat1on","masturbate","masturbati0n","masturbation","merd0s0","merd0so","merda","merde","merdos0","merdoso","mierda","mign0tta","mignotta","minch1a","minchia","mist","musch1","muschi","n1gger","neger","negr0","negre","negro","nerch1a","nerchia","nigger","orgasm","p00p","p011a","p01la","p0l1a","p0lla","p0mp1n0","p0mp1no","p0mpin0","p0mpino","p0op","p0rca","p0rn","p0rra","p0uff1asse","p0uffiasse","p1p1","p1pi","p1r1a","p1rla","p1sc10","p1sc1o","p1sci0","p1scio","p1sser","pa11e","pa1le","pal1e","palle","pane1e1r0","pane1e1ro","pane1eir0","pane1eiro","panele1r0","panele1ro","paneleir0","paneleiro","patakha","pec0r1na","pec0rina","pecor1na","pecorina","pen1s","pendej0","pendejo","penis","pip1","pipi","pir1a","pirla","pisc10","pisc1o","pisci0","piscio","pisser","po0p","po11a","po1la","pol1a","polla","pomp1n0","pomp1no","pompin0","pompino","poop","porca","porn","porra","pouff1asse","pouffiasse","pr1ck","prick","pussy","put1za","puta","puta1n","putain","pute","putiza","puttana","queca","r0mp1ba11e","r0mp1ba1le","r0mp1bal1e","r0mp1balle","r0mpiba11e","r0mpiba1le","r0mpibal1e","r0mpiballe","rand1","randi","rape","recch10ne","recch1one","recchi0ne","recchione","retard","romp1ba11e","romp1ba1le","romp1bal1e","romp1balle","rompiba11e","rompiba1le","rompibal1e","rompiballe","ruff1an0","ruff1ano","ruffian0","ruffiano","s1ut","sa10pe","sa1aud","sa1ope","sacanagem","sal0pe","salaud","salope","saugnapf","sb0rr0ne","sb0rra","sb0rrone","sbattere","sbatters1","sbattersi","sborr0ne","sborra","sborrone","sc0pare","sc0pata","sch1ampe","sche1se","sche1sse","scheise","scheisse","schlampe","schwachs1nn1g","schwachs1nnig","schwachsinn1g","schwachsinnig","schwanz","scopare","scopata","sexy","sh1t","shit","slut","sp0mp1nare","sp0mpinare","spomp1nare","spompinare","str0nz0","str0nza","str0nzo","stronz0","stronza","stronzo","stup1d","stupid","succh1am1","succh1ami","succhiam1","succhiami","sucker","t0pa","tapette","test1c1e","test1cle","testic1e","testicle","tette","topa","tr01a","tr0ia","tr0mbare","tr1ng1er","tr1ngler","tring1er","tringler","tro1a","troia","trombare","turd","twat","vaffancu10","vaffancu1o","vaffancul0","vaffanculo","vag1na","vagina","verdammt","verga","w1chsen","wank","wichsen","x0ch0ta","x0chota","xana","xoch0ta","xochota","z0cc01a","z0cc0la","z0cco1a","z0ccola","z1z1","z1zi","ziz1","zizi","zocc01a","zocc0la","zocco1a","zoccola"])};class d0{constructor(a){var b,c,d;let e=null!=(b=null==a?void 0:a.alphabet)?b:d_.alphabet,f=null!=(c=null==a?void 0:a.minLength)?c:d_.minLength,g=null!=(d=null==a?void 0:a.blocklist)?d:d_.blocklist;if(new Blob([e]).size!==e.length)throw Error("Alphabet cannot contain multibyte characters");if(e.length<3)throw Error("Alphabet length must be at least 3");if(new Set(e).size!==e.length)throw Error("Alphabet must contain unique characters");if("number"!=typeof f||f<0||f>255)throw Error("Minimum length has to be between 0 and 255");let h=new Set,i=e.toLowerCase().split("");for(let a of g)if(a.length>=3){let b=a.toLowerCase(),c=b.split("");c.filter(a=>i.includes(a)).length===c.length&&h.add(b)}this.alphabet=this.shuffle(e),this.minLength=f,this.blocklist=h}encode(a){if(0===a.length)return"";if(a.filter(a=>a>=0&&a<=this.maxValue()).length!==a.length)throw Error(`Encoding supports numbers between 0 and ${this.maxValue()}`);return this.encodeNumbers(a)}decode(a){let b=[];if(""===a)return b;let c=this.alphabet.split("");for(let d of a.split(""))if(!c.includes(d))return b;let d=a.charAt(0),e=this.alphabet.indexOf(d),f=this.alphabet.slice(e)+this.alphabet.slice(0,e);f=f.split("").reverse().join("");let g=a.slice(1);for(;g.length>0;){let a=f.slice(0,1),c=g.split(a);if(c.length>0){if(""===c[0])return b;b.push(this.toNumber(c[0],f.slice(1))),c.length>1&&(f=this.shuffle(f))}g=c.slice(1).join(a)}return b}encodeNumbers(a,b=0){if(b>this.alphabet.length)throw Error("Reached max attempts to re-generate the ID");let c=a.reduce((a,b,c)=>this.alphabet[b%this.alphabet.length].codePointAt(0)+c+a,a.length)%this.alphabet.length;c=(c+b)%this.alphabet.length;let d=this.alphabet.slice(c)+this.alphabet.slice(0,c),e=d.charAt(0);d=d.split("").reverse().join("");let f=[e];for(let b=0;b!==a.length;b++){let c=a[b];f.push(this.toId(c,d.slice(1))),b<a.length-1&&(f.push(d.slice(0,1)),d=this.shuffle(d))}let g=f.join("");if(this.minLength>g.length)for(g+=d.slice(0,1);this.minLength-g.length>0;)d=this.shuffle(d),g+=d.slice(0,Math.min(this.minLength-g.length,d.length));return this.isBlockedId(g)&&(g=this.encodeNumbers(a,b+1)),g}shuffle(a){let b=a.split("");for(let a=0,c=b.length-1;c>0;a++,c--){let d=(a*c+b[a].codePointAt(0)+b[c].codePointAt(0))%b.length;[b[a],b[d]]=[b[d],b[a]]}return b.join("")}toId(a,b){let c=[],d=b.split(""),e=a;do c.unshift(d[e%d.length]),e=Math.floor(e/d.length);while(e>0);return c.join("")}toNumber(a,b){let c=b.split("");return a.split("").reduce((a,b)=>a*c.length+c.indexOf(b),0)}isBlockedId(a){let b=a.toLowerCase();for(let a of this.blocklist)if(a.length<=b.length){if(b.length<=3||a.length<=3){if(b===a)return!0}else if(/\d/.test(a)){if(b.startsWith(a)||b.endsWith(a))return!0}else if(b.includes(a))return!0}return!1}maxValue(){return Number.MAX_SAFE_INTEGER}}var d1=class extends df("InvalidRouteConfig"){constructor(a,b){super({reason:b?`Expected route config to have a ${b} for key ${a} but none was found.`:`Encountered an invalid route config during backfilling. ${a} was not found.`})}},d2=class extends df("UnknownFileType"){constructor(a){super({reason:`Could not determine type for ${a}`})}},d3=class extends df("InvalidFileType"){constructor(a,b){super({reason:`File type ${a} not allowed for ${b}`})}},d4=class extends df("InvalidFileSize"){constructor(a){super({reason:`Invalid file size: ${a}`})}};function d5(a){return{maxFileSize:"image"===a?"4MB":"video"===a?"16MB":"audio"===a||"blob"===a?"8MB":"pdf"===a?"4MB":"text"===a?"64KB":"4MB",maxFileCount:1,minFileCount:1,contentDisposition:"inline"}}df("InvalidURL"),df("RetryError"),df("FetchError"),df("InvalidJson"),df("BadRequestError"),df("UploadAborted"),df("UploadAborted");let d6=a=>{if(Array.isArray(a))return cy(a.reduce((a,b)=>(a[b]=d5(b),a),{}));let b={};for(let c of ea(a)){let d=a[c];if(!d)return cA(new d1(c));b[c]={...d5(c),...d}}return cy(JSON.parse(JSON.stringify(b,eb)))},d7=(a,b)=>{let c=a.type||function(a){if(!a||"string"!=typeof a)return!1;let b=(function(a){let b=a.lastIndexOf(".");return b<0?"":a.substring(b)})("x."+a).toLowerCase().substring(1);return!!b&&((function(a,b){if(dj)return;dj=!0;let c=["nginx","apache",void 0,"iana"];Object.keys(dg).forEach(d=>{let e=dg[d],f=e.extensions;if(f.length)for(let g of(a[d]=f,f)){if(g in b){let a=c.indexOf(dg[b[g]].source),d=c.indexOf(e.source);if("application/octet-stream"!==b[g]&&(a>d||a===d&&b[g].startsWith("application/")))continue}b[g]=d}})}(dh,di),di)[b]||!1)}(a.name);if(!c)return b.includes("blob")?cy("blob"):cA(new d2(a.name));if(b.some(a=>a.includes("/"))&&b.includes(c))return cy(c);let d="application/pdf"===c.toLowerCase()?"pdf":c.split("/")[0];if(!b.includes(d))if(b.includes("blob"))return cy("blob");else return cA(new d3(d,a.name));return cy(d)},d8=["B","KB","MB","GB","TB"],d9=a=>{let b=RegExp(`^(\\d+)(\\.\\d+)?\\s*(${d8.join("|")})$`,"i"),c=a.match(b);if(!c?.[1]||!c[3])return cA(new d4(a));let d=parseFloat(c[1]),e=c[3].toUpperCase();return cy(Math.floor(d*Math.pow(1024,d8.indexOf(e))))};function ea(a){return Object.keys(a)}let eb=(a,b)=>"number"!=typeof b||Number.isSafeInteger(b)||b<=Number.MAX_SAFE_INTEGER&&b>=Number.MIN_SAFE_INTEGER?b:b===1/0?Number.MAX_SAFE_INTEGER:b===-1/0?Number.MIN_SAFE_INTEGER:Number.isNaN(b)?0:void 0,ec={BAD_REQUEST:400,NOT_FOUND:404,FORBIDDEN:403,INTERNAL_SERVER_ERROR:500,INTERNAL_CLIENT_ERROR:500,TOO_LARGE:413,TOO_SMALL:400,TOO_MANY_FILES:400,KEY_TOO_LONG:400,URL_GENERATION_FAILED:500,UPLOAD_FAILED:500,MISSING_ENV:500,INVALID_SERVER_CONFIG:500,FILE_LIMIT_EXCEEDED:500};var ed=class a extends de{_tag="UploadThingError";name="UploadThingError";cause;code;data;constructor(a){let b="string"==typeof a?{code:"INTERNAL_SERVER_ERROR",message:a}:a;super({message:b.message??function(a,b){return"string"==typeof a?a:a instanceof Error||a&&"object"==typeof a&&"message"in a&&"string"==typeof a.message?a.message:b??"An unknown error occurred"}(b.cause,b.code)}),this.code=b.code,this.data=b.data,b.cause instanceof Error?this.cause=b.cause:av(b.cause)&&af(b.cause.status)&&ae(b.cause.statusText)?this.cause=Error(`Response ${b.cause.status} ${b.cause.statusText}`):ae(b.cause)?this.cause=Error(b.cause):this.cause=b.cause}static toObject(a){return{code:a.code,message:a.message,data:a.data}}static serialize(b){return JSON.stringify(a.toObject(b))}};b$("uploadthing/Fetch")();let ee="hmac-sha256=",ef={name:"HMAC",hash:"SHA-256"},eg=new TextEncoder,eh=(a,b,c)=>cK(function*(){let d,e=b?.slice(ee.length);if(!e)return!1;let f=eg.encode(dZ(c)),g=yield*cF(()=>crypto.subtle.importKey("raw",f,ef,!1,["verify"])),h=yield*"Right"===(d=(a=>{let b=new TextEncoder().encode(a);if(b.length%2!=0)return ds(dD(a,`Length must be a multiple of 2, but is ${b.length}`));try{let a=b.length/2,c=new Uint8Array(a);for(let d=0;d<a;d++){let a=dN(b[2*d]),e=dN(b[2*d+1]);c[d]=a<<4|e}return dt(c)}catch(b){return ds(dD(a,b instanceof Error?b.message:"Invalid input"))}})(e))._tag?cy(d.right):cA(d.left),i=eg.encode(a);return yield*cF(()=>crypto.subtle.verify(ef,g,h,i))}).pipe(c4("verifySignature"),c3(()=>!1)),ei=a=>a.length>0,ej=()=>bF,ek=W(2,(a,{onNone:b,onSome:c})=>bD(a)?b():c(a.value)),el=W(2,(a,b)=>bD(a)?b():a.value),em=W(2,(a,b)=>bD(a)?b():a),en=W(2,(a,b)=>bD(a)?bG(b()):a),eo=a=>null==a?ej():bG(a),ep=el(_),eq=a=>(...b)=>{try{return bG(a(...b))}catch{return ej()}},er=W(2,(a,b)=>{if(bE(a))return a.value;throw b()}),es=er(()=>Error("getOrThrow called on a None")),et=W(2,(a,b)=>bD(a)?ej():bG(b(a.value))),eu=W(2,(a,b)=>bD(a)?ej():b(a.value)),ev=W(2,(a,b)=>bD(a)?ej():eo(b(a.value))),ew=W(2,(a,b)=>eu(a,a=>b(a)?bG(a):bF)),ex=a=>dO((b,c)=>bD(b)?bD(c):!bD(c)&&a(b.value,c.value)),ey=W(2,(a,b)=>!bD(a)&&aV(a.value,b)),ez=W(2,(a,b)=>!bD(a)&&b(a.value)),eA=a=>(b,c)=>bD(b)?c:bD(c)?b:bG(a(b.value,c.value));Symbol.iterator,()=>eB;let eB={next:()=>({done:!0,value:void 0})},eC=a=>(b,c)=>b===c?0:a(b,c),eD=eC((a,b)=>a<b?-1:1),eE=W(2,(a,b)=>eC((c,d)=>a(b(c),b(d))));Object.fromEntries,(a,b)=>{let c=[];for(let d of eI(a))c.push(b(d,a[d]));return c};let eF=W(2,(a,b)=>Object.prototype.hasOwnProperty.call(a,b)),eG=W(2,(a,b)=>{if(!eF(a,b))return{...a};let c={...a};return delete c[b],c}),eH=W(2,(a,b)=>{let c={...a};for(let d of eI(a))c[d]=b(a[d],d);return c}),eI=a=>Object.keys(a),eJ=W(3,(a,b,c)=>({...a,[b]:c})),eK=(...a)=>a,eL=(...a)=>a,eM=a=>Array(a),eN=W(2,(a,b)=>{let c=Math.max(1,Math.floor(a)),d=Array(c);for(let a=0;a<c;a++)d[a]=b(a);return d}),eO=a=>Array.isArray(a)?a:Array.from(a),eP=a=>Array.isArray(a)?a:[a],eQ=W(2,(a,{onEmpty:b,onNonEmpty:c})=>eW(a)?c(a):b()),eR=W(2,(a,{onEmpty:b,onNonEmpty:c})=>eW(a)?c(e_(a),e1(a)):b()),eS=W(2,(a,b)=>[b,...a]),eT=W(2,(a,b)=>[...a,b]),eU=W(2,(a,b)=>eO(a).concat(eO(b))),eV=Array.isArray,eW=ei,eX=(a,b)=>a<0||a>=b.length,eY=W(2,(a,b)=>{let c=Math.floor(b);return eX(c,a)?ej():bG(a[c])}),eZ=W(2,(a,b)=>{let c=Math.floor(b);if(eX(c,a))throw Error(`Index ${c} out of bounds`);return a[c]}),e$=eY(0),e_=eZ(0),e0=a=>a[a.length-1],e1=a=>a.slice(1),e2=W(2,(a,b)=>e8(a,((a,b)=>{let c=0;for(let d of a){if(!b(d,c))break;c++}return c})(a,b))),e3=W(2,(a,b)=>{let c=eO(a);return c.slice(Math.floor(Math.min(Math.max(0,b),c.length)),c.length)}),e4=((a,b)=>{let c=eO(a);for(let a=c.length-1;a>=0;a--){let d=c[a],e=b(d,a);if(ag(e)){if(e)return bG(d)}else if(bE(e))return e}return ej()},a=>Array.from(a).reverse()),e5=W(2,(a,b)=>{let c=Array.from(a);return c.sort(b),c}),e6=W(2,(a,b)=>e7(a,b,eK)),e7=W(3,(a,b,c)=>{let d=eO(a),e=eO(b);if(eW(d)&&eW(e)){let a=[c(e_(d),e_(e))],b=Math.min(d.length,e.length);for(let f=1;f<b;f++)a[f]=c(d[f],e[f]);return a}return[]}),e8=W(2,(a,b)=>{let c=Array.from(a),d=Math.floor(b);return eW(c)?d>=1?e9(c,d):[[],c]:[c,[]]}),e9=W(2,(a,b)=>{let c=Math.max(1,Math.floor(b));return c>=a.length?[fa(a),[]]:[eS(a.slice(1,c),e_(a)),a.slice(c)]}),fa=a=>a.slice(),fb=W(3,(a,b,c)=>{let d=eO(a),e=eO(b);return eW(d)?eW(e)?fs(c)(eU(d,e)):d:e}),fc=W(2,(a,b)=>fb(a,b,aV)),fd=()=>[],fe=a=>[a],ff=W(2,(a,b)=>a.map(b)),fg=W(2,(a,b)=>{if(0===a.length)return[];let c=[];for(let d=0;d<a.length;d++){let e=b(a[d],d);for(let a=0;a<e.length;a++)c.push(e[a])}return c}),fh=fg(X),fi=W(2,(a,b)=>{let c=eO(a),d=[];for(let a=0;a<c.length;a++){let e=b(c[a],a);bE(e)&&d.push(e.value)}return d}),fj=W(2,(a,b)=>{let c=0,d=[];for(let e of a){let a=b(e,c);if(bE(a))d.push(a.value);else break;c++}return d}),fk=W(2,(a,b)=>{let c=[],d=[],e=eO(a);for(let a=0;a<e.length;a++){let f=b(e[a],a);dq(f)?c.push(f.left):d.push(f.right)}return[c,d]}),fl=fi(X),fm=W(2,(a,b)=>{let c=eO(a),d=[];for(let a=0;a<c.length;a++)b(c[a],a)&&d.push(c[a]);return d}),fn=W(3,(a,b,c)=>eO(a).reduce((a,b,d)=>c(a,b,d),b)),fo=W(3,(a,b,c)=>eO(a).reduceRight((a,b,d)=>c(a,b,d),b)),fp=W(2,(a,b)=>a.every(b)),fq=(a,b)=>{let c,d=[],e=a;for(;bE(c=b(e));){let[a,b]=c.value;d.push(a),e=b}return d},fr=dS,fs=W(2,(a,b)=>{let c=eO(a);if(eW(c)){let a=[e_(c)];for(let d of e1(c))a.every(a=>!b(d,a))&&a.push(d);return a}return[]}),ft=a=>fs(a,aV),fu=W(2,(a,b)=>eO(a).join(b)),fv=W(3,(a,b,c)=>{let d=0,e=b,f=[];for(let b of a){let a=c(e,b,d);e=a[0],f.push(a[1]),d++}return[e,f]}),fw=Symbol.for("effect/BigDecimal"),fx={[fw]:fw,[aJ](){let a=fE(this);return aa(aK(a.value),aM(aP(a.scale)),aT(this))},[aU](a){return fy(a)&&fH(this,a)},toString(){return`BigDecimal(${fI(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},fy=a=>ap(a,fw),fz=(a,b)=>{let c=Object.create(fx);return c.value=a,c.scale=b,c},fA=(a,b)=>{if(a!==fB&&a%fC===fB)throw RangeError("Value must be normalized");let c=fz(a,b);return c.normalized=c,c},fB=BigInt(0),fC=BigInt(10),fD=fA(fB,0),fE=a=>{if(void 0===a.normalized)if(a.value===fB)a.normalized=fD;else{let b=`${a.value}`,c=0;for(let a=b.length-1;a>=0;a--)if("0"===b[a])c++;else break;0===c&&(a.normalized=a);let d=BigInt(b.substring(0,b.length-c)),e=a.scale-c;a.normalized=fA(d,e)}return a.normalized},fF=W(2,(a,b)=>b>a.scale?fz(a.value*fC**BigInt(b-a.scale),b):b<a.scale?fz(a.value/fC**BigInt(a.scale-b),b):a),fG=dO((a,b)=>a.scale>b.scale?fF(b,a.scale).value===a.value:a.scale<b.scale?fF(a,b.scale).value===b.value:a.value===b.value),fH=W(2,(a,b)=>fG(a,b)),fI=a=>{let b,c,d=fE(a);if(Math.abs(d.scale)>=16)return fJ(d);let e=d.value<fB,f=e?`${d.value}`.substring(1):`${d.value}`;if(d.scale>=f.length)b="0",c="0".repeat(d.scale-f.length)+f;else{let a=f.length-d.scale;if(a>f.length){let d=a-f.length;b=`${f}${"0".repeat(d)}`,c=""}else c=f.slice(a),b=f.slice(0,a)}let g=""===c?b:`${b}.${c}`;return e?`-${g}`:g},fJ=a=>{if(fK(a))return"0e+0";let b=fE(a),c=`${(a=>a.value<fB?fz(-a.value,a.scale):a)(b).value}`,d=c.slice(0,1),e=c.slice(1),f=`${fL(b)?"-":""}${d}`;""!==e&&(f+=`.${e}`);let g=e.length-b.scale;return`${f}e${g>=0?"+":""}${g}`},fK=a=>a.value===fB,fL=a=>a.value<fB,fM=a=>{try{return""===a.trim()?ej():bG(BigInt(a))}catch{return ej()}},fN=a=>!a,fO=Symbol.for("effect/Chunk"),fP=[],fQ=dO((a,b)=>a.length===b.length&&f$(a).every((a,c)=>aV(a,f3(b,c)))),fR={[fO]:{_A:a=>a},toString(){return a$(this.toJSON())},toJSON(){return{_id:"Chunk",values:f$(this).map(aZ)}},[aY](){return this.toJSON()},[aU](a){return fT(a)&&fQ(this,a)},[aJ](){return aT(this,aS(f$(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return fP[Symbol.iterator]();default:return f$(this)[Symbol.iterator]()}},pipe(){return a7(this,arguments)}},fS=a=>{let b=Object.create(fR);switch(b.backing=a,a._tag){case"IEmpty":b.length=0,b.depth=0,b.left=b,b.right=b;break;case"IConcat":b.length=a.left.length+a.right.length,b.depth=1+Math.max(a.left.depth,a.right.depth),b.left=a.left,b.right=a.right;break;case"IArray":b.length=a.array.length,b.depth=0,b.left=fU,b.right=fU;break;case"ISingleton":b.length=1,b.depth=0,b.left=fU,b.right=fU;break;case"ISlice":b.length=a.length,b.depth=a.chunk.depth+1,b.left=fU,b.right=fU}return b},fT=a=>ap(a,fO),fU=fS({_tag:"IEmpty"}),fV=()=>fU,fW=(...a)=>f2(a),fX=a=>fS({_tag:"ISingleton",a}),fY=a=>fT(a)?a:f1(eO(a)),fZ=(a,b,c)=>{switch(a.backing._tag){case"IArray":!function(a,b,c,d,e){for(let f=0;f<Math.min(a.length,0+e);f++)c[d+f-b]=a[f]}(a.backing.array,0,b,c,a.length);break;case"IConcat":fZ(a.left,b,c),fZ(a.right,b,c+a.left.length);break;case"ISingleton":b[c]=a.backing.a;break;case"ISlice":{let d=0,e=c;for(;d<a.length;)b[e]=f3(a,d),d+=1,e+=1}}},f$=a=>{switch(a.backing._tag){case"IEmpty":return fP;case"IArray":return a.backing.array;default:{let b=Array(a.length);return fZ(a,b,0),a.backing={_tag:"IArray",array:b},a.left=fU,a.right=fU,a.depth=0,b}}},f_=a=>{switch(a.backing._tag){case"IEmpty":case"ISingleton":return a;case"IArray":return fS({_tag:"IArray",array:e4(a.backing.array)});case"IConcat":return fS({_tag:"IConcat",left:f_(a.backing.right),right:f_(a.backing.left)});case"ISlice":return f1(e4(f$(a)))}},f0=W(2,(a,b)=>b<0||b>=a.length?ej():bG(f3(a,b))),f1=a=>0===a.length?fV():1===a.length?fX(a[0]):fS({_tag:"IArray",array:a}),f2=a=>f1(a),f3=W(2,(a,b)=>{switch(a.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":if(0!==b)throw Error("Index out of bounds");return a.backing.a;case"IArray":if(b>=a.length||b<0)throw Error("Index out of bounds");return a.backing.array[b];case"IConcat":return b<a.left.length?f3(a.left,b):f3(a.right,b-a.left.length);case"ISlice":return f3(a.backing.chunk,b+a.backing.offset)}}),f4=W(2,(a,b)=>f9(a,fX(b))),f5=W(2,(a,b)=>f9(fX(b),a)),f6=W(2,(a,b)=>{if(b<=0)return fU;if(b>=a.length)return a;switch(a.backing._tag){case"ISlice":return fS({_tag:"ISlice",chunk:a.backing.chunk,length:b,offset:a.backing.offset});case"IConcat":if(b>a.left.length)return fS({_tag:"IConcat",left:a.left,right:f6(a.right,b-a.left.length)});return f6(a.left,b);default:return fS({_tag:"ISlice",chunk:a,offset:0,length:b})}}),f7=W(2,(a,b)=>{if(b<=0)return a;if(b>=a.length)return fU;switch(a.backing._tag){case"ISlice":return fS({_tag:"ISlice",chunk:a.backing.chunk,offset:a.backing.offset+b,length:a.backing.length-b});case"IConcat":if(b>a.left.length)return f7(a.right,b-a.left.length);return fS({_tag:"IConcat",left:f7(a.left,b),right:a.right});default:return fS({_tag:"ISlice",chunk:a,offset:b,length:a.length-b})}}),f8=W(2,(a,b)=>{let c=f$(a),d=c.length,e=0;for(;e<d&&b(c[e]);)e++;return f7(a,e)}),f9=W(2,(a,b)=>{if("IEmpty"===a.backing._tag)return b;if("IEmpty"===b.backing._tag)return a;let c=b.depth-a.depth;if(1>=Math.abs(c))return fS({_tag:"IConcat",left:a,right:b});if(c<-1)if(a.left.depth>=a.right.depth){let c=f9(a.right,b);return fS({_tag:"IConcat",left:a.left,right:c})}else{let c=f9(a.right.right,b);if(c.depth===a.depth-3){let b=fS({_tag:"IConcat",left:a.right.left,right:c});return fS({_tag:"IConcat",left:a.left,right:b})}{let b=fS({_tag:"IConcat",left:a.left,right:a.right.left});return fS({_tag:"IConcat",left:b,right:c})}}if(b.right.depth>=b.left.depth)return fS({_tag:"IConcat",left:f9(a,b.left),right:b.right});{let c=f9(a,b.left.left);if(c.depth===b.depth-3){let a=fS({_tag:"IConcat",left:c,right:b.left.right});return fS({_tag:"IConcat",left:a,right:b.right})}{let a=fS({_tag:"IConcat",left:b.left.right,right:b.right});return fS({_tag:"IConcat",left:c,right:a})}}}),ga=W(2,(a,b)=>f1(fi(a,b))),gb=W(2,(a,b)=>f1(fm(a,b))),gc=((a,b)=>f1(fj(a,b)),W(2,(a,b)=>{if("ISingleton"===a.backing._tag)return b(a.backing.a,0);let c=fU,d=0;for(let e of a)c=f9(c,b(e,d++));return c})),gd=W(2,(a,b)=>f$(a).forEach(b)),ge=gc(X),gf=a=>0===a.length,gg=a=>a.length>0,gh=f0(0),gi=a=>f3(a,0),gj=a=>f3(a,a.length-1),gk=W(2,(a,b)=>"ISingleton"===a.backing._tag?fX(b(a.backing.a,0)):f1(aa(f$(a),ff((a,c)=>b(a,c))))),gl=((a,b,c)=>{let[d,e]=fv(a,b,c);return[d,f1(e)]},W(2,(a,b)=>[f6(a,b),f7(a,b)])),gm=W(2,(a,b)=>{let c=0;for(let d of f$(a))if(b(d))break;else c++;return gl(a,c)}),gn=a=>f7(a,1),go=W(2,(a,b)=>f7(a,a.length-b)),gp=W(2,(a,b)=>{let c=[];for(let d of f$(a))if(b(d))c.push(d);else break;return f1(c)}),gq=W(3,(a,b,c)=>f1(e7(a,b,c))),gr=W(2,(a,b)=>fY(eN(a,b))),gs=W(2,(a,b)=>eO(a).some(b)),gt="InvalidData",gu="MissingData",gv="SourceUnavailable",gw="Unsupported",gx=Symbol.for("effect/ConfigError"),gy={_tag:"ConfigError",[gx]:gx},gz=(a,b)=>{let c=Object.create(gy);return c._op="And",c.left=a,c.right=b,Object.defineProperty(c,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(c,"message",{enumerable:!1,get(){return this.toString()}}),c},gA=(a,b)=>{let c=Object.create(gy);return c._op="Or",c.left=a,c.right=b,Object.defineProperty(c,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(c,"message",{enumerable:!1,get(){return this.toString()}}),c},gB=(a,b,c={pathDelim:"."})=>{let d=Object.create(gy);return d._op=gt,d.path=a,d.message=b,Object.defineProperty(d,"toString",{enumerable:!1,value(){let a=aa(this.path,fu(c.pathDelim));return`(Invalid data at ${a}: "${this.message}")`}}),d},gC=(a,b,c={pathDelim:"."})=>{let d=Object.create(gy);return d._op=gu,d.path=a,d.message=b,Object.defineProperty(d,"toString",{enumerable:!1,value(){let a=aa(this.path,fu(c.pathDelim));return`(Missing data at ${a}: "${this.message}")`}}),d},gD=W(2,(a,b)=>{switch(a._op){case"And":return gz(gD(a.left,b),gD(a.right,b));case"Or":return gA(gD(a.left,b),gD(a.right,b));case gt:return gB([...b,...a.path],a.message);case gu:return gC([...b,...a.path],a.message);case gv:return((a,b,c,d={pathDelim:"."})=>{let e=Object.create(gy);return e._op=gv,e.path=a,e.message=b,e.cause=c,Object.defineProperty(e,"toString",{enumerable:!1,value(){let a=aa(this.path,fu(d.pathDelim));return`(Source unavailable at ${a}: "${this.message}")`}}),e})([...b,...a.path],a.message,a.cause);case gw:return((a,b,c={pathDelim:"."})=>{let d=Object.create(gy);return d._op=gw,d.path=a,d.message=b,Object.defineProperty(d,"toString",{enumerable:!1,value(){let a=aa(this.path,fu(c.pathDelim));return`(Unsupported operation at ${a}: "${this.message}")`}}),d})([...b,...a.path],a.message)}}),gE={andCase:(a,b,c)=>b&&c,orCase:(a,b,c)=>b&&c,invalidDataCase:$,missingDataCase:Z,sourceUnavailableCase:$,unsupportedCase:$},gF=W(3,(a,b,c)=>{let d=[a],e=[];for(;d.length>0;){let a=d.pop();switch(a._op){case"And":d.push(a.right),d.push(a.left),e.push(ds({_op:"AndCase"}));break;case"Or":d.push(a.right),d.push(a.left),e.push(ds({_op:"OrCase"}));break;case gt:e.push(dt(c.invalidDataCase(b,a.path,a.message)));break;case gu:e.push(dt(c.missingDataCase(b,a.path,a.message)));break;case gv:e.push(dt(c.sourceUnavailableCase(b,a.path,a.message,a.cause)));break;case gw:e.push(dt(c.unsupportedCase(b,a.path,a.message)))}}let f=[];for(;e.length>0;){let a=e.pop();switch(a._op){case"Left":switch(a.left._op){case"AndCase":{let a=f.pop(),d=f.pop(),e=c.andCase(b,a,d);f.push(e);break}case"OrCase":{let a=f.pop(),d=f.pop(),e=c.orCase(b,a,d);f.push(e)}}break;case"Right":f.push(a.right)}}if(0===f.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return f.pop()}),gG=a=>gF(a,void 0,gE),gH=Symbol.for("effect/Duration"),gI=BigInt(0),gJ=BigInt(24),gK=BigInt(60),gL=BigInt(1e3),gM=BigInt(1e6),gN=BigInt(1e9),gO=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,gP=a=>{if(gU(a))return a;if(af(a))return gZ(a);if(ah(a))return gX(a);if(Array.isArray(a)&&2===a.length&&a.every(af))return a[0]===-1/0||a[1]===-1/0||Number.isNaN(a[0])||Number.isNaN(a[1])?gV:a[0]===1/0||a[1]===1/0?gW:gX(BigInt(Math.round(1e9*a[0]))+BigInt(Math.round(a[1])));if(ae(a)){let b=gO.exec(a);if(b){let[a,c,d]=b,e=Number(c);switch(d){case"nano":case"nanos":return gX(BigInt(c));case"micro":case"micros":return gY(BigInt(c));case"milli":case"millis":return gZ(e);case"second":case"seconds":return g$(e);case"minute":case"minutes":return g_(e);case"hour":case"hours":return g0(e);case"day":case"days":return g1(e);case"week":case"weeks":return g2(e)}}}throw Error("Invalid DurationInput")},gQ={_tag:"Millis",millis:0},gR={_tag:"Infinity"},gS={[gH]:gH,[aJ](){return aT(this,aR(this.value))},[aU](a){return gU(a)&&hc(this,a)},toString(){return`Duration(${hd(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:g4(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},gT=a=>{let b=Object.create(gS);return af(a)?isNaN(a)||a<=0?b.value=gQ:Number.isFinite(a)?Number.isInteger(a)?b.value={_tag:"Millis",millis:a}:b.value={_tag:"Nanos",nanos:BigInt(Math.round(1e6*a))}:b.value=gR:a<=gI?b.value=gQ:b.value={_tag:"Nanos",nanos:a},b},gU=a=>ap(a,gH),gV=gT(0),gW=gT(1/0),gX=a=>gT(a),gY=a=>gT(a*gL),gZ=a=>gT(a),g$=a=>gT(1e3*a),g_=a=>gT(6e4*a),g0=a=>gT(36e5*a),g1=a=>gT(864e5*a),g2=a=>gT(6048e5*a),g3=a=>g5(a,{onMillis:a=>a,onNanos:a=>Number(a)/1e6}),g4=a=>{let b=gP(a);switch(b.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(b.value.nanos/gN),Number(b.value.nanos%gN)];case"Millis":return[Math.floor(b.value.millis/1e3),Math.round(b.value.millis%1e3*1e6)]}},g5=W(2,(a,b)=>{let c=gP(a);switch(c.value._tag){case"Nanos":return b.onNanos(c.value.nanos);case"Infinity":return b.onMillis(1/0);case"Millis":return b.onMillis(c.value.millis)}}),g6=W(3,(a,b,c)=>{let d=gP(a),e=gP(b);if("Infinity"===d.value._tag||"Infinity"===e.value._tag)return c.onMillis(g3(d),g3(e));if("Nanos"===d.value._tag||"Nanos"===e.value._tag){let a="Nanos"===d.value._tag?d.value.nanos:BigInt(Math.round(1e6*d.value.millis)),b="Nanos"===e.value._tag?e.value.nanos:BigInt(Math.round(1e6*e.value.millis));return c.onNanos(a,b)}return c.onMillis(d.value.millis,e.value.millis)}),g7=(a,b)=>g6(a,b,{onMillis:(a,b)=>a===b,onNanos:(a,b)=>a===b}),g8=W(2,(a,b)=>g6(a,b,{onMillis:(a,b)=>gT(a+b),onNanos:(a,b)=>gT(a+b)})),g9=((a,b)=>g6(a,b,{onMillis:(a,b)=>a<b,onNanos:(a,b)=>a<b}),W(2,(a,b)=>g6(a,b,{onMillis:(a,b)=>a<=b,onNanos:(a,b)=>a<=b}))),ha=W(2,(a,b)=>g6(a,b,{onMillis:(a,b)=>a>b,onNanos:(a,b)=>a>b})),hb=W(2,(a,b)=>g6(a,b,{onMillis:(a,b)=>a>=b,onNanos:(a,b)=>a>=b})),hc=W(2,(a,b)=>g7(gP(a),gP(b))),hd=a=>{let b=gP(a);if("Infinity"===b.value._tag)return"Infinity";if((a=>{switch(a.value._tag){case"Millis":return 0===a.value.millis;case"Nanos":return a.value.nanos===gI;case"Infinity":return!1}})(b))return"0";let c=(a=>{let b=gP(a);if("Infinity"===b.value._tag)return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let c=(a=>{let b=gP(a);switch(b.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return b.value.nanos;case"Millis":return BigInt(Math.round(1e6*b.value.millis))}})(b),d=c/gM,e=d/gL,f=e/gK,g=f/gK;return{days:Number(g/gJ),hours:Number(g%gJ),minutes:Number(f%gK),seconds:Number(e%gK),millis:Number(d%gL),nanos:Number(c%gM)}})(b),d=[];return 0!==c.days&&d.push(`${c.days}d`),0!==c.hours&&d.push(`${c.hours}h`),0!==c.minutes&&d.push(`${c.minutes}m`),0!==c.seconds&&d.push(`${c.seconds}s`),0!==c.millis&&d.push(`${c.millis}ms`),0!==c.nanos&&d.push(`${c.nanos}ns`),d.join(" ")};function he(a,b){var c;return c=a&b-1,c-=c>>1&0x55555555,c=(c=(0x33333333&c)+(c>>2&0x33333333))+(c>>4)&0xf0f0f0f,c+=c>>8,127&(c+=c>>16)}let hf=(a,b)=>({value:a,previous:b});function hg(a,b,c,d){let e=d;if(!a){let a=d.length;e=Array(a);for(let b=0;b<a;++b)e[b]=d[b]}return e[b]=c,e}function hh(a,b,c){let d=c.length-1,e=0,f=0,g=c;if(a)e=f=b;else for(g=Array(d);e<b;)g[f++]=c[e++];for(++e;e<=d;)g[f++]=c[e++];return a&&(g.length=d),g}class hi{modify(a,b,c,d,e,f){let g=c(ej());return bD(g)?new hi:(++f.value,new hl(a,d,e,g))}constructor(){this._tag="EmptyNode"}}function hj(a){return aq(a,"EmptyNode")}function hk(a,b){return!hj(a)&&b===a.edit}class hl{constructor(a,b,c,d){this._tag="LeafNode",this.edit=a,this.hash=b,this.key=c,this.value=d}modify(a,b,c,d,e,f){if(aV(e,this.key)){let b=c(this.value);return b===this.value?this:bD(b)?(--f.value,new hi):hk(this,a)?(this.value=b,this):new hl(a,d,e,b)}let g=c(ej());return bD(g)?this:(++f.value,hp(a,b,this.hash,this,d,new hl(a,d,e,g)))}}class hm{constructor(a,b,c){this._tag="CollisionNode",this.edit=a,this.hash=b,this.children=c}modify(a,b,c,d,e,f){if(d===this.hash){let b=hk(this,a),d=this.updateCollisionList(b,a,this.hash,this.children,c,e,f);return d===this.children?this:d.length>1?new hm(a,this.hash,d):d[0]}let g=c(ej());return bD(g)?this:(++f.value,hp(a,b,this.hash,this,d,new hl(a,d,e,g)))}updateCollisionList(a,b,c,d,e,f,g){let h=d.length;for(let i=0;i<h;++i){let h=d[i];if("key"in h&&aV(f,h.key)){let j=h.value,k=e(j);if(k===j)return d;if(bD(k))return--g.value,hh(a,i,d);return hg(a,i,new hl(b,c,f,k),d)}}let i=e(ej());return bD(i)?d:(++g.value,hg(a,h,new hl(b,c,f,i),d))}}class hn{constructor(a,b,c){this._tag="IndexedNode",this.edit=a,this.mask=b,this.children=c}modify(a,b,c,d,e,f){let g,h=this.mask,i=this.children,j=d>>>b&31,k=1<<j,l=he(h,k),m=h&k,n=hk(this,a);if(!m){let g=new hi().modify(a,b+5,c,d,e,f);return g?i.length>=16?function(a,b,c,d,e){let f=[],g=d,h=0;for(let a=0;g;++a)1&g&&(f[a]=e[h++]),g>>>=1;return f[b]=c,new ho(a,h+1,f)}(a,j,g,h,i):new hn(a,h|k,function(a,b,c,d){let e=d.length;if(a){let a=e;for(;a>=b;)d[a--]=d[a];return d[b]=c,d}let f=0,g=0,h=Array(e+1);for(;f<b;)h[g++]=d[f++];for(h[b]=c;f<e;)h[++g]=d[f++];return h}(n,l,g,i)):this}let o=i[l],p=o.modify(a,b+5,c,d,e,f);if(o===p)return this;let q=h;if(hj(p)){var r;if(!(q&=~k))return new hi;if(i.length<=2&&(hj(r=i[1^l])||"LeafNode"===r._tag||"CollisionNode"===r._tag))return i[1^l];g=hh(n,l,i)}else g=hg(n,l,p,i);return n?(this.mask=q,this.children=g,this):new hn(a,q,g)}}class ho{constructor(a,b,c){this._tag="ArrayNode",this.edit=a,this.size=b,this.children=c}modify(a,b,c,d,e,f){let g,h=this.size,i=this.children,j=d>>>b&31,k=i[j],l=(k||new hi).modify(a,b+5,c,d,e,f);if(k===l)return this;let m=hk(this,a);if(hj(k)&&!hj(l))++h,g=hg(m,j,l,i);else if(!hj(k)&&hj(l)){if(--h<=8)return function(a,b,c,d){let e=Array(b-1),f=0,g=0;for(let a=0,b=d.length;a<b;++a)if(a!==c){let b=d[a];b&&!hj(b)&&(e[f++]=b,g|=1<<a)}return new hn(a,g,e)}(a,h,j,i);g=hg(m,j,new hi,i)}else g=hg(m,j,l,i);return m?(this.size=h,this.children=g,this):new ho(a,h,g)}}function hp(a,b,c,d,e,f){let g,h=b;for(;;){let b=function(a,b,c,d,e,f){if(c===e)return new hm(a,c,[f,d]);let g=c>>>b&31,h=e>>>b&31;return g===h?b=>new hn(a,1<<g|1<<h,[b]):new hn(a,1<<g|1<<h,g<h?[d,f]:[f,d])}(a,h,c,d,e,f);if("function"==typeof b)g=hf(b,g),h+=5;else{let a=b;for(;null!=g;)a=g.value(a),g=g.previous;return a}}}let hq="effect/HashMap",hr=Symbol.for(hq),hs={[hr]:hr,[Symbol.iterator](){return new hu(this,(a,b)=>[a,b])},[aJ](){let a=aK(hq);for(let b of this)a^=aa(aK(b[0]),aM(aK(b[1])));return aT(this,a)},[aU](a){if(hz(a)){if(a._size!==this._size)return!1;for(let b of this){let c=aa(a,hB(b[0],aK(b[0])));if(bD(c)||!aV(b[1],c.value))return!1}return!0}return!1},toString(){return a$(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(aZ)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},ht=(a,b,c,d)=>{let e=Object.create(hs);return e._editable=a,e._edit=b,e._root=c,e._size=d,e};class hu{constructor(a,b){this.map=a,this.f=b,this.v=hw(this.map._root,this.f,void 0)}next(){if(bD(this.v))return{done:!0,value:void 0};let a=this.v.value;return this.v=hv(a.cont),{done:!1,value:a.value}}[Symbol.iterator](){return new hu(this.map,this.f)}}let hv=a=>a?hx(a[0],a[1],a[2],a[3],a[4]):ej(),hw=(a,b,c)=>{switch(a._tag){case"LeafNode":if(bE(a.value))return bG({value:b(a.key,a.value.value),cont:c});return hv(c);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let d=a.children;return hx(d.length,d,0,b,c)}default:return hv(c)}},hx=(a,b,c,d,e)=>{for(;c<a;){let f=b[c++];if(f&&!hj(f))return hw(f,d,[a,b,c,d,e])}return hv(e)},hy=ht(!1,0,new hi,0),hz=a=>ap(a,hr),hA=W(2,(a,b)=>hB(a,b,aK(b))),hB=W(3,(a,b,c)=>{let d=a._root,e=0;for(;;)switch(d._tag){case"LeafNode":return aV(b,d.key)?d.value:ej();case"CollisionNode":if(c===d.hash){let a=d.children;for(let c=0,d=a.length;c<d;++c){let d=a[c];if("key"in d&&aV(b,d.key))return d.value}}return ej();case"IndexedNode":{let a=1<<(c>>>e&31);if(d.mask&a){d=d.children[he(d.mask,a)],e+=5;break}return ej()}case"ArrayNode":if(d=d.children[c>>>e&31]){e+=5;break}return ej();default:return ej()}}),hC=W(2,(a,b)=>bE(hB(a,b,aK(b)))),hD=W(3,(a,b,c)=>hI(a,b,()=>bG(c))),hE=W(3,(a,b,c)=>a._editable?(a._root=b,a._size=c,a):b===a._root?a:ht(a._editable,a._edit,b,c)),hF=a=>new hu(a,a=>a),hG=a=>ht(!0,a._edit+1,a._root,a._size),hH=a=>(a._editable=!1,a),hI=((a,b)=>{let c=hG(a);return b(c),hH(c)},W(3,(a,b,c)=>hJ(a,b,aK(b),c))),hJ=W(4,(a,b,c,d)=>{let e={value:a._size},f=a._root.modify(a._editable?a._edit:NaN,0,d,c,b,e);return aa(a,hE(f,e.value))}),hK=W(2,(a,b)=>hI(a,b,ej)),hL=W(2,(a,b)=>hN(a,hy,(a,c,d)=>hD(a,d,b(c,d)))),hM=W(2,(a,b)=>hN(a,void 0,(a,c,d)=>b(c,d))),hN=W(3,(a,b,c)=>{let d,e=a._root;if("LeafNode"===e._tag)return bE(e.value)?c(b,e.value.value,e.key):b;if("EmptyNode"===e._tag)return b;let f=[e.children];for(;d=f.pop();)for(let a=0,e=d.length;a<e;){let e=d[a++];e&&!hj(e)&&("LeafNode"===e._tag?bE(e.value)&&(b=c(b,e.value.value,e.key)):f.push(e.children))}return b}),hO=((a,b)=>{for(let c of a)if(b(c[1],c[0]))return bG(c);return ej()},"effect/HashSet"),hP=Symbol.for(hO),hQ={[hP]:hP,[Symbol.iterator](){return hF(this._keyMap)},[aJ](){return aT(this,aM(aK(this._keyMap))(aK(hO)))},[aU](a){return!!hS(a)&&this._keyMap._size===a._keyMap._size&&aV(this._keyMap,a._keyMap)},toString(){return a$(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(aZ)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},hR=a=>{let b=Object.create(hQ);return b._keyMap=a,b},hS=a=>ap(a,hP),hT=hR(hy),hU=()=>hT,hV=W(2,(a,b)=>hC(a._keyMap,b)),hW=W(2,(a,b)=>{let c=!1;for(let d of a)if(c=b(d))break;return c}),hX=W(2,(a,b)=>!hW(a,a=>!b(a))),hY=a=>hR(hG(a._keyMap)),hZ=a=>(a._keyMap._editable=!1,a),h$=W(2,(a,b)=>{let c=hY(a);return b(c),hZ(c)}),h_=W(2,(a,b)=>a._keyMap._editable?(hD(b,!0)(a._keyMap),a):hR(hD(b,!0)(a._keyMap))),h0=W(2,(a,b)=>a._keyMap._editable?(hK(b)(a._keyMap),a):hR(hK(b)(a._keyMap))),h1=W(2,(a,b)=>h$(a,a=>{for(let c of b)h0(a,c)})),h2=W(2,(a,b)=>h$(hU(),c=>{for(let d of(h3(a,a=>h_(c,a)),b))h_(c,d)})),h3=W(2,(a,b)=>hM(a._keyMap,(a,c)=>b(c))),h4=W(3,(a,b,c)=>hN(a._keyMap,b,(a,b,d)=>c(a,d))),h5=a=>{let b=hY(hU());for(let c of a)h_(b,c);return hZ(b)},h6=(...a)=>{let b=hY(hU());for(let c of a)h_(b,c);return hZ(b)},h7=a=>a._keyMap._size,h8=Symbol.for("effect/MutableRef"),h9={[h8]:h8,toString(){return a$(this.toJSON())},toJSON(){return{_id:"MutableRef",current:aZ(this.current)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},ia=a=>{let b=Object.create(h9);return b.current=a,b},ib=W(3,(a,b,c)=>!!aV(b,a.current)&&(a.current=c,!0)),ic=W(2,(a,b)=>(a.current=b,a)),id="effect/FiberId",ie=Symbol.for(id),ig="None",ih="Runtime",ii="Composite",ij=aQ(`${id}-${ig}`);class ik{[aJ](){return ij}[aU](a){return ip(a)&&a._tag===ig}toString(){return a$(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[aY](){return this.toJSON()}constructor(){this[ie]=ie,this._tag=ig,this.id=-1,this.startTimeMillis=-1}}class il{constructor(a,b){this[ie]=ie,this._tag=ih,this.id=a,this.startTimeMillis=b}[aJ](){return aT(this,aQ(`${id}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[aU](a){return ip(a)&&a._tag===ih&&this.id===a.id&&this.startTimeMillis===a.startTimeMillis}toString(){return a$(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[aY](){return this.toJSON()}}class im{constructor(a,b){this[ie]=ie,this._tag=ii,this.left=a,this.right=b}[aJ](){return aa(aQ(`${id}-${this._tag}`),aM(aK(this.left)),aM(aK(this.right)),aT(this))}[aU](a){return ip(a)&&a._tag===ii&&aV(this.left,a.left)&&aV(this.right,a.right)}toString(){return a$(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:aZ(this.left),right:aZ(this.right)}}[aY](){return this.toJSON()}}let io=new ik,ip=a=>ap(a,ie),iq=a=>a._tag===ig||aa(iw(a),hX(a=>iq(a))),ir=W(2,(a,b)=>a._tag===ig?b:b._tag===ig?a:new im(a,b)),is=W(2,(a,b)=>iq(a)?b:a),it=a=>{switch(a._tag){case ig:return hU();case ih:return h6(a.id);case ii:return aa(it(a.left),h2(it(a.right)))}},iu=ad(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>ia(0)),iv=a=>Array.from(it(a)).map(a=>`#${a}`).join(","),iw=a=>{switch(a._tag){case ig:return hU();case ih:return h6(a);case ii:return aa(iw(a.left),h2(iw(a.right)))}},ix=io,iy=(a,b)=>new il(a,b),iz=ip,iA=()=>{let a=iu.current;return aa(iu,ic(a+1)),new il(a,Date.now())},iB=Symbol.for("effect/List"),iC=a=>eO(a),iD=dQ(fr(aV),iC),iE={[iB]:iB,_tag:"Cons",toString(){return a$(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:iC(this).map(aZ)}},[aY](){return this.toJSON()},[aU](a){return iI(a)&&this._tag===a._tag&&iD(this,a)},[aJ](){return aT(this,aS(iC(this)))},[Symbol.iterator](){let a=!1,b=this;return{next(){if(a)return this.return();if("Nil"===b._tag)return a=!0,this.return();let c=b.head;return b=b.tail,{done:a,value:c}},return:b=>(a||(a=!0),{done:!0,value:b})}},pipe(){return a7(this,arguments)}},iF=(a,b)=>{let c=Object.create(iE);return c.head=a,c.tail=b,c},iG=aQ("Nil"),iH=Object.create({[iB]:iB,_tag:"Nil",toString(){return a$(this.toJSON())},toJSON:()=>({_id:"List",_tag:"Nil"}),[aY](){return this.toJSON()},[aJ]:()=>iG,[aU](a){return iI(a)&&this._tag===a._tag},[Symbol.iterator]:()=>({next:()=>({done:!0,value:void 0})}),pipe(){return a7(this,arguments)}}),iI=a=>ap(a,iB),iJ=a=>"Nil"===a._tag,iK=a=>"Cons"===a._tag,iL=(a,b)=>iF(a,b),iM=()=>iH,iN=a=>iF(a,iH),iO=W(2,(a,b)=>iQ(b,a)),iP=W(2,(a,b)=>iL(b,a)),iQ=W(2,(a,b)=>{if(iJ(a))return b;{if(iJ(b))return a;let c=iF(b.head,a),d=c,e=b.tail;for(;!iJ(e);){let b=iF(e.head,a);d.tail=b,d=b,e=e.tail}return c}}),iR=W(3,(a,b,c)=>{let d=b,e=a;for(;!iJ(e);)d=c(d,e.head),e=e.tail;return d}),iS=a=>{let b=iM(),c=a;for(;!iJ(c);)b=iP(b,c.head),c=c.tail;return b};Array.prototype;let iT=function(){function a(a){a&&Object.assign(this,a)}return a.prototype=bs,a}(),iU=a=>Object.assign(Object.create(bs),a),iV=Symbol.for("effect/DifferChunkPatch");function iW(a){return a}let iX=({...iT.prototype,[iV]:{_Value:iW,_Patch:iW}},Symbol.for("effect/DifferContextPatch"));function iY(a){return a}let iZ={...iT.prototype,[iX]:{_Value:iY,_Patch:iY}},i$=Object.create(Object.assign(Object.create(iZ),{_tag:"Empty"})),i_=Object.assign(Object.create(iZ),{_tag:"AndThen"}),i0=Object.assign(Object.create(iZ),{_tag:"AddService"}),i1=(a,b)=>{let c=Object.create(i0);return c.key=a,c.service=b,c},i2=Object.assign(Object.create(iZ),{_tag:"RemoveService"}),i3=a=>{let b=Object.create(i2);return b.key=a,b},i4=Object.assign(Object.create(iZ),{_tag:"UpdateService"}),i5=(a,b)=>{let c=Object.create(i4);return c.key=a,c.update=b,c},i6=W(2,(a,b)=>((a,b)=>{let c=Object.create(i_);return c.first=a,c.second=b,c})(a,b)),i7=W(2,(a,b)=>{if("Empty"===a._tag)return b;let c=!1,d=fX(a),e=new Map(b.unsafeMap);for(;gg(d);){let a=gi(d),b=gn(d);switch(a._tag){case"Empty":d=b;break;case"AddService":e.set(a.key,a.service),d=b;break;case"AndThen":d=f5(f5(b,a.second),a.first);break;case"RemoveService":e.delete(a.key),d=b;break;case"UpdateService":e.set(a.key,a.update(e.get(a.key))),c=!0,d=b}}if(!c)return bO(e);let f=new Map;for(let[a]of b.unsafeMap)e.has(a)&&(f.set(a,e.get(a)),e.delete(a));for(let[a,b]of e)f.set(a,b);return bO(f)}),i8=Symbol.for("effect/DifferHashMapPatch");function i9(a){return a}let ja=({...iT.prototype,[i8]:{_Value:i9,_Key:i9,_Patch:i9}},Symbol.for("effect/DifferHashSetPatch"));function jb(a){return a}let jc={...iT.prototype,[ja]:{_Value:jb,_Key:jb,_Patch:jb}},jd=Object.create(Object.assign(Object.create(jc),{_tag:"Empty"})),je=Object.assign(Object.create(jc),{_tag:"AndThen"}),jf=Object.assign(Object.create(jc),{_tag:"Add"}),jg=Object.assign(Object.create(jc),{_tag:"Remove"}),jh=W(2,(a,b)=>((a,b)=>{let c=Object.create(je);return c.first=a,c.second=b,c})(a,b)),ji=W(2,(a,b)=>{if("Empty"===a._tag)return b;let c=b,d=fX(a);for(;gg(d);){let a=gi(d),b=gn(d);switch(a._tag){case"Empty":d=b;break;case"AndThen":d=f5(a.first)(f5(a.second)(b));break;case"Add":c=h_(a.value)(c),d=b;break;case"Remove":c=h0(a.value)(c),d=b}}return c}),jj=Symbol.for("effect/DifferOrPatch");function jk(a){return a}let jl={...iT.prototype,[jj]:{_Value:jk,_Key:jk,_Patch:jk}},jm=Object.assign(Object.create(jl),{_tag:"AndThen"}),jn=((a,b)=>((a,b)=>{let c=Object.create(jm);return c.first=a,c.second=b,c})(a,b),Symbol.for("effect/DifferReadonlyArrayPatch"));function jo(a){return a}let jp={...iT.prototype,[jn]:{_Value:jo,_Patch:jo}},jq=Object.create(Object.assign(Object.create(jp),{_tag:"Empty"})),jr=Object.assign(Object.create(jp),{_tag:"AndThen"}),js=Object.assign(Object.create(jp),{_tag:"Append"}),jt=Object.assign(Object.create(jp),{_tag:"Slice"}),ju=Object.assign(Object.create(jp),{_tag:"Update"}),jv=(a,b)=>{let c=Object.create(ju);return c.index=a,c.patch=b,c},jw=W(2,(a,b)=>((a,b)=>{let c=Object.create(jr);return c.first=a,c.second=b,c})(a,b)),jx=W(3,(a,b,c)=>{if("Empty"===a._tag)return b;let d=b.slice(),e=fe(a);for(;ei(e);){let a=e_(e),b=e1(e);switch(a._tag){case"Empty":e=b;break;case"AndThen":b.unshift(a.first,a.second),e=b;break;case"Append":for(let b of a.values)d.push(b);e=b;break;case"Slice":d=d.slice(a.from,a.until),e=b;break;case"Update":d[a.index]=c.patch(a.patch,d[a.index]),e=b}}return d}),jy={[Symbol.for("effect/Differ")]:{_P:X,_V:X},pipe(){return a7(this,arguments)}},jz=a=>{let b=Object.create(jy);return b.empty=a.empty,b.diff=a.diff,b.combine=a.combine,b.patch=a.patch,b},jA=()=>jB((a,b)=>b),jB=a=>jz({empty:X,combine:(a,b)=>a===X?b:b===X?a:c=>b(a(c)),diff:(a,b)=>aV(a,b)?X:Y(b),patch:(b,c)=>a(c,b(c))}),jC=(a,b)=>(255&a)+((b&a&255)<<8),jD=jC(0,0),jE=W(2,(a,b)=>jC(255&a&~b,a>>8&255)),jF=W(2,(a,b)=>a|b),jG=a=>jL(a,32),jH=W(2,(a,b)=>a&~b),jI=W(2,(a,b)=>a|b),jJ=a=>jK(a)&&!jP(a),jK=a=>jL(a,1),jL=W(2,(a,b)=>(a&b)!=0),jM=(...a)=>a.reduce((a,b)=>a|b,0),jN=jM(0),jO=a=>jL(a,4),jP=a=>jL(a,16),jQ=W(2,(a,b)=>jC(a^b,b)),jR=W(2,(a,b)=>a&(~(255&b)>>>0&255|b>>8&255)|255&b&(b>>8&255)),jS=jz({empty:jD,diff:(a,b)=>jQ(a,b),combine:(a,b)=>jF(b)(a),patch:(a,b)=>jR(b,a)}),jT=a=>jC(a,0),jU="Empty",jV="Fail",jW="Interrupt",jX="Parallel",jY="Sequential",jZ="effect/Cause",j$=Symbol.for(jZ),j_={[j$]:{_E:a=>a},[aJ](){return aa(aK(jZ),aM(aK(kk(this))),aT(this))},[aU](a){return j6(a)&&kj(this,a)},pipe(){return a7(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:aZ(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:aZ(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:aZ(this.left),right:aZ(this.right)}}},toString(){return ku(this)},[aY](){return this.toJSON()}},j0=(()=>{let a=Object.create(j_);return a._tag=jU,a})(),j1=a=>{let b=Object.create(j_);return b._tag=jV,b.error=a,b},j2=a=>{let b=Object.create(j_);return b._tag="Die",b.defect=a,b},j3=a=>{let b=Object.create(j_);return b._tag=jW,b.fiberId=a,b},j4=(a,b)=>{let c=Object.create(j_);return c._tag=jX,c.left=a,c.right=b,c},j5=(a,b)=>{let c=Object.create(j_);return c._tag=jY,c.left=a,c.right=b,c},j6=a=>ap(a,j$),j7=a=>a._tag===jU||ks(a,!0,(a,b)=>{switch(b._tag){case jU:return bG(a);case"Die":case jV:case jW:return bG(!1);default:return ej()}}),j8=a=>bE(ke(a)),j9=a=>kt(void 0,ko)(a),ka=a=>f_(ks(a,fV(),(a,b)=>"Die"===b._tag?bG(aa(a,f5(b.defect))):ej())),kb=a=>ks(a,hU(),(a,b)=>b._tag===jW?bG(aa(a,h_(b.fiberId))):ej()),kc=a=>km(a,a=>a._tag===jV?bG(a.error):ej()),kd=a=>{let b=kc(a);switch(b._tag){case"None":return dt(a);case"Some":return ds(b.value)}},ke=a=>km(a,a=>a._tag===jW?bG(a.fiberId):ej()),kf=a=>kr(a,{onEmpty:j0,onFail:()=>j0,onDie:j2,onInterrupt:j3,onSequential:j5,onParallel:j4}),kg=W(2,(a,b)=>kr(a,{onEmpty:bG(j0),onFail:a=>bG(j1(a)),onDie:a=>bE(b(a))?ej():bG(j2(a)),onInterrupt:a=>bG(j3(a)),onSequential:eA(j5),onParallel:eA(j4)})),kh=W(2,(a,b)=>ki(a,a=>j1(b(a)))),ki=W(2,(a,b)=>kr(a,{onEmpty:j0,onFail:a=>b(a),onDie:a=>j2(a),onInterrupt:a=>j3(a),onSequential:(a,b)=>j5(a,b),onParallel:(a,b)=>j4(a,b)})),kj=(a,b)=>{let c=fX(a),d=fX(b);for(;gg(c)&&gg(d);){let[a,b]=aa(gi(c),ks([hU(),fV()],([a,b],c)=>{let[d,e]=kn(c);return bG([aa(a,h2(d)),aa(b,f9(e))])})),[e,f]=aa(gi(d),ks([hU(),fV()],([a,b],c)=>{let[d,e]=kn(c);return bG([aa(a,h2(d)),aa(b,f9(e))])}));if(!aV(a,e))return!1;c=b,d=f}return!0},kk=a=>kl(fX(a),fV()),kl=(a,b)=>{for(;;){let[c,d]=aa(a,fn([hU(),fV()],([a,b],c)=>{let[d,e]=kn(c);return[aa(a,h2(d)),aa(b,f9(e))]})),e=h7(c)>0?aa(b,f5(c)):b;if(gf(d))return f_(e);a=d,b=e}throw Error(ax("Cause.flattenCauseLoop"))},km=W(2,(a,b)=>{let c=[a];for(;c.length>0;){let a=c.pop(),d=b(a);switch(d._tag){case"None":switch(a._tag){case jY:case jX:c.push(a.right),c.push(a.left)}break;case"Some":return d}}return ej()}),kn=a=>{let b=a,c=[],d=hU(),e=fV();for(;void 0!==b;)switch(b._tag){case jU:if(0===c.length)return[d,e];b=c.pop();break;case jV:if(d=h_(d,fW(b._tag,b.error)),0===c.length)return[d,e];b=c.pop();break;case"Die":if(d=h_(d,fW(b._tag,b.defect)),0===c.length)return[d,e];b=c.pop();break;case jW:if(d=h_(d,fW(b._tag,b.fiberId)),0===c.length)return[d,e];b=c.pop();break;case jY:switch(b.left._tag){case jU:b=b.right;break;case jY:b=j5(b.left.left,j5(b.left.right,b.right));break;case jX:b=j4(j5(b.left.left,b.right),j5(b.left.right,b.right));break;default:e=f5(e,b.right),b=b.left}break;case jX:c.push(b.right),b=b.left}throw Error(ax("Cause.evaluateCauseLoop"))},ko={emptyCase:Z,failCase:$,dieCase:$,interruptCase:Z,sequentialCase:(a,b,c)=>b&&c,parallelCase:(a,b,c)=>b&&c},kp="SequentialCase",kq="ParallelCase",kr=W(2,(a,{onDie:b,onEmpty:c,onFail:d,onInterrupt:e,onParallel:f,onSequential:g})=>kt(a,void 0,{emptyCase:()=>c,failCase:(a,b)=>d(b),dieCase:(a,c)=>b(c),interruptCase:(a,b)=>e(b),sequentialCase:(a,b,c)=>g(b,c),parallelCase:(a,b,c)=>f(b,c)})),ks=W(3,(a,b,c)=>{let d=b,e=a,f=[];for(;void 0!==e;){let a=c(d,e);switch(d=bE(a)?a.value:d,e._tag){case jY:case jX:f.push(e.right),e=e.left;break;default:e=void 0}void 0===e&&f.length>0&&(e=f.pop())}return d}),kt=W(3,(a,b,c)=>{let d=[a],e=[];for(;d.length>0;){let a=d.pop();switch(a._tag){case jU:e.push(dt(c.emptyCase(b)));break;case jV:e.push(dt(c.failCase(b,a.error)));break;case"Die":e.push(dt(c.dieCase(b,a.defect)));break;case jW:e.push(dt(c.interruptCase(b,a.fiberId)));break;case jY:d.push(a.right),d.push(a.left),e.push(ds({_tag:kp}));break;case jX:d.push(a.right),d.push(a.left),e.push(ds({_tag:kq}))}}let f=[];for(;e.length>0;){let a=e.pop();switch(a._tag){case"Left":switch(a.left._tag){case kp:{let a=f.pop(),d=f.pop(),e=c.sequentialCase(b,a,d);f.push(e);break}case kq:{let a=f.pop(),d=f.pop(),e=c.parallelCase(b,a,d);f.push(e)}}break;case"Right":f.push(a.right)}}if(0===f.length)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return f.pop()}),ku=(a,b)=>j9(a)?"All fibers interrupted without errors.":kC(a).map(function(a){return b?.renderErrorCause!==!0||void 0===a.cause?a.stack:`${a.stack} {
${kv(a.cause,"  ")}
}`}).join("\n"),kv=(a,b)=>{let c=a.stack.split("\n"),d=`${b}[cause]: ${c[0]}`;for(let a=1,e=c.length;a<e;a++)d+=`
${b}${c[a]}`;return a.cause&&(d+=` {
${kv(a.cause,`${b}  `)}
${b}}`),d};class kw extends globalThis.Error{constructor(a){let b="object"==typeof a&&null!==a,c=Error.stackTraceLimit;Error.stackTraceLimit=1,super(kx(a),b&&"cause"in a&&void 0!==a.cause?{cause:new kw(a.cause)}:void 0),this.span=void 0,""===this.message&&(this.message="An error has occurred"),Error.stackTraceLimit=c,this.name=a instanceof Error?a.name:"Error",b&&(kB in a&&(this.span=a[kB]),Object.keys(a).forEach(b=>{b in this||(this[b]=a[b])})),this.stack=kA(`${this.name}: ${this.message}`,a instanceof Error&&a.stack?a.stack:"",this.span)}}let kx=a=>{if("string"==typeof a)return a;if("object"==typeof a&&null!==a&&a instanceof Error)return a.message;try{let b;if(ap(a,"toString")&&(b=a.toString,"function"==typeof b)&&a.toString!==Object.prototype.toString&&a.toString!==globalThis.Array.prototype.toString)return a.toString()}catch{}return a2(a)},ky=/\((.*)\)/g,kz=ad("effect/Tracer/spanToTrace",()=>new WeakMap),kA=(a,b,c)=>{let d=[a],e=b.startsWith(a)?b.slice(a.length).split("\n"):b.split("\n");for(let a=1;a<e.length;a++){if(e[a].includes(" at new BaseEffectError")||e[a].includes(" at new YieldableError")){a++;continue}if(e[a].includes("Generator.next")||e[a].includes("effect_internal_function"))break;d.push(e[a].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(c){let a=c,b=0;for(;a&&"Span"===a._tag&&b<10;){let c=kz.get(a);if("function"==typeof c){let b=c();if("string"==typeof b){let c=b.matchAll(ky),e=!1;for(let[,b]of c)e=!0,d.push(`    at ${a.name} (${b})`);e||d.push(`    at ${a.name} (${b.replace(/^at /,"")})`)}else d.push(`    at ${a.name}`)}else d.push(`    at ${a.name}`);a=ep(a.parent),b++}}return d.join("\n")},kB=Symbol.for("effect/SpanAnnotation"),kC=a=>kt(a,void 0,{emptyCase:()=>[],dieCase:(a,b)=>[new kw(b)],failCase:(a,b)=>[new kw(b)],interruptCase:()=>[],parallelCase:(a,b,c)=>[...b,...c],sequentialCase:(a,b,c)=>[...b,...c]}),kD="Pending",kE="Done",kF=Symbol.for("effect/Deferred"),kG={_E:a=>a,_A:a=>a},kH=a=>({_tag:kE,effect:a});class kI{constructor(a){this.called=!1,this.self=a}next(a){return this.called?{value:a,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(a){return{value:a,done:!0}}throw(a){throw a}[Symbol.iterator](){return new kI(this.self)}}let kJ=(a,b)=>{let c=new kM("Blocked");return c.effect_instruction_i0=a,c.effect_instruction_i1=b,c},kK=Symbol.for("effect/Effect");class kL{constructor(a,b){this._op=bl,this.patch=a,this.op=b}}class kM{constructor(a){this.effect_instruction_i0=void 0,this.effect_instruction_i1=void 0,this.effect_instruction_i2=void 0,this.trace=void 0,this[kK]=bq,this._op=a}[aU](a){return this===a}[aJ](){return aT(this,aL(this))}pipe(){return a7(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:aZ(this.effect_instruction_i0),effect_instruction_i1:aZ(this.effect_instruction_i1),effect_instruction_i2:aZ(this.effect_instruction_i2)}}toString(){return a$(this.toJSON())}[aY](){return this.toJSON()}[Symbol.iterator](){return new kI(new aC(this))}}class kN{constructor(a){this.effect_instruction_i0=void 0,this.effect_instruction_i1=void 0,this.effect_instruction_i2=void 0,this.trace=void 0,this[kK]=bq,this._op=a,this._tag=a}[aU](a){return mU(a)&&"Failure"===a._op&&aV(this.effect_instruction_i0,a.effect_instruction_i0)}[aJ](){return aa(aQ(this._tag),aM(aK(this.effect_instruction_i0)),aT(this))}get cause(){return this.effect_instruction_i0}pipe(){return a7(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return a$(this.toJSON())}[aY](){return this.toJSON()}[Symbol.iterator](){return new kI(new aC(this))}}class kO{constructor(a){this.effect_instruction_i0=void 0,this.effect_instruction_i1=void 0,this.effect_instruction_i2=void 0,this.trace=void 0,this[kK]=bq,this._op=a,this._tag=a}[aU](a){return mU(a)&&"Success"===a._op&&aV(this.effect_instruction_i0,a.effect_instruction_i0)}[aJ](){return aa(aQ(this._tag),aM(aK(this.effect_instruction_i0)),aT(this))}get value(){return this.effect_instruction_i0}pipe(){return a7(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:aZ(this.value)}}toString(){return a$(this.toJSON())}[aY](){return this.toJSON()}[Symbol.iterator](){return new kI(new aC(this))}}let kP=a=>ap(a,kK),kQ=a=>{let b=new kM(bj);return b.effect_instruction_i0=a,b},kR=W(3,(a,b,c)=>lE(d=>lb(a,a=>lb(k4(lz(()=>d(b(a)))),b=>lz(()=>c(a,b)).pipe(lg({onFailure:a=>{switch(b._tag){case ba:return k7(j5(b.effect_instruction_i0,a));case be:return k7(a)}},onSuccess:()=>b})))))),kS=W(2,(a,b)=>lb(a,()=>ly(b))),kT=a=>kS(a,void 0),kU=function(){let a=new kM(a9);switch(arguments.length){case 2:a.effect_instruction_i0=arguments[0],a.commit=arguments[1];break;case 3:a.effect_instruction_i0=arguments[0],a.effect_instruction_i1=arguments[1],a.commit=arguments[2];break;case 4:a.effect_instruction_i0=arguments[0],a.effect_instruction_i1=arguments[1],a.effect_instruction_i2=arguments[2],a.commit=arguments[3];break;default:throw Error(ax("you're not supposed to end up here"))}return a},kV=(a,b=ix)=>{let c,d=new kM(a8);return d.effect_instruction_i0=b=>{c=a(b)},d.effect_instruction_i1=b,lt(d,a=>kP(c)?c:lF)},kW=(a,b=ix)=>lz(()=>kV(a,b)),kX=(a,b=ix)=>kU(a,function(){let a,c,d,e;function f(b){a?a(b):void 0===c&&(c=b)}let g=new kM(a8);return g.effect_instruction_i0=b=>{a=b,c&&b(c)},g.effect_instruction_i1=b,1!==this.effect_instruction_i0.length?(e=new AbortController,d=aG(()=>this.effect_instruction_i0(f,e.signal))):d=aG(()=>this.effect_instruction_i0(f)),d||e?lt(g,a=>(e&&e.abort(),d??lF)):g}),kY=W(2,(a,b)=>{let c=new kM(bb);return c.effect_instruction_i0=a,c.effect_instruction_i1=b,c}),kZ=W(2,(a,b)=>lh(a,{onFailure:b,onSuccess:ly})),k$=W(3,(a,b,c)=>kY(a,a=>{let d=kd(a);switch(d._tag){case"Left":return b(d.left)?c(d.left):k7(a);case"Right":return k7(d.right)}})),k_=Symbol.for("effect/OriginalAnnotation"),k0=(a,b)=>bE(b)?new Proxy(a,{has:(a,b)=>b===kB||b===k_||b in a,get:(c,d)=>d===kB?b.value:d===k_?a:c[d]}):a,k1=a=>!ao(a)||kB in a?k7(j2(a)):kQ(b=>k7(j2(k0(a,ns(b))))),k2=a=>k8(()=>j2(new mH(a))),k3=a=>lh(a,{onFailure:a=>ly(ds(a)),onSuccess:a=>ly(dt(a))}),k4=a=>lf(a,{onFailure:m_,onSuccess:m6}),k5=a=>!ao(a)||kB in a?k7(j1(a)):kQ(b=>k7(j1(k0(a,ns(b))))),k6=a=>lb(lA(a),k5),k7=a=>{let b=new kN(ba);return b.effect_instruction_i0=a,b},k8=a=>lb(lA(a),k7),k9=kQ(a=>ly(a.id())),la=a=>kQ(b=>a(b.id())),lb=W(2,(a,b)=>{let c=new kM(bc);return c.effect_instruction_i0=a,c.effect_instruction_i1=b,c}),lc=W(2,(a,b)=>lb(a,a=>{let c="function"==typeof b?b(a):b;return kP(c)?c:aw(c)?kV(a=>{c.then(b=>a(ly(b)),b=>a(k5(new mT(b,"An unknown error occurred in Effect.andThen"))))}):ly(c)})),ld=a=>{let b=new kM("OnStep");return b.effect_instruction_i0=a,b},le=a=>lb(a,X),lf=W(2,(a,b)=>lg(a,{onFailure:a=>ly(b.onFailure(a)),onSuccess:a=>ly(b.onSuccess(a))})),lg=W(2,(a,b)=>{let c=new kM(bd);return c.effect_instruction_i0=a,c.effect_instruction_i1=b.onFailure,c.effect_instruction_i2=b.onSuccess,c}),lh=W(2,(a,b)=>lg(a,{onFailure:a=>{if(ka(a).length>0)return k7(kr(a,{onEmpty:j0,onFail:j2,onDie:j2,onInterrupt:j3,onSequential:j5,onParallel:j4}));let c=f_(ks(a,fV(),(a,b)=>b._tag===jV?bG(aa(a,f5(b.error))):ej()));return c.length>0?b.onFailure(gi(c)):k7(a)},onSuccess:b.onSuccess})),li=W(2,(a,b)=>lz(()=>{let c=eO(a),d=eM(c.length),e=0;return kS(lI({while:()=>e<c.length,body:()=>b(c[e],e),step:a=>{d[e++]=a}}),d)})),lj=W(2,(a,b)=>lz(()=>{let c=eO(a),d=0;return lI({while:()=>d<c.length,body:()=>b(c[d],d),step:()=>{d++}})})),lk=W(a=>"boolean"==typeof a[0]||kP(a[0]),(a,b)=>kP(a)?lb(a,a=>a?b.onTrue():b.onFalse()):a?b.onTrue():b.onFalse()),ll=lb(k9,a=>lm(a)),lm=a=>k7(j3(a)),ln=a=>{let b=new kM(bg);return b.effect_instruction_i0=(a=>jC(a,a))(1),b.effect_instruction_i1=()=>a,b},lo=W(2,(a,b)=>lE(c=>lb(k4(c(a)),a=>nh(b,a)))),lp=W(2,(a,b)=>lb(a,a=>lA(()=>b(a)))),lq=W(2,(a,b)=>lh(a,{onFailure:a=>k6(()=>b.onFailure(a)),onSuccess:a=>lA(()=>b.onSuccess(a))})),lr=W(2,(a,b)=>lg(a,{onFailure:a=>{let c=kd(a);switch(c._tag){case"Left":return k6(()=>b(c.left));case"Right":return k7(c.right)}},onSuccess:ly})),ls=((a,b)=>ls(a,a=>mV(a)?lF:b(a.effect_instruction_i0)),W(2,(a,b)=>lE(c=>lg(c(a),{onFailure:a=>{let c=m_(a);return lg(b(c),{onFailure:b=>m_(j5(a,b)),onSuccess:()=>c})},onSuccess:a=>{let c=m6(a);return lO(b(c),c)}})))),lt=W(2,(a,b)=>ls(a,m4({onFailure:a=>j9(a)?kT(b(kb(a))):lF,onSuccess:()=>lF}))),lu=W(2,(a,b)=>lC(a,b,ly)),lv=a=>lw(a,X),lw=W(2,(a,b)=>lh(a,{onFailure:a=>k1(b(a)),onSuccess:ly})),lx=kQ((a,b)=>ly(b.runtimeFlags)),ly=a=>{let b=new kO(be);return b.effect_instruction_i0=a,b},lz=a=>{let b=new kM(a9);return b.commit=a,b},lA=a=>{let b=new kM(bf);return b.effect_instruction_i0=a,b},lB=W(a=>3===a.length||2===a.length&&!(ao(a[1])&&"onlyEffect"in a[1]),(a,b)=>lb(a,a=>{let c="function"==typeof b?b(a):b;return kP(c)?kS(c,a):aw(c)?kV(b=>{c.then(c=>b(ly(a)),a=>b(k5(new mT(a,"An unknown error occurred in Effect.tap"))))}):ly(a)})),lC=W(3,(a,b,c)=>lg(a,{onFailure:a=>ka(a).length>0?k7(es(kr(a,{onEmpty:ej(),onFail:a=>bG(j2(a)),onDie:a=>bG(j2(a)),onInterrupt:()=>ej(),onSequential:eA(j5),onParallel:eA(j4)}))):b(),onSuccess:c})),lD=a=>{let b=new kM(bg);return b.effect_instruction_i0=jT(1),b.effect_instruction_i1=()=>a,b},lE=a=>kU(a,function(){let a=new kM(bg);return a.effect_instruction_i0=jT(1),a.effect_instruction_i1=a=>jK(a)?aG(()=>this.effect_instruction_i0(ln)):aG(()=>this.effect_instruction_i0(lD)),a}),lF=ly(void 0),lG=a=>{let b=new kM(bg);return b.effect_instruction_i0=a,b.effect_instruction_i1=void 0,b},lH=W(2,(a,b)=>lb(b,b=>b?aa(a,lp(bG)):ly(ej()))),lI=a=>{let b=new kM(bh);return b.effect_instruction_i0=a.while,b.effect_instruction_i1=a.body,b.effect_instruction_i2=a.step,b},lJ=a=>lz(()=>{let b=new kM(bi);return b.effect_instruction_i0=a(),b}),lK=W(2,(a,b)=>{let c=new kM(bg);return c.effect_instruction_i0=b,c.effect_instruction_i1=()=>a,c}),lL=a=>{let b=new kM(bk);return void 0!==a?.priority?mm(b,a.priority):b},lM=W(2,(a,b)=>lb(a,a=>lp(b,b=>[a,b]))),lN=W(2,(a,b)=>lb(a,a=>kS(b,a))),lO=W(2,(a,b)=>lb(a,()=>b)),lP=W(3,(a,b,c)=>lb(a,a=>lp(b,b=>c(a,b)))),lQ=kW(()=>{let a=setInterval(()=>{},0x80000000-1);return lA(()=>clearInterval(a))}),lR=a=>lb(k9,b=>aa(a,lS(b))),lS=W(2,(a,b)=>lb(a.interruptAsFork(b),()=>a.await)),lT={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return a7(this,arguments)}},lU={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return a7(this,arguments)}},lV={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return a7(this,arguments)}},lW={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return a7(this,arguments)}},lX={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return a7(this,arguments)}},lY={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return a7(this,arguments)}},lZ={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return a7(this,arguments)}},l$={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return a7(this,arguments)}},l_=[lT,lZ,lY,lX,lW,lV,lU,l$],l0=Symbol.for("effect/FiberRef"),l1={_A:a=>a},l2=a=>kQ(b=>m6(b.getFiberRef(a))),l3=W(2,(a,b)=>lb(l2(a),b)),l4=W(2,(a,b)=>l5(a,()=>[void 0,b])),l5=W(2,(a,b)=>kQ(c=>{let[d,e]=b(c.getFiberRef(a));return c.setFiberRef(a,e),ly(d)})),l6=W(2,(a,b)=>l5(a,a=>[void 0,b(a)])),l7=Symbol.for("effect/RequestResolver"),l8={_A:a=>a,_R:a=>a};class l9{constructor(a,b){this[l7]=l8,this.runAll=a,this.target=b}[aJ](){return aT(this,this.target?aK(this.target):aL(this))}[aU](a){return this.target?ma(a)&&aV(this.target,a.target):this===a}identified(...a){return new l9(this.runAll,fY(a))}pipe(){return a7(this,arguments)}}let ma=a=>ap(a,l7),mb=W(3,(a,b,c)=>kR(lN(l2(b),l4(b,c)),()=>a,a=>l4(b,a))),mc=W(3,(a,b,c)=>l3(b,d=>mb(a,b,c(d)))),md=(a,b)=>mf(a,{differ:jA(),fork:b?.fork??X,join:b?.join}),me=a=>{let b=jz({empty:i$,combine:(a,b)=>i6(b)(a),diff:(a,b)=>((a,b)=>{let c=new Map(a.unsafeMap),d=i$;for(let[a,e]of b.unsafeMap.entries())if(c.has(a)){let b=c.get(a);c.delete(a),aV(b,e)||(d=i6(i5(a,()=>e))(d))}else c.delete(a),d=i6(i1(a,e))(d);for(let[a]of c.entries())d=i6(i3(a))(d);return d})(a,b),patch:(a,b)=>i7(b)(a)});return mf(a,{differ:b,fork:b.empty})},mf=(a,b)=>({...bt,[l0]:l1,initial:a,commit(){return l2(this)},diff:(a,c)=>b.differ.diff(a,c),combine:(a,c)=>b.differ.combine(a,c),patch:a=>c=>b.differ.patch(a,c),fork:b.fork,join:b.join??((a,b)=>b)}),mg=ad(Symbol.for("effect/FiberRef/currentContext"),()=>me(bQ)),mh=ad(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>md(0)),mi=ad(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>md(2048)),mj=ad(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>md(hy)),mk=ad(Symbol.for("effect/FiberRef/currentLogLevel"),()=>md(lX)),ml=ad(Symbol.for("effect/FiberRef/currentLogSpan"),()=>md(iM())),mm=W(2,(a,b)=>mb(a,mh,b)),mn=ad(Symbol.for("effect/FiberRef/currentConcurrency"),()=>md("unbounded")),mo=ad(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>md(!0)),mp=ad(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>md(bG(lY))),mq=ad(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>(a=>{let b=(a=>jz({empty:jq,combine:(a,b)=>jw(a,b),diff:(b,c)=>(a=>{let b=0,c=jq;for(;b<a.oldValue.length&&b<a.newValue.length;){let d=a.oldValue[b],e=a.newValue[b],f=a.differ.diff(d,e);aV(f,a.differ.empty)||(c=jw(c,jv(b,f))),b+=1}return b<a.oldValue.length&&(c=jw(c,((a,b)=>{let c=Object.create(jt);return c.from=a,c.until=b,c})(0,b))),b<a.newValue.length&&(c=jw(c,(a=>{let b=Object.create(js);return b.values=a,b})(e3(b)(a.newValue)))),c})({oldValue:b,newValue:c,differ:a}),patch:(b,c)=>jx(b,c,a)}))(jA());return mf(a,{differ:b,fork:b.empty})})(fd())),mr=ad(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>md(ej(),{fork:()=>ej(),join:(a,b)=>a})),ms=ad(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>md(j0,{fork:()=>j0,join:(a,b)=>a})),mt=ad(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>md(!0)),mu=ad(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>md(!0)),mv=ad(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>md(hy)),mw=ad(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>md(fV())),mx=Symbol.for("effect/Scope"),my=Symbol.for("effect/CloseableScope"),mz=(a,b)=>a.addFinalizer(()=>kT(b)),mA=(a,b)=>a.addFinalizer(b),mB=(a,b)=>a.close(b),mC=(a,b)=>a.fork(b),mD=W(2,(a,b)=>{let c=aa(a,kc,et(b));switch(c._tag){case"None":return aa(ka(a),gh,ek({onNone:()=>{let b=eO(kb(a)).flatMap(a=>eO(it(a)).map(a=>`#${a}`));return new mJ(b?`Interrupted by fibers: ${b.join(", ")}`:void 0)},onSome:X}));case"Some":return c.value}}),mE=function(){class a extends globalThis.Error{commit(){return k5(this)}toJSON(){let a={...this};return this.message&&(a.message=this.message),this.cause&&(a.cause=this.cause),a}[aY](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split("\n").slice(1).join("\n")}`:this.toString():"Bun"in globalThis?ku(j1(this),{renderErrorCause:!0}):this}}return Object.assign(a.prototype,bu),a}(),mF=(a,b)=>{class c extends mE{constructor(...a){super(...a),this._tag=b}}return Object.assign(c.prototype,a),c.prototype.name=b,c},mG=Symbol.for("effect/Cause/errors/RuntimeException"),mH=mF({[mG]:mG},"RuntimeException"),mI=Symbol.for("effect/Cause/errors/InterruptedException"),mJ=mF({[mI]:mI},"InterruptedException"),mK=a=>ap(a,mI),mL=Symbol.for("effect/Cause/errors/IllegalArgument"),mM=mF({[mL]:mL},"IllegalArgumentException"),mN=Symbol.for("effect/Cause/errors/NoSuchElement"),mO=mF({[mN]:mN},"NoSuchElementException"),mP=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),mQ=mF({[mP]:mP},"InvalidPubSubCapacityException"),mR=Symbol.for("effect/Cause/errors/Timeout"),mS=Symbol.for("effect/Cause/errors/UnknownException"),mT=function(){class a extends mE{constructor(a,b){super(b??"An unknown error occurred",{cause:a}),this._tag="UnknownException",this.error=a}}return Object.assign(a.prototype,{[mS]:mS,name:"UnknownException"}),a}(),mU=a=>kP(a)&&"_tag"in a&&("Success"===a._tag||"Failure"===a._tag),mV=a=>"Success"===a._tag,mW=W(2,(a,b)=>{switch(a._tag){case ba:return m_(a.effect_instruction_i0);case be:return m6(b)}}),mX=a=>mW(a,void 0),mY=(a,b)=>nb(a,b?.parallel?j4:j5),mZ=a=>m_(j2(a)),m$=a=>m_(j1(a)),m_=a=>{let b=new kN(ba);return b.effect_instruction_i0=a,b},m0=W(2,(a,b)=>{switch(a._tag){case ba:return m_(a.effect_instruction_i0);case be:return b(a.effect_instruction_i0)}}),m1=W(2,(a,b)=>{switch(a._tag){case ba:return ly(m_(a.effect_instruction_i0));case be:return k4(b(a.effect_instruction_i0))}}),m2=a=>m_(j3(a)),m3=W(2,(a,b)=>{switch(a._tag){case ba:return m_(a.effect_instruction_i0);case be:return m6(b(a.effect_instruction_i0))}}),m4=W(2,(a,{onFailure:b,onSuccess:c})=>{switch(a._tag){case ba:return b(a.effect_instruction_i0);case be:return c(a.effect_instruction_i0)}}),m5=W(2,(a,{onFailure:b,onSuccess:c})=>{switch(a._tag){case ba:return b(a.effect_instruction_i0);case be:return c(a.effect_instruction_i0)}}),m6=a=>{let b=new kO(be);return b.effect_instruction_i0=a,b},m7=m6(void 0),m8=W(2,(a,b)=>na(a,b,{onSuccess:(a,b)=>[a,b],onFailure:j5})),m9=W(2,(a,b)=>na(a,b,{onSuccess:(a,b)=>b,onFailure:j5})),na=W(3,(a,b,{onFailure:c,onSuccess:d})=>{switch(a._tag){case ba:switch(b._tag){case be:return m_(a.effect_instruction_i0);case ba:return m_(c(a.effect_instruction_i0,b.effect_instruction_i0))}case be:switch(b._tag){case be:return m6(d(a.effect_instruction_i0,b.effect_instruction_i0));case ba:return m_(b.effect_instruction_i0)}}}),nb=(a,b)=>{let c=fY(a);return gg(c)?aa(gn(c),fn(aa(gi(c),m3(fX)),(a,c)=>aa(a,na(c,{onSuccess:(a,b)=>aa(a,f5(b)),onFailure:b}))),m3(f_),m3(a=>f$(a)),bG):ej()},nc=a=>({...bt,[kF]:kG,state:ia({_tag:kD,joiners:[]}),commit(){return nf(this)},blockingOn:a}),nd=()=>lb(k9,a=>ne(a)),ne=a=>lA(()=>nc(a)),nf=a=>kW(b=>{let c=a.state.current;switch(c._tag){case kE:return b(c.effect);case kD:return c.joiners.push(b),nm(a,b)}},a.blockingOn),ng=W(2,(a,b)=>lA(()=>{let c=a.state.current;switch(c._tag){case kE:return!1;case kD:ic(a.state,kH(b));for(let a=0,d=c.joiners.length;a<d;a++)c.joiners[a](b);return!0}})),nh=W(2,(a,b)=>ng(a,b)),ni=((a,b)=>ng(a,k5(b)),W(2,(a,b)=>ng(a,k7(b)))),nj=W(2,(a,b)=>ng(a,lm(b))),nk=W(2,(a,b)=>ng(a,ly(b))),nl=(a,b)=>{let c=a.state.current;if(c._tag===kD){ic(a.state,kH(b));for(let a=0,d=c.joiners.length;a<d;a++)c.joiners[a](b)}},nm=(a,b)=>lA(()=>{let c=a.state.current;if(c._tag===kD){let a=c.joiners.indexOf(b);a>=0&&c.joiners.splice(a,1)}}),nn=kQ(a=>m6(a.currentContext)),no=a=>lb(nn,a),np=W(2,(a,b)=>mb(mg,b)(a)),nq=W(2,(a,b)=>mc(mg,a=>bX(a,b))(a)),nr=W(2,(a,b)=>no(c=>np(a,b(c)))),ns=((a,b)=>lb(a,a=>lb(b.predicate(a),c=>c?ly(a):b.orElse(a))),a=>{let b=a.currentSpan;return void 0!==b&&"Span"===b._tag?bG(b):ej()}),nt={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:m7},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},nu=Symbol.for("effect/Clock"),nv=bY("effect/Clock"),nw=0x80000000-1,nx={unsafeSchedule(a,b){let c=g3(b);if(c>nw)return $;let d=!1,e=setTimeout(()=>{d=!0,a()},c);return()=>(clearTimeout(e),!d)}},ny=function(){let a,b=BigInt(1e6);return"undefined"==typeof performance?()=>BigInt(Date.now())*b:()=>(void 0===a&&(a=BigInt(Date.now())*b-BigInt(Math.round(1e6*performance.now()))),a+BigInt(Math.round(1e6*performance.now())))}(),nz=function(){let a="object"==typeof process&&"hrtime"in process&&"function"==typeof process.hrtime.bigint?process.hrtime:void 0;if(!a)return ny;let b=ny()-a.bigint();return()=>b+a.bigint()}();class nA{unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return nz()}scheduler(){return ly(nx)}sleep(a){return kX(b=>kT(lA(nx.unsafeSchedule(()=>b(lF),a))))}constructor(){this[nu]=nu,this.currentTimeMillis=lA(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=lA(()=>this.unsafeCurrentTimeNanos())}}let nB=a=>a.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),nC={_tag:"Empty"},nD=W(2,(a,b)=>({_tag:"AndThen",first:a,second:b})),nE=W(2,(a,b)=>nD(a,{_tag:"MapName",f:b})),nF=W(2,(a,b)=>nD(a,{_tag:"Nested",name:b})),nG=W(2,(a,b)=>nD(a,{_tag:"Unnested",name:b})),nH=W(2,(a,b)=>{let c=iN(b),d=a;for(;iK(c);){let a=c.head;switch(a._tag){case"Empty":c=c.tail;break;case"AndThen":c=iL(a.first,iL(a.second,c.tail));break;case"MapName":d=ff(d,a.f),c=c.tail;break;case"Nested":d=eS(d,a.name),c=c.tail;break;case"Unnested":if(!aa(e$(d),ey(a.name)))return ds(gC(d,`Expected ${a.name} to be in path in ConfigProvider#unnested`));d=e1(d),c=c.tail}}return dt(d)}),nI="Constant",nJ="Fallback",nK="Lazy",nL="MapOrFail",nM="Nested",nN="Primitive",nO="ZipWith",nP=a=>a.toLowerCase(),nQ=a=>a.toUpperCase(),nR=(a,b,c)=>b instanceof RegExp?a.replace(b,c):b.reduce((a,b)=>a.replace(b,c),a),nS=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],nT=/[^A-Z0-9]+/gi,nU=(a,b)=>((a,b={})=>{let{delimiter:c=" ",splitRegexp:d=nS,stripRegexp:e=nT,transform:f=nP}=b,g=nR(nR(a,d,"$1\0$2"),e,"\0"),h=0,i=g.length;for(;"\0"===g.charAt(h);)h++;for(;"\0"===g.charAt(i-1);)i--;return g.slice(h,i).split("\0").map(f).join(c)})(a,{delimiter:"_",transform:nQ,...b}),nV=(a,b)=>[...a,...b],nW=Symbol.for("effect/ConfigProvider"),nX=bY("effect/ConfigProvider"),nY=Symbol.for("effect/ConfigProviderFlat"),nZ=a=>({[nY]:nY,patch:a.patch,load:(b,c,d=!0)=>a.load(b,c,d),enumerateChildren:a.enumerateChildren}),n$=a=>({[nW]:nW,pipe(){return a7(this,arguments)},...{load:b=>lb(n1(a,fd(),b,!1),a=>ek(e$(a),{onNone:()=>k5(gC(fd(),`Expected a single value having structure: ${b}`)),onSome:ly})),flattened:a}}),n_=a=>{let{pathDelim:b,seqDelim:c}=Object.assign({},{pathDelim:"_",seqDelim:","},a),d=()=>"undefined"!=typeof process&&"env"in process&&"object"==typeof process.env?process.env:{};return n$(nZ({load:(a,e,f=!0)=>{let g=aa(a,fu(b)),h=d();return aa(g in h?bG(h[g]):ej(),lr(()=>gC(a,`Expected ${g} to exist in the process context`)),lb(b=>n8(b,a,e,c,f)))},enumerateChildren:a=>lA(()=>h5(Object.keys(d()).map(a=>a.toUpperCase().split(b)).filter(b=>{for(let c=0;c<a.length;c++){let d=aa(a,eZ(c)),e=b[c];if(void 0===e||d!==e)return!1}return!0}).flatMap(b=>b.slice(a.length,a.length+1)))),patch:nC}))},n0=(a,b)=>{let{pathDelim:c,seqDelim:d}=Object.assign({seqDelim:",",pathDelim:"."},b),e=a=>aa(a,fu(c)),f=a=>a.split(c),g=oe(a,a=>f(a),e);return n$(nZ({load:(a,b,c=!0)=>{let f=e(a);return aa(g.has(f)?bG(g.get(f)):ej(),lr(()=>gC(a,`Expected ${f} to exist in the provided map`)),lb(e=>n8(e,a,b,d,c)))},enumerateChildren:a=>lA(()=>h5(eO(g.keys()).map(f).filter(b=>{for(let c=0;c<a.length;c++){let d=aa(a,eZ(c)),e=b[c];if(void 0===e||d!==e)return!1}return!0}).flatMap(b=>b.slice(a.length,a.length+1)))),patch:nC}))},n1=(a,b,c,d)=>{switch(c._tag){case nI:return ly(fe(c.value));case"Described":return lz(()=>n1(a,b,c.config,d));case"Fail":return k5(gC(b,c.message));case nJ:return aa(lz(()=>n1(a,b,c.first,d)),kZ(e=>c.condition(e)?aa(n1(a,b,c.second,d),kZ(a=>k5(gA(e,a)))):k5(e)));case nK:return lz(()=>n1(a,b,c.config(),d));case nL:return lz(()=>aa(n1(a,b,c.original,d),lb(li(a=>aa(c.mapOrFail(a),lr(gD(((a,b)=>{let c=b;if("Nested"===c._tag){let b=a.slice();for(;"Nested"===c._tag;)b.push(c.name),c=c.config;return b}return a})(b,c.original))))))));case nM:return lz(()=>n1(a,nV(b,fe(c.name)),c.config,d));case nN:return aa(nH(b,a.patch),lb(b=>aa(a.load(b,c,d),lb(a=>{if(0===a.length){let a=aa((a=>eW(a)?bG(e0(a)):ej())(b),el(()=>"<n/a>"));return k5(gC([],`Expected ${c.description} with name ${a}`))}return ly(a)}))));case"Sequence":return aa(nH(b,a.patch),lb(d=>aa(a.enumerateChildren(d),lb(oa),lb(d=>0===d.length?lz(()=>lp(n1(a,b,c.config,!0),fe)):aa(li(d,d=>n1(a,eT(b,`[${d}]`),c.config,!0)),lp(a=>{let b=fh(a);return 0===b.length?fe(fd()):fe(b)}))))));case"HashMap":return lz(()=>aa(nH(b,a.patch),lb(b=>aa(a.enumerateChildren(b),lb(e=>aa(e,li(e=>n1(a,nV(b,fe(e)),c.valueConfig,d)),lp(a=>0===a.length?fe(hy):aa(n9(a),ff(a=>(a=>{let b=hG(hy);for(let c of a)hD(b,c[0],c[1]);return hH(b)})(e6(eO(e),a)))))))))));case nO:return lz(()=>aa(n1(a,b,c.left,d),k3,lb(e=>aa(n1(a,b,c.right,d),k3,lb(a=>{if(dq(e)&&dq(a))return k5(gz(e.left,a.left));if(dq(e)&&dr(a))return k5(e.left);if(dr(e)&&dq(a))return k5(a.left);if(dr(e)&&dr(a)){let d=aa(b,fu(".")),f=n2(b,d),[g,h]=((a,b,c,d)=>{let e=fq(c.length,b=>b>=d.length?ej():bG([a(b),b+1])),f=fq(d.length,a=>a>=c.length?ej():bG([b(a),a+1]));return[nV(c,e),nV(d,f)]})(f,f,aa(e.right,ff(dt)),aa(a.right,ff(dt)));return aa(g,e6(h),li(([a,b])=>aa(lM(a,b),lp(([a,b])=>c.zip(a,b)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},n2=(a,b)=>c=>ds(gC(a,`The element at index ${c} in a sequence at path "${b}" was missing`)),n3=W(2,(a,b)=>n$(n4(a.flattened,b))),n4=(a,b)=>nZ({load:(b,c,d=!0)=>a.load(b,c,d),enumerateChildren:b=>a.enumerateChildren(b),patch:nE(a.patch,b)}),n5=W(2,(a,b)=>n$(nZ({load:(b,c)=>a.flattened.load(b,c,!0),enumerateChildren:b=>a.flattened.enumerateChildren(b),patch:nF(a.flattened.patch,b)}))),n6=((a,b)=>n$(nZ({load:(b,c)=>a.flattened.load(b,c,!0),enumerateChildren:b=>a.flattened.enumerateChildren(b),patch:nG(a.flattened.patch,b)})),W(2,(a,b)=>n$(n7(a.flattened,()=>b().flattened)))),n7=(a,b)=>nZ({load:(c,d,e)=>aa(nH(c,a.patch),lb(b=>a.load(b,d,e)),kZ(a=>aa(lA(b),lb(b=>aa(nH(c,b.patch),lb(a=>b.load(a,d,e)),kZ(b=>k5(gA(a,b)))))))),enumerateChildren:c=>aa(nH(c,a.patch),lb(b=>a.enumerateChildren(b)),k3,lb(a=>aa(lA(b),lb(b=>aa(nH(c,b.patch),lb(a=>b.enumerateChildren(a)),k3,lb(b=>{if(dq(a)&&dq(b))return k5(gz(a.left,b.left));if(dq(a)&&dr(b))return ly(b.right);if(dr(a)&&dq(b))return ly(a.right);if(dr(a)&&dr(b))return ly(aa(a.right,h2(b.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:nC}),n8=(a,b,c,d,e)=>e?aa(a.split(RegExp(`\\s*${nB(d)}\\s*`)),li(a=>c.parse(a.trim())),lr(gD(b))):aa(c.parse(a),lq({onFailure:gD(b),onSuccess:fe})),n9=a=>Object.keys(a[0]).map(b=>a.map(a=>a[b])),oa=a=>aa(li(a,od),lq({onFailure:()=>fd(),onSuccess:e5(eD)}),k3,lp(dz)),ob=/(^.+)(\[(\d+)\])$/,oc=/^(\[(\d+)\])$/,od=a=>{let b=a.match(oc);if(null!==b){let a=b[2];return aa(void 0!==a&&a.length>0?bG(a):ej(),eu(og))}return ej()},oe=(a,b,c)=>{let d=new Map;for(let[e,f]of a){let a=aa(b(e),fg(a=>ek(of(a),{onNone:()=>fe(a),onSome:([a,b])=>eL(a,`[${b}]`)})));d.set(c(a),f)}return d},of=a=>{let b=a.match(ob);if(null!==b){let a=b[1],c=b[3];return(a=>{if(Symbol.iterator in a){let b=[];for(let c of a){if(bD(c))return ej();b.push(c.value)}return bG(b)}let b={};for(let c of Object.keys(a)){let d=a[c];if(bD(d))return ej();b[c]=d.value}return bG(b)})([void 0!==a&&a.length>0?bG(a):ej(),aa(void 0!==c&&c.length>0?bG(c):ej(),eu(og))])}return ej()},og=a=>{let b=Number.parseInt(a);return Number.isNaN(b)?ej():bG(b)},oh=Symbol.for("effect/Console"),oi=bY("effect/Console"),oj={[oh]:oh,assert:(a,...b)=>lA(()=>{console.assert(a,...b)}),clear:lA(()=>{console.clear()}),count:a=>lA(()=>{console.count(a)}),countReset:a=>lA(()=>{console.countReset(a)}),debug:(...a)=>lA(()=>{console.debug(...a)}),dir:(a,b)=>lA(()=>{console.dir(a,b)}),dirxml:(...a)=>lA(()=>{console.dirxml(...a)}),error:(...a)=>lA(()=>{console.error(...a)}),group:a=>a?.collapsed?lA(()=>console.groupCollapsed(a?.label)):lA(()=>console.group(a?.label)),groupEnd:lA(()=>{console.groupEnd()}),info:(...a)=>lA(()=>{console.info(...a)}),log:(...a)=>lA(()=>{console.log(...a)}),table:(a,b)=>lA(()=>{console.table(a,b)}),time:a=>lA(()=>console.time(a)),timeEnd:a=>lA(()=>console.timeEnd(a)),timeLog:(a,...b)=>lA(()=>{console.timeLog(a,...b)}),trace:(...a)=>lA(()=>{console.trace(...a)}),warn:(...a)=>lA(()=>{console.warn(...a)}),unsafe:console},ok=Symbol.for("effect/Random"),ol=bY("effect/Random");class om{constructor(a){this[ok]=ok,this.seed=a,this.PRNG=new az(a)}get next(){return lA(()=>this.PRNG.number())}get nextBoolean(){return lp(this.next,a=>a>.5)}get nextInt(){return lA(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(a,b){return lp(this.next,c=>(b-a)*c+a)}nextIntBetween(a,b){return lA(()=>this.PRNG.integer(b-a)+a)}shuffle(a){return on(a,a=>this.nextIntBetween(0,a))}}let on=(a,b)=>lz(()=>aa(lA(()=>Array.from(a)),lb(a=>{let c=[];for(let b=a.length;b>=2;b-=1)c.push(b);return aa(c,lj(c=>aa(b(c),lp(b=>oo(a,c-1,b)))),kS(fY(a)))}))),oo=(a,b,c)=>{let d=a[b];return a[b]=a[c],a[c]=d,a},op=Symbol.for("effect/Tracer"),oq=bY("effect/Tracer"),or=bY("effect/ParentSpan"),os=function(){let a="abcdef0123456789",b=a.length;return function(c){let d="";for(let e=0;e<c;e++)d+=a.charAt(Math.floor(Math.random()*b));return d}}();class ot{constructor(a,b,c,d,e,f){this._tag="Span",this.traceId="native",this.sampled=!0,this.events=[],this.name=a,this.parent=b,this.context=c,this.startTime=e,this.kind=f,this.status={_tag:"Started",startTime:e},this.attributes=new Map,this.traceId="Some"===b._tag?b.value.traceId:os(32),this.spanId=os(16),this.links=Array.from(d)}end(a,b){this.status={_tag:"Ended",endTime:a,exit:b,startTime:this.status.startTime}}attribute(a,b){this.attributes.set(a,b)}event(a,b,c){this.events.push([a,b,c??{}])}addLinks(a){this.links.push(...a)}}let ou={[op]:op,...{span:(a,b,c,d,e,f)=>new ot(a,b,c,d,e,f),context:a=>a()}},ov=a=>{if(a?.captureStackTrace===!1||a?.captureStackTrace!==void 0&&"boolean"!=typeof a.captureStackTrace)return a;let b=Error.stackTraceLimit;Error.stackTraceLimit=3;let c=Error();Error.stackTraceLimit=b;let d=!1;return{...a,captureStackTrace:()=>{if(!1!==d)return d;if(void 0!==c.stack){let a=c.stack.split("\n");if(void 0!==a[3])return d=a[3].trim()}}}},ow=b_()("effect/Tracer/DisablePropagation",{defaultValue:$}),ox=aa(bQ,bS(nv,new nA),bS(oi,oj),bS(ol,new om(aK(Math.random()))),bS(nX,n_()),bS(oq,ou)),oy=ad(Symbol.for("effect/DefaultServices/currentServices"),()=>me(ox)),oz=a=>kQ(b=>a(b.currentDefaultServices)),oA=a=>oz(b=>a(b.unsafeMap.get(nv.key))),oB=oA(a=>a.currentTimeMillis),oC=(oz(a=>a.unsafeMap.get(ol.key).next),Symbol.for("effect/Secret"));({...dW,[oC]:oC});let oD=Symbol.for("effect/Config"),oE={...bt,[oD]:{_A:a=>a},commit(){var a;let b;return a=this,b=b=>b.load(a),oz(a=>b(a.unsafeMap.get(nX.key)))}},oF=W(2,(a,b)=>oH(a,a=>dt(b(a)))),oG=W(2,(a,b)=>oH(a,a=>{try{return dt(b(a))}catch(a){return ds(gB([],a instanceof Error?a.message:`${a}`))}})),oH=W(2,(a,b)=>{let c=Object.create(oE);return c._tag=nL,c.original=a,c.mapOrFail=b,c}),oI=W(2,(a,b)=>{let c=Object.create(oE);return c._tag=nM,c.name=b,c.config=a,c}),oJ=W(2,(a,b)=>{let c=Object.create(oE);return c._tag=nJ,c.first=a,c.second=oO(b),c.condition=Z,c}),oK=W(2,(a,b)=>{let c=Object.create(oE);return c._tag=nJ,c.first=a,c.second=oO(b.orElse),c.condition=b.if,c}),oL=(a,b)=>{let c=Object.create(oE);return c._tag=nN,c.description=a,c.parse=b,c},oM=a=>{let b=oL("a text property",dt);return void 0===a?b:oI(b,a)},oN=a=>{let b=Object.create(oE);return b._tag=nI,b.value=a,b.parse=()=>dt(a),b},oO=a=>{let b=Object.create(oE);return b._tag=nK,b.config=a,b},oP=W(2,(a,b)=>oK(a,{orElse:()=>oN(b),if:gG})),oQ=((a,b,c)=>{let d=Object.create(oE);return d._tag=nO,d.left=a,d.right=b,d.zip=c,d},(...a)=>b=>{let c=a.map(String).join(", "),d=oL(`one of (${c})`,b=>{let d=a.find(a=>String(a)===b);return void 0===d?ds(gB([],`Expected one of (${c}) but received ${b}`)):dt(d)});return void 0===b?d:oI(d,b)}),oR=function(){let a=Symbol.for("effect/Data/Error/plainArgs");return({BaseEffectError:class extends mE{constructor(b){super(b?.message,b?.cause?{cause:b.cause}:void 0),b&&(Object.assign(this,b),Object.defineProperty(this,a,{value:b,enumerable:!1}))}toJSON(){return{...this[a],...this}}}}).BaseEffectError}(),oS=a=>{let b={BaseEffectError:class extends oR{constructor(...b){super(...b),this._tag=a}}};return b.BaseEffectError.prototype.name=a,b.BaseEffectError},oT=a=>kr(a,{onEmpty:bG(j0),onFail:et(j1),onDie:a=>bG(j2(a)),onInterrupt:a=>bG(j3(a)),onSequential:eA(j5),onParallel:eA(j4)}),oU=a=>mD(X)(a),oV=a=>{let b=gP(a);return oA(a=>a.sleep(b))};function oW(){return new oY(new Map)}let oX=Symbol.for("effect/FiberRefs");class oY{constructor(a){this[oX]=oX,this.locals=a}pipe(){return a7(this,arguments)}}let oZ=W(3,(a,b,c)=>{let d=new Map(a.locals);return c.locals.forEach((a,c)=>{let e=a[0][1];if(!a[0][0][aU](b)){if(!d.has(c)){if(aV(e,c.initial))return;d.set(c,[[b,c.join(c.initial,e)]]);return}let f=d.get(c),[g,h]=((a,b,c,d=!1)=>{let e,f=b,g=c,h=d;for(;void 0===e;)if(eW(f)&&eW(g)){let a=e_(f)[0],b=e1(f),c=e_(g)[0],d=e_(g)[1],i=e1(g);a.startTimeMillis<c.startTimeMillis?(g=i,h=!0):a.startTimeMillis>c.startTimeMillis?f=b:a.id<c.id?(g=i,h=!0):a.id>c.id?f=b:e=[d,h]}else e=[a.initial,!0];return e})(c,f,a);if(h){let a=c.diff(g,e),h=f[0][1],i=c.join(h,c.patch(a)(h));if(!aV(h,i)){let a,e=f[0][0];a=e[aU](b)?[[e,i],...f.slice(1)]:[[b,i],...f],d.set(c,a)}}}}),new oY(d)}),o$=W(2,(a,b)=>{let c=new Map;return o_(a,c,b),new oY(c)}),o_=(a,b,c)=>{a.locals.forEach((a,d)=>{let e=a[0][1],f=d.patch(d.fork)(e);aV(e,f)?b.set(d,a):b.set(d,[[c,f],...a])})},o0=W(2,(a,b)=>{let c=new Map(a.locals);return c.delete(b),new oY(c)}),o1=W(2,(a,b)=>a.locals.has(b)?bG(e_(a.locals.get(b))[1]):ej()),o2=W(2,(a,b)=>aa(o1(a,b),el(()=>b.initial))),o3=W(2,(a,{fiberId:b,fiberRef:c,value:d})=>{if(0===a.locals.size)return new oY(new Map([[c,[[b,d]]]]));let e=new Map(a.locals);return o4(e,b,c,d),new oY(e)}),o4=(a,b,c,d)=>{let e,f=a.get(c)??[];if(eW(f)){let[a,c]=e_(f);if(a[aU](b))if(aV(c,d))return;else e=[[b,d],...f.slice(1)];else e=[[b,d],...f]}else e=[[b,d]];a.set(c,e)},o5=W(2,(a,{entries:b,forkAs:c})=>{if(0===a.locals.size)return new oY(new Map(b));let d=new Map(a.locals);return void 0!==c&&o_(a,d,c),b.forEach(([a,b])=>{1===b.length?o4(d,b[0][0],a,b[0][1]):b.forEach(([b,c])=>{o4(d,b,a,c)})}),new oY(d)}),o6=(z=aa(eD,eE(a=>a.ordinal)),W(2,(a,b)=>1===z(a,b))),o7=a=>{switch(a){case"All":return lT;case"Debug":return lY;case"Error":return lV;case"Fatal":return lU;case"Info":return lX;case"Trace":return lZ;case"None":return l$;case"Warning":return lW}},o8=a=>a.replace(/[\s="]/g,"_"),o9=a=>b=>{let c=o8(b.label);return`${c}=${a-b.startTime}ms`},pa=Symbol.for("effect/Readable"),pb=Symbol.for("effect/Ref"),pc={_A:a=>a};class pd extends b2{static{e=pa}commit(){return this.get}constructor(a){super(),this[pb]=pc,this[e]=pa,this.ref=a,this.get=lA(()=>this.ref.current)}modify(a){return lA(()=>{let b=this.ref.current,[c,d]=a(b);return b!==d&&ic(d)(this.ref),c})}}let pe=a=>new pd(ia(a)),pf=a=>lA(()=>pe(a)),pg=W(2,(a,b)=>a.modify(()=>[void 0,b])),ph=W(2,(a,b)=>a.modify(a=>[a,b])),pi=W(2,(a,b)=>a.modify(b)),pj=W(2,(a,b)=>a.modify(a=>[void 0,b(a)])),pk=a=>({_tag:"ExternalSpan",spanId:a.spanId,traceId:a.traceId,sampled:a.sampled??!0,context:a.context??bQ}),pl="Empty",pm="Remove",pn="Update",po="AndThen",pp={_tag:pl},pq=(a,b)=>{let c=new Map(a.locals),d=pp;for(let[a,e]of b.locals.entries()){let b=e_(e)[1],f=c.get(a);if(void 0!==f){let c=e_(f)[1];aV(c,b)||(d=pr({_tag:pn,fiberRef:a,patch:a.diff(c,b)})(d))}else d=pr({_tag:"Add",fiberRef:a,value:b})(d);c.delete(a)}for(let[a]of c.entries())d=pr({_tag:pm,fiberRef:a})(d);return d},pr=W(2,(a,b)=>({_tag:po,first:a,second:b})),ps=W(3,(a,b,c)=>{let d=c,e=fe(a);for(;eW(e);){let a=e_(e),c=e1(e);switch(a._tag){case pl:e=c;break;case"Add":d=o3(d,{fiberId:b,fiberRef:a.fiberRef,value:a.value}),e=c;break;case pm:d=o0(d,a.fiberRef),e=c;break;case pn:{let f=o2(d,a.fiberRef);d=o3(d,{fiberId:b,fiberRef:a.fiberRef,value:a.fiberRef.patch(a.patch)(f)}),e=c;break}case po:e=eS(a.first)(eS(a.second)(c))}}return d}),pt="effect/MetricLabel",pu=Symbol.for(pt);class pv{constructor(a,b){this[pu]=pu,this.key=a,this.value=b,this._hash=aQ(pt+this.key+this.value)}[aJ](){return this._hash}[aU](a){return pw(a)&&this.key===a.key&&this.value===a.value}pipe(){return a7(this,arguments)}}let pw=a=>ap(a,pu),px=W(a=>kP(a[0]),function(){let a=arguments;return mc(a[0],mj,"string"==typeof a[1]?hD(a[1],a[2]):b=>Object.entries(a[1]).reduce((a,[b,c])=>hD(a,b,c),b))}),py=a=>lp(a,bG),pz=a=>{let b,c;return"function"==typeof a?b=a:(b=a.try,c=a.catch),lz(()=>{try{return ly(aG(b))}catch(a){return k5(c?aG(()=>c(a)):new mT(a,"An unknown error occurred in Effect.try"))}})},pA=W(2,(a,b)=>lg(a,{onFailure:a=>{let c=b(a);switch(c._tag){case"None":return k7(a);case"Some":return c.value}},onSuccess:ly})),pB=W(a=>kP(a[0]),(a,...b)=>{let c=b[b.length-1];return k$(a,2===b.length?aq(b[0]):a=>{let c=ap(a,"_tag")?a._tag:void 0;if(!c)return!1;for(let a=0;a<b.length-1;a++)if(b[a]===c)return!0;return!1},c)}),pC=W(2,(a,b)=>{let c;return k$(a,a=>(c??=Object.keys(b),ap(a,"_tag")&&ae(a._tag)&&c.includes(a._tag)),a=>b[a._tag](a))}),pD=W(3,(a,b,c)=>lb(a,a=>lp(c(a),c=>({...a,[b]:c})))),pE=W(2,(a,b)=>lp(a,a=>({[b]:a}))),pF=((a,b)=>lz(()=>{let c,d=a[Symbol.iterator](),e=[],f=ly(!1),g=0;for(;(c=d.next())&&!c.done;){let a=c.value,d=g++;f=lb(f,c=>c?(e.push(a),ly(!0)):b(a,d))}return lp(f,()=>e)}),W(3,(a,b,c)=>lb(a,a=>b(a)?ly(a):c(a)))),pG=((a=>kP(a[0]),(a,b,c)=>pF(a,b,a=>void 0===c?k5(new mO):k6(()=>c(a)))),(a,b,c,d)=>lb(c(d,b),e=>{if(e)return ly(bG(d));let f=a.next();return f.done?ly(ej()):pG(a,b+1,c,f.value)})),pH=W(2,(a,b)=>lh(a,{onFailure:a=>ly(b.onFailure(a)),onSuccess:a=>ly(b.onSuccess(a))})),pI=a=>{let b=lb(lb(a,()=>lL()),()=>b);return b},pJ=kQ(a=>ly(a.getFiberRefs())),pK=a=>(...b)=>{let c,d=eo(a);for(let a=0,d=b.length;a<d;a++){let d=b[a];j6(d)&&(c=void 0!==c?j5(c,d):d,b=[...b.slice(0,a),...b.slice(a+1)],a--)}return void 0===c&&(c=j0),kQ(a=>(a.log(b,c,d),lF))},pL=pK(),pM=pK(lY),pN=pK(lX),pO=pK(lW),pP=pK(lV),pQ=W(2,(a,b)=>lb(oB,c=>mc(a,ml,iP({label:b,startTime:c})))),pR=W(2,(a,b)=>lg(a,{onFailure:a=>k8(()=>b(a)),onSuccess:ly})),pS=a=>lp(pf(!0),b=>kT(lH(a,ph(b,!1)))),pT=a=>p2((b,c)=>aa(a,ps(b,c))),pU=W(3,(a,b,c)=>no(d=>np(a,bS(d,b,c)))),pV=W(3,(a,b,c)=>no(d=>lb(c,c=>np(a,aa(d,bS(b,c)))))),pW=W(3,(a,b,c)=>eO(a).reduce((a,b,d)=>lb(a,a=>c(a,b,d)),ly(b))),pX=ly(ej()),pY=W(3,(a,b,c)=>lb(b,d=>lb(a,a=>lp(b,b=>[c(d,b),a]))));(a,b)=>lz(()=>{let c,d=a[Symbol.iterator](),e=[],f=ly(!0),g=0;for(;(c=d.next())&&!c.done;){let a=c.value,d=g++;f=lb(f,c=>aa(c?b(a,d):ly(!1),lp(b=>(b&&e.push(a),b))))}return lp(f,()=>e)});let pZ=W(2,(a,{onFailure:b,onSuccess:c})=>lg(a,{onFailure:a=>{let c=kd(a);switch(c._tag){case"Left":return lO(b(c.left),k7(a));case"Right":return k7(a)}},onSuccess:a=>kS(c(a),a)})),p$=W(2,(a,b)=>lg(a,{onFailure:a=>{let c=kd(a);switch(c._tag){case"Left":return lO(b(c.left),k7(a));case"Right":return k7(a)}},onSuccess:ly})),p_=W(2,(a,b)=>lg(a,{onFailure:a=>lO(b(a),k7(a)),onSuccess:ly})),p0=a=>{let b,c;"function"==typeof a?b=a:(b=a.try,c=a.catch);let d=a=>c?k6(()=>c(a)):k5(new mT(a,"An unknown error occurred in Effect.tryPromise"));return b.length>=1?kX((a,c)=>{try{b(c).then(b=>a(m6(b)),b=>a(d(b)))}catch(b){a(d(b))}}):kX(a=>{try{b().then(b=>a(m6(b)),b=>a(d(b)))}catch(b){a(d(b))}})},p1=W(2,(a,b)=>lb(a,a=>pz({try:()=>b.try(a),catch:b.catch}))),p2=a=>kQ(b=>(b.setFiberRefs(a(b.id(),b.getFiberRefs())),lF)),p3=W(2,(a,b)=>lz(()=>b()?lp(a,bG):ly(ej()))),p4=BigInt(0),p5=eu(a=>bV(a.context,ow)?"Span"===a._tag?p5(a.parent):ej():bG(a)),p6=(a,...b)=>{let c=ov(1===b.length?void 0:b[0]),d=b[b.length-1];return kQ(b=>{let e=((a,b,c)=>{let d,e=!a.getFiberRef(mt)||c.context&&bV(c.context,ow),f=a.getFiberRef(mg),g=c.parent?bG(c.parent):c.root?ej():p5(bW(f,or));if(e){let a;a={name:b,parent:g,context:bS(c.context??bQ,ow,!0)},d=Object.assign(Object.create(nt),a)}else{let e=a.getFiberRef(oy),f=bV(e,oq),h=bV(e,nv),i=a.getFiberRef(mu),j=a.getFiberRefs(),k=o1(j,mv),l=o1(j,mw),m="Some"===l._tag?void 0!==c.links?[...f$(l.value),...c.links??[]]:f$(l.value):c.links??fd();d=f.span(b,g,c.context??bQ,m,i?h.unsafeCurrentTimeNanos():p4,c.kind??"internal"),"Some"===k._tag&&hM(k.value,(a,b)=>d.attribute(b,a)),void 0!==c.attributes&&Object.entries(c.attributes).forEach(([a,b])=>d.attribute(a,b))}return"function"==typeof c.captureStackTrace&&kz.set(d,c.captureStackTrace),d})(b,a,c),f=b.getFiberRef(mu),g=bV(b.getFiberRef(oy),nv);return ls(d(e),a=>((a,b,c,d)=>lA(()=>{"Ended"!==a.status._tag&&("Failure"===b._tag&&kz.has(a)&&a.attribute("code.stacktrace",kz.get(a)()),a.end(d?c.unsafeCurrentTimeNanos():p4,b))}))(e,a,g,f))})},p7=W(2,(a,b)=>pU(a,or,b)),p8=Symbol.for("effect/DateTime"),p9=Symbol.for("effect/DateTime/TimeZone"),qa={[p8]:p8,pipe(){return a7(this,arguments)},[aY](){return this.toString()},toJSON(){return qy(this).toJSON()}},qb={...qa,_tag:"Utc",[aJ](){return aT(this,aP(this.epochMillis))},[aU](a){return qh(a)&&"Utc"===a._tag&&this.epochMillis===a.epochMillis},toString(){return`DateTime.Utc(${qy(this).toJSON()})`}},qc={...qa,_tag:"Zoned",[aJ](){return aa(aP(this.epochMillis),aM(aK(this.zone)),aT(this))},[aU](a){return qh(a)&&"Zoned"===a._tag&&this.epochMillis===a.epochMillis&&aV(this.zone,a.zone)},toString(){return`DateTime.Zoned(${qN(this)})`}},qd={[p9]:p9,[aY](){return this.toString()}},qe={...qd,_tag:"Named",[aJ](){return aT(this,aQ(`Named:${this.id}`))},[aU](a){return qi(a)&&"Named"===a._tag&&this.id===a.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},qf={...qd,_tag:"Offset",[aJ](){return aT(this,aQ(`Offset:${this.offset}`))},[aU](a){return qi(a)&&"Offset"===a._tag&&this.offset===a.offset},toString(){return`TimeZone.Offset(${qB(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},qg=(a,b,c)=>{let d=Object.create(qc);return d.epochMillis=a,d.zone=b,Object.defineProperty(d,"partsUtc",{value:c,enumerable:!1,writable:!0}),Object.defineProperty(d,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(d,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),d},qh=a=>ap(a,p8),qi=a=>ap(a,p9),qj=a=>"Zoned"===a._tag,qk=dO((a,b)=>a.epochMillis===b.epochMillis),ql=a=>{let b=Object.create(qb);return b.epochMillis=a,Object.defineProperty(b,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),b},qm=a=>{let b=a.getTime();if(Number.isNaN(b))throw new mM("Invalid date");return ql(b)},qn=a=>{if(qh(a))return a;if(a instanceof Date)return qm(a);if("object"==typeof a){let b=new Date(0);return qD(b,a),qm(b)}return"string"!=typeof a||qo(a)?qm(new Date(a)):qm(new Date(a+"Z"))},qo=a=>/Z|[+-]\d{2}$|[+-]\d{2}:\d{2}$|\]$/.test(a),qp=(a,b)=>{let c;if(b?.timeZone===void 0&&qh(a)&&qj(a))return a;let d=qn(a);if(d.epochMillis<-86399999568e5||d.epochMillis>86399999496e5)throw new mM(`Epoch millis out of range: ${d.epochMillis}`);if(b?.timeZone===void 0)c=qu(-60*new Date(d.epochMillis).getTimezoneOffset()*1e3);else if(qi(b?.timeZone))c=b.timeZone;else if("number"==typeof b?.timeZone)c=qu(b.timeZone);else{let a=qx(b.timeZone);if(bD(a))throw new mM(`Invalid time zone: ${b.timeZone}`);c=a.value}return b?.adjustForTimeZone!==!0?qg(d.epochMillis,c,d.partsUtc):qE(d.epochMillis,c)},qq=eq(qp),qr=((a=>qh(a[0]),(a,b,c)=>c?.adjustForTimeZone===!0?qE(a.epochMillis,b):qg(a.epochMillis,b,a.partsUtc)),ad("effect/DateTime/validZoneCache",()=>new Map)),qs={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},qt=a=>{if(qr.has(a))return qr.get(a);try{return(a=>{let b=a.resolvedOptions().timeZone;if(qr.has(b))return qr.get(b);let c=Object.create(qe);return c.id=b,c.format=a,qr.set(b,c),c})(new Intl.DateTimeFormat("en-US",{...qs,timeZone:a}))}catch{throw new mM(`Invalid time zone: ${a}`)}},qu=a=>{let b=Object.create(qf);return b.offset=a,b},qv=eq(qt),qw=/^(?:GMT|[+-])/,qx=a=>{if(qw.test(a)){let b=qG(a);return null===b?ej():bG(qu(b))}return qv(a)},qy=((a,b)=>qC(b)-qC(a),a=>new Date(a.epochMillis)),qz=a=>{if("Utc"===a._tag)return new Date(a.epochMillis);if("Offset"===a.zone._tag)return new Date(a.epochMillis+a.zone.offset);if(void 0!==a.adjustedEpochMillis)return new Date(a.adjustedEpochMillis);let b=a.zone.format.formatToParts(a.epochMillis).filter(a=>"literal"!==a.type),c=new Date(0);return c.setUTCFullYear(Number(b[2].value),Number(b[0].value)-1,Number(b[1].value)),c.setUTCHours(Number(b[3].value),Number(b[4].value),Number(b[5].value),Number(b[6].value)),a.adjustedEpochMillis=c.getTime(),c},qA=a=>qz(a).getTime()-qC(a),qB=a=>{let b=Math.abs(a),c=Math.floor(b/36e5),d=Math.round(b%36e5/6e4);return 60===d&&(c+=1,d=0),`${a<0?"-":"+"}${String(c).padStart(2,"0")}:${String(d).padStart(2,"0")}`},qC=a=>a.epochMillis,qD=(a,b)=>{if(void 0!==b.year&&a.setUTCFullYear(b.year),void 0!==b.month&&a.setUTCMonth(b.month-1),void 0!==b.day&&a.setUTCDate(b.day),void 0!==b.weekDay){let c=b.weekDay-a.getUTCDay();a.setUTCDate(a.getUTCDate()+c)}void 0!==b.hours&&a.setUTCHours(b.hours),void 0!==b.minutes&&a.setUTCMinutes(b.minutes),void 0!==b.seconds&&a.setUTCSeconds(b.seconds),void 0!==b.millis&&a.setUTCMilliseconds(b.millis)},qE=(a,b)=>{let c="Offset"===b._tag?b.offset:qH(a,b);return qg(a-c,b)},qF=/([+-])(\d{2}):(\d{2})$/,qG=a=>{let b=qF.exec(a);if(null===b)return null;let[,c,d,e]=b;return("+"===c?1:-1)*(60*Number(d)+Number(e))*6e4},qH=(a,b)=>{let c=b.format.formatToParts(a).find(a=>"timeZoneName"===a.type)?.value??"";if("GMT"===c)return 0;let d=qG(c);return null===d?qA(qg(a,b)):d},qI=W(2,(a,b)=>{if("Utc"===a._tag){let c=qy(a);return b(c),ql(c.getTime())}let c=new Date(qz(a).getTime());return b(c),qE(c.getTime(),a.zone)}),qJ=((a,b)=>qJ(a,a=>{let c=new Date(a);return b(c),c.getTime()}),W(2,(a,b)=>{let c=b(qC(a));return"Utc"===a._tag?ql(c):qg(c,a.zone)})),qK=((a,b)=>b(qz(a)),W(2,(a,b)=>b(qy(a)))),qL=(a,b)=>{a.setTime(a.getTime()+b)},qM=((a,b)=>qI(a,a=>{if(b.millis&&qL(a,b.millis),b.seconds&&qL(a,1e3*b.seconds),b.minutes&&qL(a,60*b.minutes*1e3),b.hours&&qL(a,60*b.hours*6e4),b.days&&a.setUTCDate(a.getUTCDate()+b.days),b.weeks&&a.setUTCDate(a.getUTCDate()+7*b.weeks),b.months){let c=a.getUTCDate();a.setUTCMonth(a.getUTCMonth()+b.months+1,0),c<a.getUTCDate()&&a.setUTCDate(c)}if(b.years){let c=a.getUTCDate(),d=a.getUTCMonth();a.setUTCFullYear(a.getUTCFullYear()+b.years,d+1,0),c<a.getUTCDate()&&a.setUTCDate(c)}}),a=>{let b=qz(a);return"Utc"===a._tag?b.toISOString():`${b.toISOString().slice(0,-1)}${qB(qA(a))}`}),qN=a=>"Offset"===a.zone._tag?qM(a):`${qM(a)}[${a.zone.id}]`,qO=qh,qP=a=>qi(a)&&"Offset"===a._tag,qQ=a=>qi(a)&&"Named"===a._tag,qR=a=>"Utc"===a._tag,qS=qj,qT=qk,qU=qm,qV=qp,qW=a=>lA(()=>a.state.current._tag===kE),qX="Sequential",qY="Parallel",qZ={_tag:qX},q$={_tag:qY},q_=a=>({_tag:"ParallelN",parallelism:a}),q0="effect/FiberStatus",q1=Symbol.for(q0),q2="Done",q3="Running",q4="Suspended",q5=aQ(`${q0}-${q2}`);class q6{[aJ](){return q5}[aU](a){return ra(a)&&a._tag===q2}constructor(){this[q1]=q1,this._tag=q2}}class q7{constructor(a){this[q1]=q1,this._tag=q3,this.runtimeFlags=a}[aJ](){return aa(aK(q0),aM(aK(this._tag)),aM(aK(this.runtimeFlags)),aT(this))}[aU](a){return ra(a)&&a._tag===q3&&this.runtimeFlags===a.runtimeFlags}}class q8{constructor(a,b){this[q1]=q1,this._tag=q4,this.runtimeFlags=a,this.blockingOn=b}[aJ](){return aa(aK(q0),aM(aK(this._tag)),aM(aK(this.runtimeFlags)),aM(aK(this.blockingOn)),aT(this))}[aU](a){return ra(a)&&a._tag===q4&&this.runtimeFlags===a.runtimeFlags&&aV(this.blockingOn,a.blockingOn)}}let q9=new q6,ra=a=>ap(a,q1),rb=a=>new q7(a);class rc{scheduleTask(a,b){let c,d=this.buckets.length,e=0;for(;e<d;e++)if(this.buckets[e][0]<=b)c=this.buckets[e];else break;c&&c[0]===b?c[1].push(a):e===d?this.buckets.push([b,[a]]):this.buckets.splice(e,0,[b,[a]])}constructor(){this.buckets=[]}}class rd{constructor(a){this.running=!1,this.tasks=new rc,this.maxNextTickBeforeTimer=a}starveInternal(a){let b=this.tasks.buckets;for(let[a,c]of(this.tasks.buckets=[],b))for(let a=0;a<c.length;a++)c[a]();0===this.tasks.buckets.length?this.running=!1:this.starve(a)}starve(a=0){a>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(a+1))}shouldYield(a){return a.currentOpCount>a.getFiberRef(mi)&&a.getFiberRef(mh)}scheduleTask(a,b){this.tasks.scheduleTask(a,b),this.running||(this.running=!0,this.starve())}}let re=ad(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new rd(2048));class rf{scheduleTask(a,b){this.deferred?re.scheduleTask(a,b):this.tasks.scheduleTask(a,b)}shouldYield(a){return a.currentOpCount>a.getFiberRef(mi)&&a.getFiberRef(mh)}flush(){for(;this.tasks.buckets.length>0;){let a=this.tasks.buckets;for(let[b,c]of(this.tasks.buckets=[],a))for(let a=0;a<c.length;a++)c[a]()}this.deferred=!0}constructor(){this.tasks=new rc,this.deferred=!1}}let rg=ad(Symbol.for("effect/FiberRef/currentScheduler"),()=>md(re)),rh=(a,b)=>({_tag:"Par",left:a,right:b}),ri=(a,b)=>({_tag:"Seq",left:a,right:b}),rj=a=>{let b=a,c=rp(),d=iM(),e=iM();for(;;)switch(b._tag){case"Empty":if(iJ(d))return[c,e];b=d.head,d=d.tail;break;case"Par":d=iL(b.right,d),b=b.left;break;case"Seq":{let a=b.left,c=b.right;switch(a._tag){case"Empty":b=c;break;case"Par":{let d=a.left,e=a.right;b=rh(ri(d,c),ri(e,c));break}case"Seq":b=ri(a.left,ri(a.right,c));break;case"Single":b=a,e=iL(c,e)}break}case"Single":if(c=rq(c,b),iJ(d))return[c,e];b=d.head,d=d.tail}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},rk=(a,b)=>{if(iJ(a))return iN(ru(b));if(rs(b))return a;let c=rA(a.head),d=rt(b);return 1===c.length&&1===d.length&&aV(c[0],d[0])?iL(rz(a.head,ru(b)),a.tail):iL(ru(b),a)},rl=Symbol.for("effect/RequestBlock/Entry"),rm=Symbol.for("effect/RequestBlock/RequestBlockParallel"),rn={_R:a=>a};class ro{constructor(a){this[rm]=rn,this.map=a}}let rp=()=>new ro(hy),rq=(a,b)=>new ro(hI(a.map,b.dataSource,a=>en(et(a,f4(b.blockedRequest)),()=>fX(b.blockedRequest)))),rr=(a,b)=>new ro(hN(a.map,b.map,(a,b,c)=>hD(a,c,ek(hA(a,c),{onNone:()=>b,onSome:a=>f9(b,a)})))),rs=a=>(a=>a&&hj(a._root))(a.map),rt=a=>Array.from(hF(a.map)),ru=a=>ry(hL(a.map,a=>fX(a))),rv=Symbol.for("effect/RequestBlock/RequestBlockSequential"),rw={_R:a=>a};class rx{constructor(a){this[rv]=rw,this.map=a}}let ry=a=>new rx(a),rz=(a,b)=>new rx(hN(b.map,a.map,(a,b,c)=>hD(a,c,ek(hA(a,c),{onNone:()=>fV(),onSome:a=>f9(a,b)})))),rA=a=>Array.from(hF(a.map)),rB=ad(Symbol.for("effect/FiberRef/currentRequestMap"),()=>md(new Map)),rC=(a,b,c,d)=>{switch(a){case void 0:return b();case"unbounded":return c();case"inherit":return l3(mn,a=>"unbounded"===a?c():a>1?d(a):b());default:return a>1?d(a):b()}},rD=(a,b,c)=>{switch(a){case void 0:return b();case"unbounded":return c();case"inherit":return l3(mn,a=>"unbounded"===a||a>1?c():b());default:return a>1?c():b()}},rE="InterruptSignal",rF="Stateful",rG="Resume",rH="YieldNow",rI=a=>({_tag:rE,cause:a}),rJ=a=>({_tag:rF,onFiber:a}),rK=a=>({_tag:rG,effect:a}),rL=()=>({_tag:rH}),rM=Symbol.for("effect/FiberScope");class rN{add(a,b){this.roots.add(b),b.addObserver(()=>{this.roots.delete(b)})}constructor(){this[rM]=rM,this.fiberId=ix,this.roots=new Set}}class rO{constructor(a,b){this[rM]=rM,this.fiberId=a,this.parent=b}add(a,b){this.parent.tell(rJ(a=>{a.addChild(b),b.addObserver(()=>{a.removeChild(b)})}))}}let rP=ad(Symbol.for("effect/FiberScope/Global"),()=>new rN),rQ=Symbol.for("effect/Fiber"),rR={_E:a=>a,_A:a=>a},rS={[rQ]:rR,pipe(){return a7(this,arguments)}},rT=Symbol.for("effect/Fiber"),rU=((a,b)=>a.interruptAsFork(b),a=>lN(le(a.await),a.inheritAll)),rV=((a,b)=>rV(a,a=>lA(()=>b(a))),W(2,(a,b)=>({...bt,commit(){return rU(this)},...rS,id:()=>a.id(),await:lb(a.await,m1(b)),children:a.children,inheritAll:a.inheritAll,poll:lb(a.poll,a=>{switch(a._tag){case"None":return ly(ej());case"Some":return aa(m1(a.value,b),lp(bG))}}),interruptAsFork:b=>a.interruptAsFork(b)})));({...bt,commit(){return rU(this)},...rS,id:()=>ix,await:lQ,children:ly([]),inheritAll:lQ,poll:ly(ej()),interruptAsFork:()=>lQ}),(a,b)=>({...bt,commit(){return rU(this)},...rS,id:()=>is(a.id(),b.id()),await:lP(a.await,b.await,(a,b)=>mV(a)?a:b),children:a.children,inheritAll:lO(b.inheritAll,a.inheritAll),poll:lP(a.poll,b.poll,(a,b)=>{switch(a._tag){case"None":return ej();case"Some":return mV(a.value)?a:b}}),interruptAsFork:c=>aa(lS(a,c),lO(aa(b,lS(c))),kT)});let rW="effect/FiberCurrent",rX=Symbol.for("effect/Logger"),rY={_Message:a=>a,_Output:a=>a},rZ=a=>({[rX]:rY,log:a,pipe(){return a7(this,arguments)}}),r$=W(2,(a,b)=>rZ(c=>a.log({...c,message:b(c.message)}))),r_=W(2,(a,b)=>rZ(c=>a.log(b(c)))),r0=W(2,(a,b)=>rZ(c=>b(c.logLevel)?bG(a.log(c)):ej())),r1=W(2,(a,b)=>rZ(c=>b(a.log(c)))),r2=a=>({[rX]:rY,log:({message:b})=>a(b),pipe(){return a7(this,arguments)}}),r3=W(2,(a,b)=>rZ(c=>[a.log(c),b.log(c)])),r4=W(2,(a,b)=>r1(r3(a,b),a=>a[0])),r5=W(2,(a,b)=>r1(r3(a,b),a=>a[1])),r6=/^[^\s"=]*$/,r7=(a,b)=>({annotations:c,cause:d,date:e,fiberId:f,logLevel:g,message:h,spans:i})=>{let j=b=>b.match(r6)?b:a(b),k=(a,b)=>`${o8(a)}=${j(b)}`,l=(a,b)=>" "+k(a,b),m=k("timestamp",e.toISOString());m+=l("level",g.label),m+=l("fiber",iv(f));let n=eP(h);for(let a=0;a<n.length;a++)m+=l("message",a1(n[a],b));for(let a of(d._tag===jU||(m+=l("cause",ku(d,{renderErrorCause:!0}))),i))m+=" "+o9(e.getTime())(a);for(let[a,d]of c)m+=l(a,a1(d,b));return m},r8=rZ(r7(a=>`"${a.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),r9=rZ(r7(JSON.stringify,0)),sa=rZ(({annotations:a,cause:b,date:c,fiberId:d,logLevel:e,message:f,spans:g})=>{let h=c.getTime(),i={},j={};if(a._size>0)for(let[b,c]of a)i[b]=sb(c);if(iK(g))for(let a of g)j[a.label]=h-a.startTime;let k=eP(f);return{message:1===k.length?sb(k[0]):k.map(sb),logLevel:e.label,timestamp:c.toISOString(),cause:j7(b)?void 0:ku(b,{renderErrorCause:!0}),annotations:i,spans:j,fiberId:iv(d)}}),sb=a=>{switch(typeof a){case"bigint":case"function":case"symbol":return String(a);default:return aZ(a)}},sc=r1(sa,a2),sd=(a,...b)=>{let c="";for(let a=0;a<b.length;a++)c+=`\x1b[${b[a]}m`;return c+a+"\x1b[0m"},se=(a,...b)=>a,sf={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},sg={None:[],All:[],Trace:[sf.gray],Debug:[sf.blue],Info:[sf.green],Warning:[sf.yellow],Error:[sf.red],Fatal:[sf.bgBrightRed,sf.black]},sh={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},si=a=>`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}.${a.getMilliseconds().toString().padStart(3,"0")}`,sj="object"==typeof process&&null!==process&&"object"==typeof process.stdout&&null!==process.stdout,sk=sj&&!0===process.stdout.isTTY,sl=sj||"Deno"in globalThis,sm=a=>{let b=a?.mode??"auto",c="browser"===("auto"===b?sl?"tty":"browser":b),d="boolean"==typeof a?.colors?a.colors:sk||c,e=a?.formatDate??si;return c?so({colors:d,formatDate:e}):sn({colors:d,formatDate:e,stderr:a?.stderr===!0})},sn=a=>{let b="object"==typeof process&&"isBun"in process&&!0===process.isBun,c=a.colors?sd:se;return rZ(({annotations:d,cause:e,context:f,date:g,fiberId:h,logLevel:i,message:j,spans:k})=>{let l=bV(o2(f,oy),oi).unsafe,m=!0===a.stderr?l.error:l.log,n=eP(j),o=c(`[${a.formatDate(g)}]`,sf.white)+` ${c(i.label,...sg[i._tag])}`+` (${iv(h)})`;if(iK(k)){let a=o9(g.getTime());for(let b of k)o+=" "+a(b)}o+=":";let p=0;if(n.length>0){let a=sb(n[0]);"string"==typeof a&&(o+=" "+c(a,sf.bold,sf.cyan),p++)}if(m(o),b||l.group(),j7(e)||m(ku(e,{renderErrorCause:!0})),p<n.length)for(;p<n.length;p++)m(a6(n[p]));if(d._size>0)for(let[a,b]of d)m(c(`${a}:`,sf.bold,sf.white),a6(b));b||l.groupEnd()})},so=a=>{let b=a.colors?"%c":"";return rZ(({annotations:c,cause:d,context:e,date:f,fiberId:g,logLevel:h,message:i,spans:j})=>{let k=bV(o2(e,oy),oi).unsafe,l=eP(i),m=`${b}[${a.formatDate(f)}]`,n=[];if(a.colors&&n.push("color:gray"),m+=` ${b}${h.label}${b} (${iv(g)})`,a.colors&&n.push(sh[h._tag],""),iK(j)){let a=o9(f.getTime());for(let b of j)m+=" "+a(b)}m+=":";let o=0;if(l.length>0){let c=sb(l[0]);"string"==typeof c&&(m+=` ${b}${c}`,a.colors&&n.push("color:deepskyblue"),o++)}if(k.groupCollapsed(m,...n),j7(d)||k.error(ku(d,{renderErrorCause:!0})),o<l.length)for(;o<l.length;o++)k.log(a6(l[o]));if(c._size>0)for(let[b,d]of c){let c=a6(d);a.colors?k.log(`%c${b}:`,"color:gray",c):k.log(`${b}:`,c)}k.groupEnd()})},sp=ad("effect/Logger/prettyLoggerDefault",()=>sm()),sq=Symbol.for("effect/MetricKeyType"),sr="effect/MetricKeyType/Counter",ss=Symbol.for(sr),st="effect/MetricKeyType/Frequency",su=Symbol.for(st),sv="effect/MetricKeyType/Gauge",sw=Symbol.for(sv),sx="effect/MetricKeyType/Histogram",sy=Symbol.for(sx),sz=Symbol.for("effect/MetricKeyType/Summary"),sA={_In:a=>a,_Out:a=>a};class sB{constructor(a,b){this[sq]=sA,this[ss]=ss,this.incremental=a,this.bigint=b,this._hash=aQ(sr)}[aJ](){return this._hash}[aU](a){return sD(a)}pipe(){return a7(this,arguments)}}class sC{constructor(a){this[sq]=sA,this[sy]=sy,this.boundaries=a,this._hash=aa(aQ(sx),aM(aK(this.boundaries)))}[aJ](){return this._hash}[aU](a){return sE(a)&&aV(this.boundaries,a.boundaries)}pipe(){return a7(this,arguments)}}let sD=a=>ap(a,ss),sE=a=>ap(a,sy),sF=Symbol.for("effect/MetricKey"),sG={_Type:a=>a},sH=fr(aV);class sI{constructor(a,b,c,d=[]){this[sF]=sG,this.name=a,this.keyType=b,this.description=c,this.tags=d,this._hash=aa(aQ(this.name+this.description),aM(aK(this.keyType)),aM(aS(this.tags)))}[aJ](){return this._hash}[aU](a){return sJ(a)&&this.name===a.name&&aV(this.keyType,a.keyType)&&aV(this.description,a.description)&&sH(this.tags,a.tags)}pipe(){return a7(this,arguments)}}let sJ=a=>ap(a,sF),sK=W(2,(a,b)=>0===b.length?a:new sI(a.name,a.keyType,a.description,fc(a.tags,b))),sL=Symbol.for("effect/MutableHashMap"),sM={[sL]:sL,[Symbol.iterator](){return new sN(this)},toString(){return a$(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(aZ)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}};class sN{constructor(a){this.self=a,this.referentialIterator=a.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let a=this.referentialIterator.next();return a.done?(this.bucketIterator=new sO(this.self.buckets.values()),this.next()):a}[Symbol.iterator](){return new sN(this.self)}}class sO{constructor(a){this.backing=a}next(){if(void 0===this.currentBucket){let a=this.backing.next();if(a.done)return a;this.currentBucket=a.value[Symbol.iterator]()}let a=this.currentBucket.next();return a.done?(this.currentBucket=void 0,this.next()):a}}let sP=()=>{let a=Object.create(sM);return a.referential=new Map,a.buckets=new Map,a.bucketsSize=0,a},sQ=W(2,(a,b)=>{if(!1===aX(b))return a.referential.has(b)?bG(a.referential.get(b)):ej();let c=b[aJ](),d=a.buckets.get(c);return void 0===d?ej():sR(a,d,b)}),sR=(a,b,c,d=!1)=>{for(let e=0,f=b.length;e<f;e++)if(c[aU](b[e][0])){let c=b[e][1];return d&&(b.splice(e,1),a.bucketsSize--),bG(c)}return ej()},sS=W(2,(a,b)=>bE(sQ(a,b))),sT=W(3,(a,b,c)=>{if(!1===aX(b))return a.referential.set(b,c),a;let d=b[aJ](),e=a.buckets.get(d);return void 0===e?a.buckets.set(d,[[b,c]]):(sU(a,e,b),e.push([b,c])),a.bucketsSize++,a}),sU=(a,b,c)=>{for(let d=0,e=b.length;d<e;d++)if(c[aU](b[d][0])){b.splice(d,1),a.bucketsSize--;return}},sV=W(2,(a,b)=>{if(!1===aX(b))return a.referential.delete(b),a;let c=b[aJ](),d=a.buckets.get(c);return void 0===d||(sU(a,d,b),0===d.length&&a.buckets.delete(c)),a}),sW=a=>a.referential.size+a.bucketsSize,sX=Symbol.for("effect/MetricState"),sY="effect/MetricState/Counter",sZ=Symbol.for(sY),s$="effect/MetricState/Frequency",s_=Symbol.for(s$),s0="effect/MetricState/Gauge",s1=Symbol.for(s0),s2="effect/MetricState/Histogram",s3=Symbol.for(s2),s4="effect/MetricState/Summary",s5=Symbol.for(s4),s6={_A:a=>a};class s7{constructor(a){this[sX]=s6,this[sZ]=sZ,this.count=a}[aJ](){return aa(aK(sY),aM(aK(this.count)),aT(this))}[aU](a){return td(a)&&this.count===a.count}pipe(){return a7(this,arguments)}}let s8=fr(aV);class s9{constructor(a){this[sX]=s6,this[s_]=s_,this.occurrences=a}[aJ](){return aa(aQ(s$),aM(aS(eO(this.occurrences.entries()))),aT(this))}[aU](a){return te(a)&&s8(eO(this.occurrences.entries()),eO(a.occurrences.entries()))}pipe(){return a7(this,arguments)}}class ta{constructor(a){this[sX]=s6,this[s1]=s1,this.value=a}[aJ](){return aa(aK(s0),aM(aK(this.value)),aT(this))}[aU](a){return tf(a)&&this.value===a.value}pipe(){return a7(this,arguments)}}class tb{constructor(a,b,c,d,e){this[sX]=s6,this[s3]=s3,this.buckets=a,this.count=b,this.min=c,this.max=d,this.sum=e}[aJ](){return aa(aK(s2),aM(aK(this.buckets)),aM(aK(this.count)),aM(aK(this.min)),aM(aK(this.max)),aM(aK(this.sum)),aT(this))}[aU](a){return tg(a)&&aV(this.buckets,a.buckets)&&this.count===a.count&&this.min===a.min&&this.max===a.max&&this.sum===a.sum}pipe(){return a7(this,arguments)}}class tc{constructor(a,b,c,d,e,f){this[sX]=s6,this[s5]=s5,this.error=a,this.quantiles=b,this.count=c,this.min=d,this.max=e,this.sum=f}[aJ](){return aa(aK(s4),aM(aK(this.error)),aM(aK(this.quantiles)),aM(aK(this.count)),aM(aK(this.min)),aM(aK(this.max)),aM(aK(this.sum)),aT(this))}[aU](a){return th(a)&&this.error===a.error&&aV(this.quantiles,a.quantiles)&&this.count===a.count&&this.min===a.min&&this.max===a.max&&this.sum===a.sum}pipe(){return a7(this,arguments)}}let td=a=>ap(a,sZ),te=a=>ap(a,s_),tf=a=>ap(a,s1),tg=a=>ap(a,s3),th=a=>ap(a,s5),ti=Symbol.for("effect/MetricHook"),tj={_In:a=>a,_Out:a=>a},tk=a=>({[ti]:tj,pipe(){return a7(this,arguments)},...a}),tl=BigInt(0),tm=(a,b,c,d,e,f)=>{let g=a,h=b,i=c,j=d,k=e,l=f,m=a,n=b,o=c,p=d,q=e,r=f;for(;;){if(!eW(l))return{quantile:k,value:ej(),consumed:j,rest:[]};if(1===k)return{quantile:k,value:bG(e0(l)),consumed:j+l.length,rest:[]};let a=e_(l),b=e2(l,b=>b===a),c=k*h,d=g/2*c,e=j+b[0].length,f=Math.abs(e-c);if(e<c-d){m=g,n=h,o=e$(l),p=e,q=k,r=b[1],g=m,h=n,i=o,j=p,k=q,l=r;continue}if(e>c+d)return{quantile:k,value:bD(i)?bG(a):i,consumed:j,rest:l};switch(i._tag){case"None":m=g,n=h,o=e$(l),p=e,q=k,r=b[1],g=m,h=n,i=o,j=p,k=q,l=r;continue;case"Some":if(f<Math.abs(c-i.value)){m=g,n=h,o=e$(l),p=e,q=k,r=b[1],g=m,h=n,i=o,j=p,k=q,l=r;continue}return{quantile:k,value:bG(i.value),consumed:j,rest:l}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},tn=Symbol.for("effect/MetricPair"),to={_Type:a=>a},tp=(a,b)=>({[tn]:to,metricKey:a,metricState:b,pipe(){return a7(this,arguments)}}),tq=Symbol.for("effect/MetricRegistry");class tr{snapshot(){let a=[];for(let[b,c]of this.map)a.push(tp(b,c.get()));return a}get(a){let b=aa(this.map,sQ(a),ep);if(null!=b)return b;if(sD(a.keyType))return this.getCounter(a);if(ap(a.keyType,sw))return this.getGauge(a);if(ap(a.keyType,su))return this.getFrequency(a);if(sE(a.keyType))return this.getHistogram(a);if(ap(a.keyType,sz))return this.getSummary(a);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(a){let b=aa(this.map,sQ(a),ep);if(null==b){let c=(a=>{let b=a.keyType.bigint?tl:0,c=a.keyType.incremental?a.keyType.bigint?a=>a>=tl:a=>a>=0:a=>!0,d=a=>{c(a)&&(b+=a)};return tk({get:()=>new s7(b),update:d,modify:d})})(a);aa(this.map,sS(a))||aa(this.map,sT(a,c)),b=c}return b}getFrequency(a){let b=aa(this.map,sQ(a),ep);if(null==b){let c=(a=>{let b=new Map;for(let c of a.keyType.preregisteredWords)b.set(c,0);let c=a=>{let c=b.get(a)??0;b.set(a,c+1)};return tk({get:()=>new s9(b),update:c,modify:c})})(a);aa(this.map,sS(a))||aa(this.map,sT(a,c)),b=c}return b}getGauge(a){let b=aa(this.map,sQ(a),ep);if(null==b){let c,d=(c=a.keyType.bigint?BigInt(0):0,tk({get:()=>new ta(c),update:a=>{c=a},modify:a=>{c+=a}}));aa(this.map,sS(a))||aa(this.map,sT(a,d)),b=d}return b}getHistogram(a){let b=aa(this.map,sQ(a),ep);if(null==b){let c=(a=>{let b=a.keyType.boundaries.values,c=b.length,d=new Uint32Array(c+1),e=new Float32Array(c),f=0,g=0,h=Number.MAX_VALUE,i=5e-324;aa(b,e5(eD),ff((a,b)=>{e[b]=a}));let j=a=>{let b=0,j=c;for(;b!==j;){let c=Math.floor(b+(j-b)/2);a<=e[c]?j=c:b=c,j===b+1&&(a<=e[b]?j=b:b=j)}d[b]=d[b]+1,f+=1,g+=a,a<h&&(h=a),a>i&&(i=a)};return tk({get:()=>{let a;return new tb((a={buckets:(()=>{let a=eM(c),b=0;for(let f=0;f<c;f++){let c=e[f];b+=d[f],a[f]=[c,b]}return a})(),count:f,min:h,max:i,sum:g}).buckets,a.count,a.min,a.max,a.sum)},update:j,modify:j})})(a);aa(this.map,sS(a))||aa(this.map,sT(a,c)),b=c}return b}getSummary(a){let b=aa(this.map,sQ(a),ep);if(null==b){let c=(a=>{let{error:b,maxAge:c,maxSize:d,quantiles:e}=a.keyType,f=aa(e,e5(eD)),g=eM(d),h=0,i=0,j=0,k=0,l=0,m=(a,b)=>{d>0&&(g[(h+=1)%d]=[b,a]),k=0===i?a:Math.min(k,a),l=0===i?a:Math.max(l,a),i+=1,j+=a};return tk({get:()=>{let a;return a={error:b,quantiles:(a=>{let e=[],h=0;for(;h!==d-1;){let b=g[h];if(null!=b){let[d,f]=b,g=gZ(a-d);hb(g,gV)&&g9(g,c)&&e.push(f)}h+=1}return((a,b,c)=>{let d=c.length;if(!eW(b))return fd();let e=b[0],f=b.slice(1),g=tm(a,d,ej(),0,e,c),h=fe(g);return f.forEach(b=>{h.push(tm(a,d,g.value,g.consumed,b,g.rest))}),ff(h,a=>[a.quantile,a.value])})(b,f,e5(e,eD))})(Date.now()),count:i,min:k,max:l,sum:j},new tc(a.error,a.quantiles,a.count,a.min,a.max,a.sum)},update:([a,b])=>m(a,b),modify:([a,b])=>m(a,b)})})(a);aa(this.map,sS(a))||aa(this.map,sT(a,c)),b=c}return b}constructor(){this[tq]=tq,this.map=sP()}}let ts=Symbol.for("effect/Metric"),tt={_Type:a=>a,_In:a=>a,_Out:a=>a},tu=ad(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new tr),tv=function(a,b,c,d){let e=Object.assign(a=>lB(a,a=>tA(e,a)),{[ts]:tt,keyType:a,unsafeUpdate:b,unsafeValue:c,unsafeModify:d,register(){return this.unsafeValue([]),this},pipe(){return a7(this,arguments)}});return e},tw=(a,b)=>tx(((a,b)=>new sI(a,(a=>new sB(a?.incremental??!1,a?.bigint??!1))(b),eo(b?.description)))(a,b)),tx=a=>{let b,c=new WeakMap,d=d=>{if(0===d.length)return void 0!==b?b:b=tu.get(a);let e=c.get(d);return void 0!==e||(e=tu.get(sK(a,d)),c.set(d,e)),e};return tv(a.keyType,(a,b)=>d(b).update(a),a=>d(a).get(),(a,b)=>d(b).modify(a))},ty=W(3,(a,b,c)=>tz(a,[new pv(b,c)])),tz=W(2,(a,b)=>tv(a.keyType,(c,d)=>a.unsafeUpdate(c,fc(b,d)),c=>a.unsafeValue(fc(b,c)),(c,d)=>a.unsafeModify(c,fc(b,d)))),tA=W(2,(a,b)=>l3(mq,c=>lA(()=>a.unsafeUpdate(b,c)))),tB="effect/MetricBoundaries",tC=Symbol.for(tB);class tD{constructor(a){this[tC]=tC,this.values=a,this._hash=aa(aQ(tB),aM(aS(this.values)))}[aJ](){return this._hash}[aU](a){return tE(a)&&aV(this.values,a.values)}pipe(){return a7(this,arguments)}}let tE=a=>ap(a,tC),tF=a=>new tD(aa(a,eU(fX(1/0)),ft)),tG=W(2,(a,b)=>l3(rB,c=>lA(()=>{if(c.has(a)){let d=c.get(a);d.state.completed||(d.state.completed=!0,nl(d.result,b))}})));class tH{addObserver(a){this.observers.add(a)}removeObserver(a){this.observers.delete(a)}increment(){this.count++,this.observers.forEach(a=>a(this.count))}decrement(){this.count--,this.observers.forEach(a=>a(this.count))}constructor(){this.count=0,this.observers=new Set,this.interrupted=!1}}let tI=Symbol.for("effect/Supervisor"),tJ={_T:a=>a};class tK{constructor(a,b){this[tI]=tJ,this.underlying=a,this.value0=b}get value(){return this.value0}onStart(a,b,c,d){this.underlying.onStart(a,b,c,d)}onEnd(a,b){this.underlying.onEnd(a,b)}onEffect(a,b){this.underlying.onEffect(a,b)}onSuspend(a){this.underlying.onSuspend(a)}onResume(a){this.underlying.onResume(a)}map(a){return new tK(this,aa(this.value,lp(a)))}zip(a){return new tL(this,a)}}class tL{constructor(a,b){this._tag="Zip",this[tI]=tJ,this.left=a,this.right=b}get value(){return lM(this.left.value,this.right.value)}onStart(a,b,c,d){this.left.onStart(a,b,c,d),this.right.onStart(a,b,c,d)}onEnd(a,b){this.left.onEnd(a,b),this.right.onEnd(a,b)}onEffect(a,b){this.left.onEffect(a,b),this.right.onEffect(a,b)}onSuspend(a){this.left.onSuspend(a),this.right.onSuspend(a)}onResume(a){this.left.onResume(a),this.right.onResume(a)}map(a){return new tK(this,aa(this.value,lp(a)))}zip(a){return new tL(this,a)}}let tM=a=>ap(a,tI)&&aq(a,"Zip");class tN{get value(){return lA(()=>Array.from(this.fibers))}onStart(a,b,c,d){this.fibers.add(d)}onEnd(a,b){this.fibers.delete(b)}onEffect(a,b){}onSuspend(a){}onResume(a){}map(a){return new tK(this,aa(this.value,lp(a)))}zip(a){return new tL(this,a)}onRun(a,b){return a()}constructor(){this[tI]=tJ,this.fibers=new Set}}class tO{constructor(a){this[tI]=tJ,this.effect=a}get value(){return this.effect}onStart(a,b,c,d){}onEnd(a,b){}onEffect(a,b){}onSuspend(a){}onResume(a){}map(a){return new tK(this,aa(this.value,lp(a)))}zip(a){return new tL(this,a)}onRun(a,b){return a()}}let tP=lA(()=>new tN),tQ=ad("effect/Supervisor/none",()=>new tO(lF)),tR="Empty",tS="AddSupervisor",tT="RemoveSupervisor",tU="AndThen",tV={_tag:tR},tW=(a,b)=>({_tag:tU,first:a,second:b}),tX=(a,b)=>aV(a,b)?tQ:tM(a)?tX(a.left,b).zip(tX(a.right,b)):a,tY=a=>aV(a,tQ)?hU():tM(a)?aa(tY(a.left),h2(tY(a.right))):h6(a),tZ=jz({empty:tV,patch:(a,b)=>((a,b)=>{let c=a,d=b;for(;gg(d);){let a=gi(d);switch(a._tag){case tR:d=gn(d);break;case tS:c=c.zip(a.supervisor),d=gn(d);break;case tT:c=tX(c,a.supervisor),d=gn(d);break;case tU:d=f5(a.first)(f5(a.second)(gn(d)))}}return c})(b,fX(a)),combine:tW,diff:(a,b)=>{if(aV(a,b))return tV;let c=tY(a),d=tY(b),e=aa(d,h1(c),h4(tV,(a,b)=>tW(a,{_tag:tS,supervisor:b}))),f=aa(c,h1(d),h4(tV,(a,b)=>tW(a,{_tag:tT,supervisor:b})));return tW(e,f)}}),t$=tw("effect_fiber_started",{incremental:!0}),t_=tw("effect_fiber_active"),t0=tw("effect_fiber_successes",{incremental:!0}),t1=tw("effect_fiber_failures",{incremental:!0}),t2=ty(tx((s=(a=>aa(eN(a.count-1,b=>a.start*Math.pow(a.factor,b)),f1,tF))({start:.5,factor:2,count:35}),new sI("effect_fiber_lifetimes",new sC(s),eo(t)))),"time_unit","milliseconds"),t3="Continue",t4="Yield",t5={_E:a=>a,_A:a=>a},t6=a=>{throw Error(`BUG: FiberRuntime - ${a1(a)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},t7=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),t8=ad("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),t9={[bc]:(a,b,c)=>aG(()=>b.effect_instruction_i1(c)),OnStep:(a,b,c)=>m6(m6(c)),[bd]:(a,b,c)=>aG(()=>b.effect_instruction_i2(c)),[bl]:(a,b,c)=>(a.patchRuntimeFlags(a.currentRuntimeFlags,b.patch),jJ(a.currentRuntimeFlags)&&a.isInterrupted())?m_(a.getInterruptedCause()):m6(c),[bh]:(a,b,c)=>(aG(()=>b.effect_instruction_i2(c)),aG(()=>b.effect_instruction_i0()))?(a.pushStack(b),aG(()=>b.effect_instruction_i1())):lF,[bi]:(a,b,c)=>{let d=aG(()=>b.effect_instruction_i0.next(c));return d.done?m6(d.value):(a.pushStack(b),aD(d.value))}},ua={[rE]:(a,b,c,d)=>(a.processNewInterruptSignal(d.cause),jJ(b)?m_(d.cause):c),[rG]:(a,b,c,d)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[rF]:(a,b,c,d)=>(d.onFiber(a,rb(b)),c),[rH]:(a,b,c,d)=>lb(lL(),()=>c)},ub=ab();class uc extends b2{static{f=rQ,g=rT}constructor(a,b,c){if(super(),this[f]=rR,this[g]=t5,this._queue=[],this._children=null,this._observers=[],this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[],this._isYielding=!1,this.currentOpCount=0,this.run=()=>{this.drainQueueOnCurrentThread()},this.currentRuntimeFlags=c,this._fiberId=a,this._fiberRefs=b,jO(c)){let a=this.getFiberRef(mq);t$.unsafeUpdate(1,a),t_.unsafeUpdate(1,a)}this.refreshRefCache()}commit(){return rU(this)}id(){return this._fiberId}resume(a){this.tell(rK(a))}get status(){return this.ask((a,b)=>b)}get runtimeFlags(){return this.ask((a,b)=>b._tag===q2?a.currentRuntimeFlags:b.runtimeFlags)}scope(){return new rO(this.id(),this)}get children(){return this.ask(a=>Array.from(a.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(ms)}fiberRefs(){return this.ask(a=>a.getFiberRefs())}ask(a){return lz(()=>{let b=nc(this._fiberId);return this.tell(rJ((c,d)=>{nl(b,lA(()=>a(c,d)))})),nf(b)})}tell(a){this._queue.push(a),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return kX(a=>{let b=b=>a(ly(b));return this.tell(rJ((a,c)=>{null!==a._exitValue?b(this._exitValue):a.addObserver(b)})),lA(()=>this.tell(rJ((a,c)=>{a.removeObserver(b)})))},this.id())}get inheritAll(){return kQ((a,b)=>{let c=a.id(),d=a.getFiberRefs(),e=b.runtimeFlags,f=oZ(d,c,this.getFiberRefs());return a.setFiberRefs(f),lG(aa(jQ(e,a.getFiberRef(uS)),jE(1),jE(16)))})}get poll(){return lA(()=>eo(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(a){return lA(()=>this.tell(rI(j3(a))))}unsafeInterruptAsFork(a){this.tell(rI(j3(a)))}addObserver(a){null!==this._exitValue?a(this._exitValue):this._observers.push(a)}removeObserver(a){this._observers=this._observers.filter(b=>b!==a)}getFiberRefs(){return this.setFiberRef(uS,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(a){this._fiberRefs=o0(this._fiberRefs,a)}getFiberRef(a){return this._fiberRefs.locals.has(a)?this._fiberRefs.locals.get(a)[0][1]:a.initial}setFiberRef(a,b){this._fiberRefs=o3(this._fiberRefs,{fiberId:this._fiberId,fiberRef:a,value:b}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(oy),this.currentTracer=this.currentDefaultServices.unsafeMap.get(oq.key),this.currentSupervisor=this.getFiberRef(uT),this.currentScheduler=this.getFiberRef(rg),this.currentContext=this.getFiberRef(mg),this.currentSpan=this.currentContext.unsafeMap.get(or.key)}setFiberRefs(a){this._fiberRefs=a,this.refreshRefCache()}addChild(a){this.getChildren().add(a)}removeChild(a){this.getChildren().delete(a)}transferChildren(a){let b=this._children;if(this._children=null,null!==b&&b.size>0)for(let c of b)null===c._exitValue&&a.add(this.currentRuntimeFlags,c)}drainQueueOnCurrentThread(){let a=!0;for(;a;){let b=t3,c=globalThis[rW];globalThis[rW]=this;try{for(;b===t3;)b=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[rW]=c}this._queue.length>0&&!this._running?(this._running=!0,b===t4?(this.drainQueueLaterOnExecutor(),a=!1):a=!0):a=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(mh))}drainQueueWhileRunning(a,b){let c=b;for(;this._queue.length>0;){let b=this._queue.splice(0,1)[0];c=ua[b._tag](this,a,c,b)}return c}isInterrupted(){return!j7(this.getFiberRef(ms))}addInterruptedCause(a){let b=this.getFiberRef(ms);this.setFiberRef(ms,j5(b,a))}processNewInterruptSignal(a){this.addInterruptedCause(a),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let a=!1;for(let b of this._children)b.tell(rI(j3(this.id()))),a=!0;return a}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let a=this._children.values();this._children=null;let b=!1;return lI({while:()=>!b,body:()=>{let c=a.next();return c.done?lA(()=>{b=!0}):kT(c.value.await)},step:()=>{}})}return null}reportExitValue(a){if(jO(this.currentRuntimeFlags)){let b=this.getFiberRef(mq),c=this.id().startTimeMillis,d=Date.now();switch(t2.unsafeUpdate(d-c,b),t_.unsafeUpdate(-1,b),a._tag){case be:t0.unsafeUpdate(1,b);break;case ba:t1.unsafeUpdate(1,b)}}if("Failure"===a._tag){let b=this.getFiberRef(mp);j9(a.cause)||"Some"!==b._tag||this.log("Fiber terminated with an unhandled error",a.cause,b)}}setExitValue(a){this._exitValue=a,this.reportExitValue(a);for(let b=this._observers.length-1;b>=0;b--)this._observers[b](a);this._observers=[]}getLoggers(){return this.getFiberRef(ul)}log(a,b,c){let d=bE(c)?c.value:this.getFiberRef(mk);if(o6(this.getFiberRef(ud),d))return;let e=this.getFiberRef(ml),f=this.getFiberRef(mj),g=this.getLoggers(),h=this.getFiberRefs();if(h7(g)>0){let c=new Date(bV(this.getFiberRef(oy),nv).unsafeCurrentTimeMillis());((a,b)=>{let c=a5.fiberRefs;a5.fiberRefs=a;try{return b()}finally{a5.fiberRefs=c}})(h,()=>{for(let i of g)i.log({fiberId:this.id(),logLevel:d,message:a,cause:b,context:h,spans:e,annotations:f,date:c})})}}evaluateMessageWhileSuspended(a){switch(a._tag){case rH:return t4;case rE:return this.processNewInterruptSignal(a.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(m_(a.cause)),this._asyncInterruptor=null),t3;case rG:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(a.effect),t3;case rF:return a.onFiber(this,null!==this._exitValue?q9:new q8(this.currentRuntimeFlags,this._asyncBlockingOn)),t3;default:return t6(a)}}evaluateEffect(a){this.currentSupervisor.onResume(this);try{let b=jJ(this.currentRuntimeFlags)&&this.isInterrupted()?m_(this.getInterruptedCause()):a;for(;null!==b;){let a=b,c=this.runLoop(a);if(c===t7){let a=t8.currentOp;t8.currentOp=null,a._op===bk?jG(this.currentRuntimeFlags)?(this.tell(rL()),this.tell(rK(m7)),b=null):b=m7:a._op===a8&&(b=null)}else{this.currentRuntimeFlags=aa(this.currentRuntimeFlags,jI(16));let a=this.interruptAllChildren();null!==a?b=lb(a,()=>c):(0===this._queue.length?this.setExitValue(c):this.tell(rK(c)),b=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(a){if(this._running)this.tell(rK(a));else{this._running=!0;let b=globalThis[rW];globalThis[rW]=this;try{this.evaluateEffect(a)}finally{this._running=!1,globalThis[rW]=b,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(a){this.tell(rK(a))}patchRuntimeFlags(a,b){let c=jR(a,b);return globalThis[rW]=this,this.currentRuntimeFlags=c,c}initiateAsync(a,b){let c=!1,d=a=>{c||(c=!0,this.tell(rK(a)))};jJ(a)&&(this._asyncInterruptor=d);try{b(d)}catch(a){d(k7(j2(a)))}}pushStack(a){this._stack.push(a),"OnStep"===a._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let a=this._stack.pop();if(a)return"OnStep"===a._op&&this._steps.pop(),a}getNextSuccessCont(){let a=this.popStack();for(;a;){if(a._op!==bb)return a;a=this.popStack()}}getNextFailCont(){let a=this.popStack();for(;a;){if(a._op!==bc&&a._op!==bh&&a._op!==bi)return a;a=this.popStack()}}Tag(a){return lA(()=>bV(this.currentContext,a))}Left(a){return k5(a.left)}None(a){return k5(new mO)}Right(a){return m6(a.right)}Some(a){return m6(a.value)}Micro(a){return kV(b=>{let c=b,d=((a,b)=>{let c=new ck(c$.context(b?.scheduler??new cW));if(c.evaluate(a),b?.signal)if(b.signal.aborted)c.unsafeInterrupt();else{let a=()=>c.unsafeInterrupt();b.signal.addEventListener("abort",a,{once:!0}),c.addObserver(()=>b.signal.removeEventListener("abort",a))}return c})(cY(a,this.currentContext));return d.addObserver(a=>{if("Success"===a._tag)return c(m6(a.value));switch(a.cause._tag){case"Interrupt":return c(m_(j3(ix)));case"Fail":return c(k5(a.cause.error));case"Die":return c(k1(a.cause.defect))}}),kV(a=>{c=b=>{a(lF)},d.unsafeInterrupt()})})}[bf](a){let b=aG(()=>a.effect_instruction_i0()),c=this.getNextSuccessCont();return void 0!==c?(c._op in t9||t6(c),t9[c._op](this,c,b)):(t8.currentOp=m6(b),t7)}[be](a){let b=this.getNextSuccessCont();return void 0!==b?(b._op in t9||t6(b),t9[b._op](this,b,a.effect_instruction_i0)):(t8.currentOp=a,t7)}[ba](a){let b=a.effect_instruction_i0,c=this.getNextFailCont();if(void 0===c)return t8.currentOp=m_(b),t7;switch(c._op){case bb:case bd:if(!(jJ(this.currentRuntimeFlags)&&this.isInterrupted()))return aG(()=>c.effect_instruction_i1(b));return m_(kf(b));case"OnStep":if(!(jJ(this.currentRuntimeFlags)&&this.isInterrupted()))return m6(m_(b));return m_(kf(b));case bl:if(this.patchRuntimeFlags(this.currentRuntimeFlags,c.patch),jJ(this.currentRuntimeFlags)&&this.isInterrupted())return m_(j5(b,this.getInterruptedCause()));return m_(b);default:t6(c)}}[bj](a){return aG(()=>a.effect_instruction_i0(this,rb(this.currentRuntimeFlags)))}Blocked(a){let b=this.getFiberRefs(),c=this.currentRuntimeFlags;if(this._steps.length>0){let d=[],e=this._steps[this._steps.length-1],f=this.popStack();for(;f&&"OnStep"!==f._op;)d.push(f),f=this.popStack();this.setFiberRefs(e.refs),this.currentRuntimeFlags=e.flags;let g=pq(e.refs,b),h=jQ(e.flags,c);return m6(kJ(a.effect_instruction_i0,kQ(b=>{for(;d.length>0;)b.pushStack(d.pop());return b.setFiberRefs(ps(b.id(),b.getFiberRefs())(g)),b.currentRuntimeFlags=jR(h)(b.currentRuntimeFlags),a.effect_instruction_i1})))}return lE(b=>lb(uu((a=>{let b=new kM("RunBlocked");return b.effect_instruction_i0=a,b})(a.effect_instruction_i0)),()=>b(a.effect_instruction_i1)))}RunBlocked(a){return lj((a=>{let b=iN(a),c=iM();for(;;){let[a,d]=iR(b,[rp(),iM()],([a,b],c)=>{let[d,e]=rj(c);return[rr(a,d),iO(b,e)]});if(c=rk(c,a),iJ(d))return iS(c);b=d}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")})(a.effect_instruction_i0),a=>us(Array.from(a.map),([a,b])=>{let c=new Map,d=[];for(let a of b)for(let b of(d.push(f$(a)),a))c.set(b.request,b);let e=d.flat();return mb(uZ(a.runAll(d),e,()=>e.forEach(a=>{a.listeners.interrupted=!0})),rB,c)},!1,!1))}[bg](a){let b=a.effect_instruction_i0,c=this.currentRuntimeFlags,d=jR(c,b);if(jJ(d)&&this.isInterrupted())return m_(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,b),!a.effect_instruction_i1)return m7;{let b=jQ(d,c);return this.pushStack(new kL(b,a)),aG(()=>a.effect_instruction_i1(c))}}[bc](a){return this.pushStack(a),a.effect_instruction_i0}OnStep(a){return this.pushStack(a),a.effect_instruction_i0}[bb](a){return this.pushStack(a),a.effect_instruction_i0}[bd](a){return this.pushStack(a),a.effect_instruction_i0}[a8](a){return this._asyncBlockingOn=a.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,a.effect_instruction_i0),t8.currentOp=a,t7}[bk](a){return this._isYielding=!1,t8.currentOp=a,t7}[bh](a){let b=a.effect_instruction_i0,c=a.effect_instruction_i1;return b()?(this.pushStack(a),c()):m7}[bi](a){return t9[bi](this,a,void 0)}[a9](a){return aG(()=>a.commit())}runLoop(a){let b=a;for(this.currentOpCount=0;;){if((2&this.currentRuntimeFlags)!=0&&this.currentSupervisor.onEffect(this,b),this._queue.length>0&&(b=this.drainQueueWhileRunning(this.currentRuntimeFlags,b)),!this._isYielding){this.currentOpCount+=1;let a=this.currentScheduler.shouldYield(this);if(!1!==a){this._isYielding=!0,this.currentOpCount=0;let c=b;b=lb(lL({priority:a}),()=>c)}}try{if((b=this.currentTracer.context(()=>ub!==b[kK]._V?k2(`Cannot execute an Effect versioned ${b[kK]._V} with a Runtime of version ${ab()}`):this[b._op](b),this))===t7){let a=t8.currentOp;if(a._op===bk||a._op===a8)return t7;return t8.currentOp=null,a._op===be||a._op===ba?a:m_(j2(a))}}catch(a){b=(b===t7||ap(b,"_op"))&&b._op in this?mK(a)?m_(j5(j2(a),j3(ix))):k1(a):k2(`Not a valid effect: ${a1(b)}`)}}}}let ud=ad("effect/FiberRef/currentMinimumLogLevel",()=>md(o7("Info"))),ue=a=>rZ(b=>{bV(o2(b.context,oy),oi).unsafe.log(a.log(b))}),uf=ad(Symbol.for("effect/Logger/defaultLogger"),()=>ue(r8)),ug=ad(Symbol.for("effect/Logger/jsonLogger"),()=>ue(sc)),uh=ad(Symbol.for("effect/Logger/logFmtLogger"),()=>ue(r9)),ui=ad(Symbol.for("effect/Logger/prettyLogger"),()=>sp),uj=ad(Symbol.for("effect/Logger/structuredLogger"),()=>ue(sa)),uk=ad(Symbol.for("effect/Logger/tracerLogger"),()=>rZ(({annotations:a,cause:b,context:c,fiberId:d,logLevel:e,message:f})=>{let g=bW(o2(c,mg),or);if("None"===g._tag||"ExternalSpan"===g.value._tag)return;let h=bV(o2(c,oy),nv),i={};for(let[b,c]of a)i[b]=c;i["effect.fiberId"]=iv(d),i["effect.logLevel"]=e.label,null!==b&&"Empty"!==b._tag&&(i["effect.cause"]=ku(b,{renderErrorCause:!0})),g.value.event(a1(Array.isArray(f)?f[0]:f),h.unsafeCurrentTimeNanos(),i)})),ul=ad(Symbol.for("effect/FiberRef/currentLoggers"),()=>(a=>{let b=jz({empty:jd,combine:(a,b)=>jh(b)(a),diff:(a,b)=>((a,b)=>{let[c,d]=h4([a,jd],([a,b],c)=>hV(c)(a)?[h0(c)(a),b]:[a,jh((a=>{let b=Object.create(jf);return b.value=a,b})(c))(b)])(b);return h4(d,(a,b)=>jh((a=>{let b=Object.create(jg);return b.value=a,b})(b))(a))(c)})(a,b),patch:(a,b)=>ji(b)(a)});return mf(a,{differ:b,fork:b.empty})})(h6(uf,uk))),um=W(3,(a,b,c)=>lb(uK,d=>{let e=[],f=lz(()=>{if(0===e.length)return lF;let a=e;return e=[],c(a)});return lE(c=>aa(oV(b),lO(f),pI,c,uu,lb(a=>mz(d,lR(a))),lO(uo(()=>f)),kS(rZ(b=>{e.push(a.log(b))}))))})),un=W(a=>kP(a[0]),(a,b)=>lD(lB(a,a=>uo(c=>b(a,c))))),uo=a=>kQ(b=>{let c=b.getFiberRefs(),d=jH(b.currentRuntimeFlags,1);return lb(uK,b=>mA(b,b=>kQ(e=>{let f=e.getFiberRefs(),g=e.currentRuntimeFlags,h=pq(f,c),i=jQ(g,d),j=pq(c,f);return e.setFiberRefs(ps(h,e.id(),c)),uY(lK(a(b),i),lA(()=>{e.setFiberRefs(ps(j,e.id(),e.getFiberRefs()))}))})))}),up=((a=>au(a[0])&&!kP(a[0]),(a,b,c)=>{let d=c?.negate?(a,c)=>lp(b(a,c),fN):b;return rD(c?.concurrency,()=>lz(()=>eO(a).reduceRight((a,b,c)=>lP(a,lz(()=>d(b,c)),(a,c)=>c?[b,...a]:a),lA(()=>[]))),()=>lp(uq(a,(a,b)=>lp(d(a,b),b=>b?bG(a):ej()),c),fl))}),(a,b)=>{let[c,d]=(a=>{if(Array.isArray(a)||au(a))return[a,ej()];let b=Object.keys(a),c=b.length;return[b.map(b=>a[b]),bG(a=>{let d={};for(let e=0;e<c;e++)d[b[e]]=a[e];return d})]})(a);return b?.mode==="validate"?((a,b,c)=>{let d=[];for(let b of a)d.push(k3(b));return lb(uq(d,X,{concurrency:c?.concurrency,batching:c?.batching,concurrentFinalizers:c?.concurrentFinalizers}),a=>{let d=ej(),e=a.length,f=Array(e),g=Array(e),h=!1;for(let b=0;b<e;b++){let c=a[b];"Left"===c._tag?(f[b]=bG(c.left),h=!0):(g[b]=c.right,f[b]=d)}return h?"Some"===b._tag?k5(b.value(f)):k5(f):c?.discard?lF:"Some"===b._tag?ly(b.value(g)):ly(g)})})(c,d,b):b?.mode==="either"?((a,b,c)=>{let d=[];for(let b of a)d.push(k3(b));return c?.discard?uq(d,X,{concurrency:c?.concurrency,batching:c?.batching,discard:!0,concurrentFinalizers:c?.concurrentFinalizers}):lp(uq(d,X,{concurrency:c?.concurrency,batching:c?.batching,concurrentFinalizers:c?.concurrentFinalizers}),a=>"Some"===b._tag?b.value(a):a)})(c,d,b):b?.discard!==!0&&"Some"===d._tag?lp(uq(c,X,b),d.value):uq(c,X,b)}),uq=((a,b)=>Array.from({length:b},()=>a),W(a=>au(a[0]),(a,b,c)=>kQ(d=>{let e=c?.batching===!0||c?.batching==="inherit"&&d.getFiberRef(mo);return c?.discard?rC(c.concurrency,()=>uB(qZ,c?.concurrentFinalizers)(c=>e?us(a,(a,d)=>c(b(a,d)),!0,!1,1):lj(a,(a,d)=>c(b(a,d)))),()=>uB(q$,c?.concurrentFinalizers)(c=>us(a,(a,d)=>c(b(a,d)),e,!1)),d=>uB(q_(d),c?.concurrentFinalizers)(c=>us(a,(a,d)=>c(b(a,d)),e,!1,d))):rC(c?.concurrency,()=>uB(qZ,c?.concurrentFinalizers)(c=>e?ut(a,1,(a,d)=>c(b(a,d)),!0):li(a,(a,d)=>c(b(a,d)))),()=>uB(q$,c?.concurrentFinalizers)(c=>ur(a,(a,d)=>c(b(a,d)),e)),d=>uB(q_(d),c?.concurrentFinalizers)(c=>ut(a,d,(a,d)=>c(b(a,d)),e)))}))),ur=(a,b,c)=>lz(()=>{let d=eO(a),e=Array(d.length);return lO(us(d,(a,c)=>lb(b(a,c),a=>lA(()=>e[c]=a)),c,!1),ly(e))}),us=(a,b,c,d,e)=>lE(f=>{let g;return g=g=>kQ(h=>{let i=Array.from(a).reverse(),j=i.length;if(0===j)return lF;let k=0,l=!1,m=e?Math.min(i.length,e):i.length,n=new Set,o=[],p=[],q=[],r=[],s=()=>{let a=o.filter(({exit:a})=>"Failure"===a._tag).sort((a,b)=>a.index<b.index?-1:+(a.index!==b.index)).map(({exit:a})=>a);return 0===a.length&&a.push(m7),a},t=(a,b=!1)=>{let c=lD(g(a)),d=uw(c,h,h.currentRuntimeFlags,rP);return h.currentScheduler.scheduleTask(()=>{b&&d.unsafeInterruptAsFork(h.id()),d.resume(c)},0),d},u=()=>{d||(j-=i.length,i=[]),l=!0,n.forEach(a=>{a.currentScheduler.scheduleTask(()=>{a.unsafeInterruptAsFork(h.id())},0)})},v=c?ld:k4,w=t(kX(a=>{let d=(a,b)=>{"Blocked"===a._op?r.push(a):(o.push({index:b,exit:a}),"Failure"!==a._op||l||u())},g=()=>{if(i.length>0){let m=i.pop(),u=k++,w=a=>i.length>0&&(d(a,u),i.length>0)?(()=>{let a=i.pop();return u=k++,lb(lL(),()=>lb(v(f(b(a,u))),w))})():ly(a),x=t(lb(v(f(b(m,u))),w));p.push(x),n.add(x),l&&x.currentScheduler.scheduleTask(()=>{x.unsafeInterruptAsFork(h.id())},0),x.addObserver(b=>{let f;if(f="Failure"===b._op?b:b.effect_instruction_i0,q.push(x),n.delete(x),d(f,u),o.length===j)a(ly(el(mY(s(),{parallel:!0}),()=>m7)));else if(r.length+o.length===j){let b=s();a(ly(kJ(r.map(a=>a.effect_instruction_i0).reduce(rh),us([el(mY(b,{parallel:!0}),()=>m7),...r.map(a=>a.effect_instruction_i1)],a=>a,c,!0,e))))}else g()})}};for(let a=0;a<m;a++)g()}));return kT(ls(le(f(rU(w))),m4({onFailure:a=>{u();let b=r.length+1,c=Math.min("number"==typeof e?e:r.length,r.length),d=Array.from(r);return kX(e=>{let f=[],g=0,h=0,i=(c,h)=>i=>{f[c]=i,++g===b&&e(m6(m_(a))),d.length>0&&h&&j()},j=()=>{t(d.pop(),!0).addObserver(i(h,!0)),h++};w.addObserver(i(h,!1)),h++;for(let a=0;a<c;a++)j()})},onSuccess:()=>li(q,a=>a.inheritAll)})))}),kQ(a=>{let b=aa(a.getFiberRef(mr),el(()=>a.scope()));return g(mb(mr,bG(b)))})}),ut=(a,b,c,d)=>lz(()=>{let e=eO(a),f=Array(e.length);return lO(us(e,(a,b)=>lp(c(a,b),a=>f[b]=a),d,!1,b),ly(f))}),uu=a=>uy(a,rP),uv=(a,b,c,d=null)=>{let e=ux(a,b,c,d);return e.resume(a),e},uw=(a,b,c,d=null)=>ux(a,b,c,d),ux=(a,b,c,d=null)=>{let e=iA(),f=o$(b.getFiberRefs(),e),g=new uc(e,f,c),h=o2(f,mg),i=g.currentSupervisor;return i.onStart(h,a,bG(b),g),g.addObserver(a=>i.onEnd(a,g)),(null!==d?d:aa(b.getFiberRef(mr),el(()=>b.scope()))).add(c,g),g},uy=(a,b)=>kQ((c,d)=>ly(uv(a,c,d.runtimeFlags,b))),uz=((a=>"function"==typeof a[2],(a,b,c,d)=>rD(d?.concurrency,()=>eO(a).reduce((a,b,d)=>lP(a,b,(a,b)=>c(a,b,d)),ly(b)),()=>lb(pf(b),b=>lb(uq(a,(a,d)=>lb(a,a=>pj(b,b=>c(b,a,d))),d),()=>b.get)))),a=>no(b=>ek(bW(b,uJ),{onNone:()=>a,onSome:b=>{switch(b.strategy._tag){case"Parallel":return a;case"Sequential":case"ParallelN":return lb(mC(b,q$),b=>uO(a,b))}}}))),uA=a=>b=>no(c=>ek(bW(c,uJ),{onNone:()=>b,onSome:c=>"ParallelN"===c.strategy._tag&&c.strategy.parallelism===a?b:lb(mC(c,q_(a)),a=>uO(b,a))})),uB=(a,b)=>c=>no(d=>ek(bW(d,uJ),{onNone:()=>c(X),onSome:d=>{if(!0!==b)return c(X);{let b="Parallel"===a._tag?uz:"Sequential"===a._tag?uE:uA(a.parallelism);switch(d.strategy._tag){case"Parallel":return b(c(uz));case"Sequential":return b(c(uE));case"ParallelN":return b(c(uA(d.strategy.parallelism)))}}}})),uC=a=>lb(uJ,a),uD=a=>lb(uN(),b=>ls(a(b),a=>b.close(a))),uE=a=>no(b=>ek(bW(b,uJ),{onNone:()=>a,onSome:b=>{switch(b.strategy._tag){case"Sequential":return a;case"Parallel":case"ParallelN":return lb(mC(b,qZ),b=>uO(a,b))}}})),uF=((a=>kP(a[1]),(a,b,c,d)=>le(uI(k4(a),k4(b),(a,b)=>na(a,b,{onSuccess:c,onFailure:(a,b)=>d?.concurrent?j4(a,b):j5(a,b)}),d))),W(a=>kP(a[1]),(a,b,c)=>uI(a,b,(a,b)=>[a,b],c))),uG=W(a=>kP(a[1]),(a,b,c)=>c?.concurrent!==!0&&(c?.batching===void 0||!1===c.batching)?lN(a,b):uI(a,b,(a,b)=>a,c)),uH=W(a=>kP(a[1]),(a,b,c)=>c?.concurrent!==!0&&(c?.batching===void 0||!1===c.batching)?lO(a,b):uI(a,b,(a,b)=>b,c)),uI=W(a=>kP(a[1]),(a,b,c,d)=>lp(up([a,b],{concurrency:d?.concurrent?2:1,batching:d?.batching,concurrentFinalizers:d?.concurrentFinalizers}),([a,b])=>c(a,b))),uJ=bY("effect/Scope"),uK=uJ,uL={[mx]:mx,[my]:my,pipe(){return a7(this,arguments)},fork(a){return lA(()=>{var b;let c=uM(a);if("Closed"===this.state._tag)return c.state=this.state,c;let d={};return this.state.finalizers.set(d,a=>c.close(a)),b=a=>lA(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(d)}),"Open"===c.state._tag&&c.state.finalizers.set({},b),c})},close(a){return lz(()=>{if("Closed"===this.state._tag)return lF;let b=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:a},0===b.length)?lF:this.strategy._tag===qX?aa(li(b,b=>k4(b(a))),lb(a=>aa(mY(a),et(mX),el(()=>m7)))):this.strategy._tag===qY?aa(ur(b,b=>k4(b(a)),!1),lb(a=>aa(mY(a,{parallel:!0}),et(mX),el(()=>m7)))):aa(ut(b,this.strategy.parallelism,b=>k4(b(a)),!1),lb(a=>aa(mY(a,{parallel:!0}),et(mX),el(()=>m7))))})},addFinalizer(a){return lz(()=>"Closed"===this.state._tag?a(this.state.exit):(this.state.finalizers.set({},a),lF))}},uM=(a=qZ)=>{let b=Object.create(uL);return b.strategy=a,b.state={_tag:"Open",finalizers:new Map},b},uN=(a=qZ)=>lA(()=>uM(a)),uO=W(2,(a,b)=>nr(a,bX(bR(uJ,b)))),uP=W(2,(a,b)=>aa(a,uO(b),ls(a=>b.close(a)))),uQ=W(2,(a,b)=>kT(un(lb(l2(a),c=>kS(l4(a,b),c)),b=>l4(a,b)))),uR=W(2,(a,b)=>l3(a,c=>uQ(a,b(c)))),uS=mf(jN,{differ:jS,fork:jS.empty}),uT=mf(tQ,{differ:tZ,fork:tV}),uU=W(3,(a,b,c)=>uW(a,b,{onSelfWin:(a,b)=>lb(a.await,d=>{switch(d._tag){case be:return lb(a.inheritAll,()=>c.onSelfDone(d,b));case ba:return c.onSelfDone(d,b)}}),onOtherWin:(a,b)=>lb(a.await,d=>{switch(d._tag){case be:return lb(a.inheritAll,()=>c.onOtherDone(d,b));case ba:return c.onOtherDone(d,b)}})})),uV=W(2,(a,b)=>la(c=>uU(a,b,{onSelfDone:(a,b)=>m5(a,{onFailure:a=>aa(rU(b),pR(b=>j4(a,b))),onSuccess:a=>aa(b,lS(c),kS(a))}),onOtherDone:(a,b)=>m5(a,{onFailure:a=>aa(rU(b),pR(b=>j4(b,a))),onSuccess:a=>aa(b,lS(c),kS(a))})}))),uW=W(3,(a,b,c)=>kQ((d,e)=>{let f=e.runtimeFlags,g=ia(!0),h=ux(a,d,f,c.selfScope),i=ux(b,d,f,c.otherScope);return kX(d=>{h.addObserver(()=>uX(h,i,c.onSelfWin,g,d)),i.addObserver(()=>uX(i,h,c.onOtherWin,g,d)),h.startFork(a),i.startFork(b)},ir(h.id(),i.id()))})),uX=(a,b,c,d,e)=>{ib(!0,!1)(d)&&e(c(a,b))},uY=W(2,(a,b)=>lE(c=>lg(c(a),{onFailure:a=>lg(b,{onFailure:b=>k7(j5(a,b)),onSuccess:()=>k7(a)}),onSuccess:a=>kS(b,a)}))),uZ=(a,b,c)=>la(d=>lb(lb(uu(ln(a)),a=>kX(d=>{let e=b.map(a=>a.listeners.count),f=()=>{e.every(a=>0===a)&&b.every(a=>"Pending"===a.result.state.current._tag||!!("Done"===a.result.state.current._tag&&mU(a.result.state.current.effect)&&"Failure"===a.result.state.current.effect._tag&&j8(a.result.state.current.effect.cause)))&&(g.forEach(a=>a()),c?.(),d(lR(a)))};a.addObserver(a=>{g.forEach(a=>a()),d(a)});let g=b.map((a,b)=>{let c=a=>{e[b]=a,f()};return a.listeners.addObserver(c),()=>a.listeners.removeObserver(c)});return f(),lA(()=>{g.forEach(a=>a())})})),()=>lz(()=>lj(b.flatMap(a=>a.state.completed?[]:[a]),a=>tG(a.request,m2(d))))));class u${constructor(a){this.waiters=new Set,this.taken=0,this.take=a=>kW(b=>{if(this.free<a){let c=()=>{this.free<a||(this.waiters.delete(c),this.taken+=a,b(ly(a)))};return this.waiters.add(c),lA(()=>{this.waiters.delete(c)})}return this.taken+=a,b(ly(a))}),this.updateTaken=a=>kQ(b=>(this.taken=a(this.taken),this.waiters.size>0&&b.getFiberRef(rg).scheduleTask(()=>{let a=this.waiters.values(),b=a.next();for(;!1===b.done&&this.free>0;)b.value(),b=a.next()},b.getFiberRef(mh)),ly(this.free))),this.release=a=>this.updateTaken(b=>b-a),this.releaseAll=this.updateTaken(a=>0),this.withPermits=a=>b=>lE(c=>lb(c(this.take(a)),a=>uY(c(b),this.release(a)))),this.withPermitsIfAvailable=a=>b=>lE(c=>lz(()=>this.free<a?pX:(this.taken+=a,uY(c(py(b)),this.release(a))))),this.permits=a}get free(){return this.permits-this.taken}}let u_=a=>new u$(a);class u0 extends b2{constructor(a){super(),this.waiters=[],this.scheduled=!1,this.flushWaiters=()=>{this.scheduled=!1;let a=this.waiters;this.waiters=[];for(let b=0;b<a.length;b++)a[b](m7)},this.open=kQ(a=>this.isOpen?lF:(this.isOpen=!0,this.unsafeSchedule(a))),this.release=kQ(a=>this.isOpen?lF:this.unsafeSchedule(a)),this.await=kW(a=>this.isOpen?a(lF):(this.waiters.push(a),lA(()=>{let b=this.waiters.indexOf(a);-1!==b&&this.waiters.splice(b,1)}))),this.close=lA(()=>{this.isOpen=!1}),this.whenOpen=a=>lO(this.await,a),this.isOpen=a}commit(){return this.await}unsafeSchedule(a){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,a.currentScheduler.scheduleTask(this.flushWaiters,a.getFiberRef(mh))),lF}unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}unsafeClose(){this.isOpen=!1}}(a,b)=>{let c=gP(b);return lb(nn,b=>lp(vd(ej()),d=>[np(u2(a,c,d),b),u3(d)]))};let u1=(a,b,c)=>{let d=g3(gP(b));return aa(nd(),lB(b=>lo(a,b)),lp(a=>bG([c+d,a])))},u2=(a,b,c)=>lE(d=>aa(oA(a=>a.currentTimeMillis),lb(d=>vf(c,c=>{switch(c._tag){case"None":return bG(u1(a,b,d));case"Some":{let[e]=c.value;return e-d<=0?bG(u1(a,b,d)):ej()}}})),lb(a=>bD(a)?k2("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):d(nf(a.value[1]))))),u3=a=>pg(a,ej()),u4=((a,b)=>lb(tP,c=>aa(u7(a,c),uY(lb(c.value,b)))),W(2,(a,b)=>kQ((c,d)=>{let e=uv(a,c,d.runtimeFlags,rP);if("Open"===b.state._tag){let a={};b.state.finalizers.set(a,()=>la(a=>aV(a,e.id())?lF:kT(lR(e)))),e.addObserver(()=>{"Closed"!==b.state._tag&&b.state.finalizers.delete(a)})}else e.unsafeInterruptAsFork(c.id());return ly(e)}))),u5=a=>uC(b=>u4(a,b)),u6=W(2,(a,b)=>aa(k4(a),uV(k4(b)),a=>le(a))),u7=W(2,(a,b)=>mc(uT,a=>a.zip(b))(a)),u8=((a,{duration:b,onTimeout:c})=>le(u9(a,{onTimeout:()=>k6(c),onSuccess:ly,duration:b})),W(2,(a,{duration:b,onTimeout:c})=>le(u9(a,{onTimeout:()=>k8(c),onSuccess:ly,duration:b})))),u9=W(2,(a,{duration:b,onSuccess:c,onTimeout:d})=>la(e=>lE(f=>uW(f(a),ln(oV(b)),{onSelfWin:(a,b)=>lb(a.await,d=>"Success"===d._tag?lb(a.inheritAll,()=>kS(lS(b,e),c(d.value))):lb(lS(b,e),()=>m_(d.cause))),onOtherWin:(a,b)=>lb(a.await,c=>"Success"===c._tag?lb(a.inheritAll,()=>kS(lS(b,e),d())):lb(lS(b,e),()=>m_(c.cause))),otherScope:rP})))),va=Symbol.for("effect/Ref/SynchronizedRef"),vb={_A:a=>a};class vc extends b2{static{h=pb,i=pa}constructor(a,b){super(),this[va]=vb,this[h]=pc,this[i]=pa,this.ref=a,this.withLock=b,this.get=this.ref.get}commit(){return this.get}modify(a){return this.modifyEffect(b=>ly(a(b)))}modifyEffect(a){return this.withLock(aa(lb(this.ref.get,a),lb(([a,b])=>kS(pg(this.ref,b),a))))}}let vd=a=>lA(()=>ve(a)),ve=a=>new vc(pe(a),u_(1).withPermits(1)),vf=W(2,(a,b)=>a.modifyEffect(a=>{let c=b(a);switch(c._tag){case"None":return ly([a,a]);case"Some":return lp(c.value,a=>[a,a])}})),vg=((a,b,c)=>({...bt,commit(){return rU(this)},[rQ]:rR,id:()=>aa(a.id(),is(b.id())),await:aa(a.await,le,uI(le(b.await),c,{concurrent:!0}),k4),children:a.children,inheritAll:lO(b.inheritAll,a.inheritAll),poll:lP(a.poll,b.poll,(a,b)=>aa(a,eu(a=>aa(b,et(b=>na(a,b,{onSuccess:c,onFailure:j4})))))),interruptAsFork:c=>lO(a.interruptAsFork(c),b.interruptAsFork(c)),pipe(){return a7(this,arguments)}}),Symbol.for("effect/ScheduleInterval")),vh={[vg]:vg,startMillis:0,endMillis:0},vi=(a,b)=>a>b?vh:{[vg]:vg,startMillis:a,endMillis:b},vj=W(2,(a,b)=>vk(a,b)===a),vk=W(2,(a,b)=>a.endMillis<=b.startMillis?a:b.endMillis<=a.startMillis?b:a.startMillis<b.startMillis?a:b.startMillis<a.startMillis?b:a.endMillis<=b.endMillis?a:b),vl=W(2,(a,b)=>vi(Math.max(a.startMillis,b.startMillis),Math.min(a.endMillis,b.endMillis))),vm=a=>a.startMillis>=a.endMillis,vn=a=>vi(a,1/0),vo=Symbol.for("effect/ScheduleIntervals"),vp=a=>({[vo]:vo,intervals:a}),vq=W(2,(a,b)=>gg(b.intervals)?gg(a.intervals)?gi(a.intervals).startMillis<gi(b.intervals).startMillis?vr(gn(a.intervals),b.intervals,gi(a.intervals),fV()):vr(a.intervals,gn(b.intervals),gi(b.intervals),fV()):b:a),vr=(a,b,c,d)=>{let e=a,f=b,g=c,h=d;for(;gg(e)||gg(f);)if(!gg(e)&&gg(f))g.endMillis<gi(f).startMillis?(h=aa(h,f5(g)),g=gi(f)):g=vi(g.startMillis,gi(f).endMillis),f=gn(f),e=fV();else if(gg(e)&&gf(f))g.endMillis<gi(e).startMillis?(h=aa(h,f5(g)),g=gi(e)):g=vi(g.startMillis,gi(e).endMillis),f=fV(),e=gn(e);else if(gg(e)&&gg(f))gi(e).startMillis<gi(f).startMillis?(g.endMillis<gi(e).startMillis?(h=aa(h,f5(g)),g=gi(e)):g=vi(g.startMillis,gi(e).endMillis),e=gn(e)):(g.endMillis<gi(f).startMillis?(h=aa(h,f5(g)),g=gi(f)):g=vi(g.startMillis,gi(f).endMillis),f=gn(f));else throw Error(ax("Intervals.unionLoop"));return vp(aa(h,f5(g),f_))},vs=W(2,(a,b)=>vt(a.intervals,b.intervals,fV())),vt=(a,b,c)=>{let d=a,e=b,f=c;for(;gg(d)&&gg(e);){let a=aa(gi(d),vl(gi(e))),b=vm(a)?f:aa(f,f5(a));aa(gi(d),vj(gi(e)))?d=gn(d):e=gn(e),f=b}return vp(f_(f))},vu=a=>aa(a.intervals,gh,el(()=>vh)).startMillis,vv=W(2,(a,b)=>vu(a)<vu(b)),vw=((a,b)=>vv(a,b)?b:a,a=>aa(a.intervals,gh,el(()=>vh)).endMillis),vx="Continue",vy="Done",vz=a=>({_tag:vx,intervals:a}),vA=a=>({_tag:vx,intervals:vp(fX(a))}),vB={_tag:vy},vC=Symbol.for("effect/ManagedRuntime"),vD="Fresh",vE="ProvideMerge",vF=a=>function(){if(1==arguments.length){let b=arguments[0];return(c,...d)=>a(b,c,...d)}return a.apply(this,arguments)},vG=vF((a,b,c)=>{let d=iA(),e=[[mg,[[d,a.context]]]];c?.scheduler&&e.push([rg,[[d,c.scheduler]]]);let f=o5(a.fiberRefs,{entries:e,forkAs:d});c?.updateRefs&&(f=c.updateRefs(f,d));let g=new uc(d,f,a.runtimeFlags),h=b;c?.scope&&(h=lb(mC(c.scope,qZ),a=>lO(mz(a,la(a=>aV(a,g.id())?lF:lS(g,a))),ls(b,b=>mB(a,b)))));let i=g.currentSupervisor;return i!==tQ&&(i.onStart(a.context,h,ej(),g),g.addObserver(a=>i.onEnd(a,g))),rP.add(a.runtimeFlags,g),c?.immediate===!1?g.resume(h):g.start(h),g}),vH=vF((a,b,c={})=>{let d=vG(a,b,c);return c.onExit&&d.addObserver(a=>{c.onExit(a)}),(b,c)=>vH(a)(aa(d,lS(b??ix)),{...c,onExit:c?.onExit?a=>c.onExit(aa(a,m0(X))):void 0})}),vI=vF((a,b)=>{let c=vP(a)(b);if("Failure"===c._tag)throw vN(c.effect_instruction_i0);return c.effect_instruction_i0});class vJ extends Error{constructor(a){super(`Fiber #${a.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this._tag="AsyncFiberException",this.fiber=a,this.name=this._tag,this.stack=this.message}}let vK=Symbol.for("effect/Runtime/FiberFailure"),vL=Symbol.for("effect/Runtime/FiberFailure/Cause");class vM extends Error{constructor(a){let b=kC(a)[0];super(b?.message||"An error has occurred"),this[vK]=vK,this[vL]=a,this.name=b?`(FiberFailure) ${b.name}`:"FiberFailure",b?.stack&&(this.stack=b.stack)}toJSON(){return{_id:"FiberFailure",cause:this[vL].toJSON()}}toString(){return"(FiberFailure) "+ku(this[vL],{renderErrorCause:!0})}[aY](){return this.toString()}}let vN=a=>{let b=Error.stackTraceLimit;Error.stackTraceLimit=0;let c=new vM(a);return Error.stackTraceLimit=b,c},vO=a=>{switch(a._op){case"Failure":case"Success":return a;case"Left":return m$(a.left);case"Right":return m6(a.right);case"Some":return m6(a.value);case"None":return m$(mO())}},vP=vF((a,b)=>{let c=vO(b);if(c)return c;let d=new rf,e=vG(a)(b,{scheduler:d});d.flush();let f=e.unsafePoll();return f||mZ(k0((a=>{let b=Error.stackTraceLimit;Error.stackTraceLimit=0;let c=new vJ(a);return Error.stackTraceLimit=b,c})(e),ns(e)))}),vQ=vF((a,b,c)=>vR(a,b,c).then(a=>{switch(a._tag){case be:return a.effect_instruction_i0;case ba:throw vN(a.effect_instruction_i0)}})),vR=vF((a,b,c)=>new Promise(d=>{let e=vO(b);e&&d(e);let f=vG(a)(b);f.addObserver(a=>{d(a)}),c?.signal!==void 0&&(c.signal.aborted?f.unsafeInterruptAsFork(f.id()):c.signal.addEventListener("abort",()=>{f.unsafeInterruptAsFork(f.id())},{once:!0}))}));class vS{constructor(a,b,c){this.context=a,this.runtimeFlags=b,this.fiberRefs=c}pipe(){return a7(this,arguments)}}let vT=a=>new vS(a.context,a.runtimeFlags,a.fiberRefs),vU=()=>kQ((a,b)=>ly(new vS(a.getFiberRef(mg),b.runtimeFlags,a.getFiberRefs()))),vV=vT({context:bQ,runtimeFlags:jM(1,32,4),fiberRefs:oW()}),vW=((a,b)=>vT({context:a.context,runtimeFlags:b(a.runtimeFlags),fiberRefs:a.fiberRefs}),vG(vV)),vX=vQ(vV),vY=vR(vV),vZ=vI(vV),v$=vP(vV),v_=W(2,(a,b)=>a.modifyEffect(b)),v0=Symbol.for("effect/Layer"),v1={[v0]:{_RIn:a=>a,_E:a=>a,_ROut:a=>a},pipe(){return a7(this,arguments)}},v2=Symbol.for("effect/Layer/MemoMap"),v3=b_()("effect/Layer/CurrentMemoMap",{defaultValue:()=>v6()});class v4{constructor(a){this.ref=a,this[v2]=v2}getOrElseMemoize(a,b){return aa(v_(this.ref,c=>{let d=c.get(a);if(void 0!==d){let[a,e]=d;return ly([aa(a,lb(([a,b])=>aa(pT(a),kS(b))),ls(m4({onFailure:()=>lF,onSuccess:()=>mA(b,e)}))),c])}return aa(pf(0),lb(d=>aa(nd(),lb(e=>aa(pf(()=>lF),lp(f=>{let g=lE(g=>aa(uN(),lb(h=>aa(g(lb(v9(a,h,!0),a=>pY(a(this),pJ,pq))),k4,lb(g=>{switch(g._tag){case ba:return aa(ni(e,g.effect_instruction_i0),lO(mB(h,g)),lO(k7(g.effect_instruction_i0)));case be:return aa(pg(f,a=>aa(mB(h,a),lH(pi(d,a=>[1===a,a-1])),kT)),lO(pj(d,a=>a+1)),lO(mA(b,b=>aa(lA(()=>c.delete(a)),lO(f.get),lb(a=>a(b))))),lO(nk(e,g.effect_instruction_i0)),kS(g.effect_instruction_i0[1]))}}))))),h=[aa(nf(e),ls(m5({onFailure:()=>lF,onSuccess:()=>pj(d,a=>a+1)}))),a=>aa(f.get,lb(b=>b(a)))];return[g,a._op_layer===vD?c:c.set(a,h)]}))))))}),le)}}let v5=lz(()=>lp(vd(new Map),a=>new v4(a))),v6=()=>new v4(ve(new Map)),v7=W(2,(a,b)=>lb(v5,c=>v8(a,c,b))),v8=W(3,(a,b,c)=>lb(v9(a,c),a=>pU(a(b),v3,b))),v9=(a,b,c=!1)=>{switch(a._op_layer){case"Locally":return lA(()=>c=>a.f(c.getOrElseMemoize(a.self,b)));case"ExtendScope":return lA(()=>b=>uC(c=>b.getOrElseMemoize(a.layer,c)));case"Fold":return lA(()=>c=>aa(c.getOrElseMemoize(a.layer,b),lg({onFailure:d=>c.getOrElseMemoize(a.failureK(d),b),onSuccess:d=>c.getOrElseMemoize(a.successK(d),b)})));case"Fresh":return lA(()=>c=>aa(a.layer,v7(b)));case"FromEffect":return c?lA(()=>b=>a.effect):lA(()=>c=>c.getOrElseMemoize(a,b));case"Provide":return lA(()=>c=>aa(c.getOrElseMemoize(a.first,b),lb(d=>aa(c.getOrElseMemoize(a.second,b),np(d)))));case"Scoped":return c?lA(()=>c=>uO(a.effect,b)):lA(()=>c=>c.getOrElseMemoize(a,b));case"Suspend":return lA(()=>c=>c.getOrElseMemoize(a.evaluate(),b));case"ProvideMerge":return lA(()=>c=>aa(c.getOrElseMemoize(a.first,b),lP(c.getOrElseMemoize(a.second,b),a.zipK)));case"ZipWith":return lA(()=>c=>aa(c.getOrElseMemoize(a.first,b),uI(c.getOrElseMemoize(a.second,b),a.zipK,{concurrent:!0})))}},wa=W(2,(a,b)=>wi(a,{onFailure:b,onSuccess:wp})),wb=((a,b)=>wh(a,{onFailure:b,onSuccess:wp}),()=>wg(nn)),wc=a=>wd(j1(a)),wd=a=>wg(k7(a)),we=W(2,(a,b)=>wi(a,{onFailure:wc,onSuccess:b})),wf=W(2,(a,b)=>{let c=bZ(a),d=c?a:b;return wg(lp(c?b:a,a=>bR(d,a)))});function wg(a){let b=Object.create(v1);return b._op_layer="FromEffect",b.effect=a,b}(a,b)=>{let c=Object.create(v1);return c._op_layer="Locally",c.self=a,c.f=b,c};(a,b)=>we(a,a=>wp(b(a)));let wh=W(2,(a,{onFailure:b,onSuccess:c})=>{let d=Object.create(v1);return d._op_layer="Fold",d.layer=a,d.failureK=b,d.successK=c,d}),wi=W(2,(a,{onFailure:b,onSuccess:c})=>wh(a,{onFailure:a=>{let c=kd(a);switch(c._tag){case"Left":return b(c.left);case"Right":return wd(c.right)}},onSuccess:c})),wj=W(2,(a,b)=>wu(a,b,(a,b)=>bX(a,b))),wk=(...a)=>{let b=a[0];for(let c=1;c<a.length;c++)b=wj(b,a[c]);return b},wl=W(2,(a,b)=>{let c=bZ(a),d=c?a:b;return wn(lp(c?b:a,a=>bR(d,a)))}),wm=a=>wn(aa(a,kS(bQ))),wn=a=>{let b=Object.create(v1);return b._op_layer="Scoped",b.effect=a,b},wo=W(2,(a,b)=>{let c=bZ(a);return wg(ly(bR(c?a:b,c?b:a)))}),wp=a=>wg(ly(a)),wq=a=>{let b=Object.create(v1);return b._op_layer="Suspend",b.evaluate=a,b},wr=W(2,(a,b)=>lb(uC(c=>v8(a,b,c)),a=>aa(vU(),np(a)))),ws=W(2,(a,b)=>wq(()=>{let c=Object.create(v1);return c._op_layer="Provide",c.first=Object.create(v1,{_op_layer:{value:vE,enumerable:!0},first:{value:wb(),enumerable:!0},second:{value:Array.isArray(b)?wk(...b):b},zipK:{value:(a,b)=>aa(a,bX(b))}}),c.second=a,c})),wt=W(2,(a,b)=>{let c=Object.create(v1);return c._op_layer=vE,c.first=b,c.second=ws(a,b),c.zipK=(a,b)=>aa(a,bX(b)),c}),wu=W(3,(a,b,c)=>wq(()=>{let d=Object.create(v1);return d._op_layer="ZipWith",d.first=a,d.second=b,d.zipK=c,d})),wv=a=>{let b=bY("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return we(wf(b,a),a=>bV(a,b))},ww=W(2,(a,b)=>uD(c=>lb(v7(b,c),b=>nq(a,b)))),wx=W(2,(a,b)=>{let c=pq(vV.fiberRefs,b.fiberRefs),d=jQ(vV.runtimeFlags,b.runtimeFlags);return lE(e=>kQ(f=>{let g=f.getFiberRef(mg),h=f.getFiberRefs(),i=ps(f.id(),h)(c),j=f.currentRuntimeFlags,k=jR(d)(j),l=pq(i,h),m=jQ(k,j);return f.setFiberRefs(i),f.currentRuntimeFlags=k,uY(nq(e(a),bX(g,b.context)),kQ(a=>(a.setFiberRefs(ps(a.id(),a.getFiberRefs())(l)),a.currentRuntimeFlags=jR(m)(a.currentRuntimeFlags),lF)))}))}),wy=W(2,(a,b)=>{if(Array.isArray(b))return ww(a,wk(...b));return ap(b,v0)?ww(a,b):bP(b)?nq(a,b):vC in b?lb(b.runtimeEffect,b=>wx(a,b)):wx(a,b)});class wz{constructor(a,b=!1){this.s=a,this.stripped=b,this.index=0,this.length=a.length}next(){if(this.done)return{done:!0,value:void 0};let a=this.index;for(;!this.done&&!wA(this.s[this.index]);)this.index=this.index+1;let b=this.index;if(!this.done){let a=this.s[this.index];this.index=this.index+1,!this.done&&wB(a,this.s[this.index])&&(this.index=this.index+1),this.stripped||(b=this.index)}return{done:!1,value:this.s.substring(a,b)}}[Symbol.iterator](){return new wz(this.s,this.stripped)}get done(){return this.index>=this.length}}let wA=a=>{let b=a.charCodeAt(0);return 13===b||10===b},wB=(a,b)=>13===a.charCodeAt(0)&&10===b.charCodeAt(0),wC=((a,b)=>wD(a.seconds,b.seconds)&&wD(a.minutes,b.minutes)&&wD(a.hours,b.hours)&&wD(a.days,b.days)&&wD(a.months,b.months)&&wD(a.weekdays,b.weekdays),dS(dP)),wD=(a,b)=>wC(eO(a),eO(b)),wE=Symbol.for("effect/Schedule"),wF=a=>ap(a,wE),wG=Symbol.for("effect/ScheduleDriver"),wH={start:0,now:0,input:void 0,elapsed:gV,elapsedSincePrevious:gV,recurrence:0},wI=b_()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>wH}),wJ={_Out:a=>a,_In:a=>a,_R:a=>a},wK={_Out:a=>a,_In:a=>a,_R:a=>a};class wL{constructor(a,b){this[wE]=wJ,this.initial=a,this.step=b}pipe(){return a7(this,arguments)}}let wM=(a,b,c)=>pj(a,a=>0===a.recurrence?{now:b,input:c,recurrence:a.recurrence+1,elapsed:gV,elapsedSincePrevious:gV,start:b}:{now:b,input:c,recurrence:a.recurrence+1,elapsed:gZ(b-a.start),elapsedSincePrevious:gZ(b-a.now),start:a.start});class wN{constructor(a,b){this[wG]=wK,this.iterationMeta=pe(wH),this.schedule=a,this.ref=b}get state(){return lp(this.ref.get,a=>a[1])}get last(){return lb(this.ref.get,([a,b])=>{switch(a._tag){case"None":return k6(()=>new mO);case"Some":return ly(a.value)}})}get reset(){return pg(this.ref,[ej(),this.schedule.initial]).pipe(lN(pg(this.iterationMeta,wH)))}next(a){return aa(lp(this.ref.get,a=>a[1]),lb(b=>aa(oB,lb(c=>aa(lz(()=>this.schedule.step(c,a,b)),lb(([b,d,e])=>{let f=pg(this.ref,[bG(d),b]);if(e._tag===vy)return f.pipe(lO(k5(ej())));let g=vu(e.intervals)-c;if(g<=0)return f.pipe(lO(wM(this.iterationMeta,c,a)),kS(d));let h=gZ(g);return aa(f,lO(wM(this.iterationMeta,c,a)),lO(oV(h)),kS(d))}))))))}}let wO=(a,b)=>new wL(a,b),wP=((a,b)=>wP(a,a=>lA(()=>b(a))),W(2,(a,b)=>wZ(a,(a,c)=>lp(b(a),a=>g8(c,gP(a)))))),wQ=((a,b)=>wO([a.initial,b.initial,!0],(c,d,e)=>e[2]?lb(a.step(c,d,e[0]),([a,f,g])=>g._tag===vy?lp(b.step(c,d,e[1]),([b,c,d])=>[[a,b,!1],dt(c),d]):ly([[a,e[1],!0],ds(f),g])):lp(b.step(c,d,e[1]),([a,b,c])=>[[e[0],a,!1],dt(b),c])),W(2,(a,b)=>wR(a,(a,c)=>lA(()=>b(a,c))))),wR=W(2,(a,b)=>wO(a.initial,(c,d,e)=>lb(a.step(c,d,e),([a,c,e])=>e._tag===vy?ly([a,c,vB]):lp(b(d,c),b=>b?[a,c,e]:[a,c,vB])))),wS=((a,b)=>wS(a,a=>lA(()=>b(a))),W(2,(a,b)=>wO(a.initial,(c,d,e)=>lb(b(d),b=>a.step(c,b,e))))),wT=((a,b)=>wZ(a,(a,c)=>b(c)),a=>aa(pf([ej(),a.initial]),lp(b=>new wN(a,b)))),wU=W(2,(a,b)=>wV(a,b,vs)),wV=W(3,(a,b,c)=>wO([a.initial,b.initial],(d,e,f)=>aa(lP(a.step(d,e,f[0]),b.step(d,e,f[1]),(a,b)=>[a,b]),lb(([[d,f,g],[h,i,j]])=>g._tag===vx&&j._tag===vx?wW(a,b,e,d,f,g.intervals,h,i,j.intervals,c):ly([[d,h],[f,i],vB]))))),wW=(a,b,c,d,e,f,g,h,i,j)=>{let k=j(f,i);return gg(k.intervals)?ly([[d,g],[e,h],vz(k)]):aa(f,vv(i))?lb(a.step(vw(f),c,d),([d,e,f])=>f._tag===vy?ly([[d,g],[e,h],vB]):wW(a,b,c,d,e,f.intervals,g,h,i,j)):lb(b.step(vw(i),c,g),([g,h,i])=>i._tag===vy?ly([[d,g],[e,h],vB]):wW(a,b,c,d,e,f,g,h,i.intervals,j))},wX=W(2,(a,b)=>wY(a,a=>lA(()=>b(a)))),wY=W(2,(a,b)=>wO(a.initial,(c,d,e)=>lb(a.step(c,d,e),([a,c,d])=>lp(b(c),b=>[a,b,d])))),wZ=W(2,(a,b)=>wO(a.initial,(c,d,e)=>lb(a.step(c,d,e),([a,d,e])=>{if(e._tag===vy)return ly([a,d,e]);let f=e.intervals;return lp(b(d,(a=>gZ(a.endMillis-a.startMillis))(vi(c,vu(f)))),b=>{let e=gP(b),g=vu(f),h=c+g3(e),i=h-g;return[a,d,vA(vi(h,Math.max(0,vw(f)+i)))]})}))),w$=a=>w2(xi,b=>b<a),w_=((a,b,c)=>wO([a.initial,b],(b,d,[e,f])=>lb(a.step(b,d,e),([a,b,d])=>d._tag===vy?ly([[a,f],f,d]):lp(c(f,b),b=>[[a,b],f,d]))),W(3,(a,b,c)=>wO([a.initial,b.initial],(d,e,f)=>lP(a.step(d,e,f[0]),b.step(d,e,f[1]),([a,b,d],[e,f,g])=>{if(d._tag===vy&&g._tag===vy)return[[a,e],[b,f],vB];if(d._tag===vy&&g._tag===vx)return[[a,e],[b,f],vz(g.intervals)];if(d._tag===vx&&g._tag===vy)return[[a,e],[b,f],vz(d.intervals)];if(d._tag===vx&&g._tag===vx)return[[a,e],[b,f],vz(c(d.intervals,g.intervals))];throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")})))),w0=W(2,(a,b)=>wR(a,(a,c)=>lp(b(a),a=>!a))),w1=W(2,(a,b)=>wR(a,(a,c)=>b(a))),w2=W(2,(a,b)=>wQ(a,(a,c)=>b(c))),w3=((a,b)=>wX(wU(a,b),a=>a[0]),Symbol.for("effect/Schedule/ScheduleDefect"));class w4{constructor(a){this.error=a,this[w3]=w3}}let w5=a=>kZ(a,a=>k1(new w4(a))),w6=a=>ek(km(a,a=>"Die"===a._tag&&ap(a.defect,w3)?bG(a.defect):ej()),{onNone:()=>a,onSome:a=>j1(a.error)}),w7=a=>kY(a,a=>k7(w6(a))),w8=W(2,(a,b)=>xa(a,b,(a,b)=>k5(a))),w9=W(2,(a,b)=>{if(wF(b))return w8(a,b);let c=b.schedule??(a=>wO(a.initial,(b,c,d)=>aa(a.step(b,c,d),lp(([a,b,d])=>[a,c,d]))))(xi),d=b.while?w1(c,a=>{let c=b.while(a);return"boolean"==typeof c?ly(c):w5(c)}):c,e=b.until?w0(d,a=>{let c=b.until(a);return"boolean"==typeof c?ly(c):w5(c)}):d;return w7(w8(a,b.times?wU(e,w$(b.times)).pipe(wX(a=>a[0])):e))}),xa=W(3,(a,b,c)=>lb(wT(b),b=>lh(a,{onFailure:a=>c(a,ej()),onSuccess:d=>xb(pV(a,wI,b.iterationMeta.get),b,(a,d)=>pV(c(a,d),wI,b.iterationMeta.get),d)}))),xb=(a,b,c,d)=>lh(b.next(d),{onFailure:()=>lv(b.last),onSuccess:d=>lh(a,{onFailure:a=>c(a,bG(d)),onSuccess:d=>xb(a,b,c,d)})}),xc=W(2,(a,b)=>xe(a,b,(a,b)=>k5(a))),xd=((a,b)=>wF(b)?xc(a,b):w7(xc(a,xd(b))),a=>{let b=a.schedule??xi,c=a.while?w1(b,b=>{let c=a.while(b);return"boolean"==typeof c?ly(c):w5(c)}):b,d=a.until?w0(c,b=>{let c=a.until(b);return"boolean"==typeof c?ly(c):w5(c)}):c;return a.times?wU(d,w$(a.times)):d}),xe=W(3,(a,b,c)=>lb(wT(b),b=>xf(pV(a,wI,b.iterationMeta.get),b,(a,d)=>pV(c(a,d),wI,b.iterationMeta.get)))),xf=(a,b,c)=>kZ(a,d=>lh(b.next(d),{onFailure:()=>aa(b.last,lv,lb(a=>c(d,a))),onSuccess:()=>xf(a,b,c)})),xg=((a,b)=>xg(a,void 0,b),W(3,(a,b,c)=>lb(wT(c),c=>xh(pV(a,wI,c.iterationMeta.get),b,c)))),xh=(a,b,c)=>lh(c.next(b),{onFailure:()=>lv(c.last),onSuccess:()=>lb(a,b=>xh(a,b,c))}),xi=(u=a=>a+1,wO(0,(a,b,c)=>lA(()=>[u(c),c,vA(vn(a))]))),xj=wX(w$(1),_),xk=Symbol.for("effect/MutableList"),xl={[xk]:xk,[Symbol.iterator](){let a=!1,b=this.head;return{next(){if(a)return this.return();if(null==b)return a=!0,this.return();let c=b.value;return b=b.next,{done:a,value:c}},return:b=>(a||(a=!0),{done:!0,value:b})}},toString(){return a$(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(aZ)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},xm=a=>0===xn(a),xn=a=>a._length,xo=W(2,(a,b)=>{let c={value:b,removed:!1,prev:void 0,next:void 0};return void 0===a.head&&(a.head=c),void 0===a.tail||(a.tail.next=c,c.prev=a.tail),a.tail=c,a._length+=1,a}),xp=Symbol.for("effect/MutableQueue"),xq=Symbol.for("effect/mutable/MutableQueue/Empty"),xr={[xp]:xp,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return a$(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(aZ)}},[aY](){return this.toJSON()},pipe(){return a7(this,arguments)}},xs=a=>{let b=Object.create(xr);return b.queue=(()=>{let a=Object.create(xl);return a.head=void 0,a.tail=void 0,a._length=0,a})(),b.capacity=a,b},xt=a=>xs(a),xu=()=>xs(void 0),xv=a=>xn(a.queue),xw=a=>xm(a.queue),xx=W(2,(a,b)=>{let c=xn(a.queue);return(void 0===a.capacity||c!==a.capacity)&&(xo(b)(a.queue),!0)}),xy=W(2,(a,b)=>{let c,d=b[Symbol.iterator](),e=fV(),f=!0;for(;f&&(c=d.next())&&!c.done;)f=xx(c.value)(a);for(;null!=c&&!c.done;)e=f5(c.value)(e),c=d.next();return f_(e)}),xz=W(2,(a,b)=>xm(a.queue)?b:(a=>{let b=a.head;if(void 0!==b)return((a,b)=>{!b.removed&&(b.removed=!0,void 0!==b.prev&&void 0!==b.next?(b.prev.next=b.next,b.next.prev=b.prev):void 0!==b.prev?(a.tail=b.prev,b.prev.next=void 0):void 0!==b.next?(a.head=b.next,b.next.prev=void 0):(a.tail=void 0,a.head=void 0),a._length>0&&(a._length-=1))})(a,b),b.value})(a.queue)),xA=W(2,(a,b)=>{let c=fV(),d=0;for(;d<b;){let b=xz(xq)(a);if(b===xq)break;c=f5(b)(c),d+=1}return f_(c)}),xB=(a,b,c,d)=>iU({_tag:"Complete",key:a,exit:b,entryStats:c,timeToLiveMillis:d}),xC=(a,b)=>iU({_tag:"Pending",key:a,deferred:b}),xD=Symbol.for("effect/Cache/MapKey");class xE{constructor(a){this[xD]=xD,this.previous=void 0,this.next=void 0,this.current=a}[aJ](){return aa(aK(this.current),aM(aK(this.previous)),aM(aK(this.next)),aT(this))}[aU](a){return this===a||xG(a)&&aV(this.current,a.current)&&aV(this.previous,a.previous)&&aV(this.next,a.next)}}let xF=a=>new xE(a),xG=a=>ap(a,xD);class xH{add(a){if(a!==this.tail)if(void 0===this.tail)this.head=a,this.tail=a;else{let b=a.previous,c=a.next;void 0!==c&&(a.next=void 0,void 0!==b?(b.next=c,c.previous=b):(this.head=c,this.head.previous=void 0)),this.tail.next=a,a.previous=this.tail,this.tail=a}}remove(){let a=this.head;if(void 0!==a){let b=a.next;void 0!==b?(a.next=void 0,this.head=b,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return a}constructor(){this.head=void 0,this.tail=void 0}}let xI=Symbol.for("effect/Cache"),xJ={_Key:a=>a,_Error:a=>a,_Value:a=>a},xK=Symbol.for("effect/ConsumerCache"),xL={_Key:a=>a,_Error:a=>a,_Value:a=>a},xM=a=>({loadedMillis:a});class xN{constructor(a,b,c,d,e){this[xI]=xJ,this[xK]=xL,this.capacity=a,this.context=b,this.fiberId=c,this.lookup=d,this.timeToLive=e,this.cacheState=(()=>{let a,b;return a=sP(),b=new xH,{map:a,keys:b,accesses:xu(),updating:ia(!1),hits:0,misses:0}})()}get(a){return lp(this.getEither(a),dz)}get cacheStats(){return lA(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:sW(this.cacheState.map)}))}getOption(a){return lz(()=>ek(sQ(this.cacheState.map,a),{onNone:()=>{let b=xF(a);return this.trackAccess(b),this.trackMiss(),ly(ej())},onSome:a=>this.resolveMapValue(a)}))}getOptionComplete(a){return lz(()=>ek(sQ(this.cacheState.map,a),{onNone:()=>{let b=xF(a);return this.trackAccess(b),this.trackMiss(),ly(ej())},onSome:a=>this.resolveMapValue(a,!0)}))}contains(a){return lA(()=>sS(this.cacheState.map,a))}entryStats(a){return lA(()=>{let b=sQ(this.cacheState.map,a);if(bE(b))switch(b.value._tag){case"Complete":return bG(xM(b.value.entryStats.loadedMillis));case"Pending":break;case"Refreshing":return bG(xM(b.value.complete.entryStats.loadedMillis))}return ej()})}getEither(a){return lz(()=>{let b,c,d=ep(sQ(this.cacheState.map,a));return(void 0===d&&(c=nc(this.fiberId),b=xF(a),sS(this.cacheState.map,a)?d=ep(sQ(this.cacheState.map,a)):sT(this.cacheState.map,a,xC(b,c))),void 0===d)?(this.trackAccess(b),this.trackMiss(),lp(this.lookupValueOf(a,c),dt)):lb(this.resolveMapValue(d),ek({onNone:()=>this.getEither(a),onSome:a=>ly(ds(a))}))})}invalidate(a){return lA(()=>{sV(this.cacheState.map,a)})}invalidateWhen(a,b){return lA(()=>{let c=sQ(this.cacheState.map,a);bE(c)&&"Complete"===c.value._tag&&"Success"===c.value.exit._tag&&b(c.value.exit.value)&&sV(this.cacheState.map,a)})}get invalidateAll(){return lA(()=>{this.cacheState.map=sP()})}refresh(a){return oA(b=>lz(()=>{let c=nc(this.fiberId),d=ep(sQ(this.cacheState.map,a));if(void 0===d&&(sS(this.cacheState.map,a)?d=ep(sQ(this.cacheState.map,a)):sT(this.cacheState.map,a,xC(xF(a),c))),void 0===d)return kT(this.lookupValueOf(a,c));switch(d._tag){case"Complete":if(this.hasExpired(b,d.timeToLiveMillis))return aV(ep(sQ(this.cacheState.map,a)),d)&&sV(this.cacheState.map,a),kT(this.get(a));return aa(this.lookupValueOf(a,c),p3(()=>{if(aV(ep(sQ(this.cacheState.map,a)),d)){let b=iU({_tag:"Refreshing",deferred:c,complete:d});return sT(this.cacheState.map,a,b),!0}return!1}),kT);case"Pending":case"Refreshing":return nf(d.deferred)}}))}set(a,b){return oA(c=>lA(()=>{let d=c.unsafeCurrentTimeMillis(),e=m6(b),f=xB(xF(a),e,xM(d),d+g3(gP(this.timeToLive(e))));sT(this.cacheState.map,a,f)}))}get size(){return lA(()=>sW(this.cacheState.map))}get values(){return lA(()=>{let a=[];for(let b of this.cacheState.map)"Complete"===b[1]._tag&&"Success"===b[1].exit._tag&&a.push(b[1].exit.value);return a})}get entries(){return lA(()=>{let a=[];for(let b of this.cacheState.map)"Complete"===b[1]._tag&&"Success"===b[1].exit._tag&&a.push([b[0],b[1].exit.value]);return a})}get keys(){return lA(()=>{let a=[];for(let b of this.cacheState.map)"Complete"===b[1]._tag&&"Success"===b[1].exit._tag&&a.push(b[0]);return a})}resolveMapValue(a,b=!1){return oA(c=>{switch(a._tag){case"Complete":if(this.trackAccess(a.key),this.hasExpired(c,a.timeToLiveMillis))return sV(this.cacheState.map,a.key.current),ly(ej());return this.trackHit(),lp(a.exit,bG);case"Pending":if(this.trackAccess(a.key),this.trackHit(),b)return ly(ej());return lp(nf(a.deferred),bG);case"Refreshing":if(this.trackAccess(a.complete.key),this.trackHit(),this.hasExpired(c,a.complete.timeToLiveMillis)){if(b)return ly(ej());return lp(nf(a.deferred),bG)}return lp(a.complete.exit,bG)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(a){if(xx(this.cacheState.accesses,a),ib(this.cacheState.updating,!1,!0)){let a=!0;for(;a;){let b=xz(this.cacheState.accesses,xq);b===xq?a=!1:this.cacheState.keys.add(b)}let b=sW(this.cacheState.map);for(a=b>this.capacity;a;){let c=this.cacheState.keys.remove();void 0!==c?sS(this.cacheState.map,c.current)&&(sV(this.cacheState.map,c.current),b-=1,a=b>this.capacity):a=!1}ic(this.cacheState.updating,!1)}}hasExpired(a,b){return a.unsafeCurrentTimeMillis()>b}lookupValueOf(a,b){return oA(c=>lz(()=>aa(this.lookup(a),np(this.context),k4,lb(d=>{let e=c.unsafeCurrentTimeMillis(),f=xM(e),g=xB(xF(a),d,f,e+g3(gP(this.timeToLive(d))));return sT(this.cacheState.map,a,g),lO(nh(b,d),d)}),lt(()=>lO(lb(k9,a=>ng(b,lm(a))),lA(()=>{sV(this.cacheState.map,a)}))))))}}()=>{let a,b;return md((a=()=>lp(nd(),a=>({listeners:new tH,handle:a})),b=()=>g$(60),new xN(65536,bQ,io,a,a=>gP(b(a)))))},()=>md(!1);let xO=a=>aa(nd(),lb(b=>aa(pY(a,lM(pJ,lx),([a,b],[c,d])=>[pq(a,c),jQ(b,d)]),lo(b),pS,lp(a=>lO(a,aa(nf(b),lb(([a,b])=>kS(lM(pT(a[0]),lG(a[1])),b)))))))),xP=function(){let a=1==arguments.length?arguments[0]:arguments[1].bind(arguments[0]);return lJ(()=>a(aa))},xQ=a=>a.length>=1?kX((b,c)=>{try{a(c).then(a=>b(m6(a)),a=>b(mZ(a)))}catch(a){b(mZ(a))}}):kX(b=>{try{a().then(a=>b(m6(a)),a=>b(mZ(a)))}catch(a){b(mZ(a))}}),xR=a=>lg(a,{onFailure:a=>pM(a,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>lF}),xS=a=>lb(uN(),b=>uP(a,b)),xT=a=>lA(()=>u_(a)),xU=W(2,(a,b)=>uI(a,b,(a,b)=>a(b))),xV=function(){let a="string"!=typeof arguments[0],b=a?arguments[1]:arguments[0],c=ov(a?arguments[2]:arguments[1]);if(a){let a=arguments[0];return p6(b,c,b=>p7(a,b))}return a=>p6(b,c,b=>p7(a,b))},xW=function(a,...b){let c=Error.stackTraceLimit;Error.stackTraceLimit=2;let d=Error();if(Error.stackTraceLimit=c,"string"!=typeof a)return xX(a.length,function(...c){let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let f=Error();return Error.stackTraceLimit=e,xY({self:this,body:a,args:c,pipeables:b,spanName:"<anonymous>",spanOptions:{context:ow.context(!0)},errorDef:d,errorCall:f})});let e=b[0];return(b,...c)=>xX(b.length,{[a](...f){let g=Error.stackTraceLimit;Error.stackTraceLimit=2;let h=Error();return Error.stackTraceLimit=g,xY({self:this,body:b,args:f,pipeables:c,spanName:a,spanOptions:e,errorDef:d,errorCall:h})}}[a])};function xX(a,b){return Object.defineProperty(b,"length",{value:a,configurable:!0})}function xY(a){let b,c,d;if(ao(d=a.body)&&d.constructor===aH)b=lJ(()=>a.body.apply(a.self,a.args));else try{b=a.body.apply(a.self,a.args)}catch(a){c=a,b=k1(a)}if(a.pipeables.length>0)try{for(let c of a.pipeables)b=c(b,...a.args)}catch(a){b=c?k7(j5(j2(c),j2(a))):k1(a)}let e=!1,f=a.spanOptions&&"captureStackTrace"in a.spanOptions?a.spanOptions:{captureStackTrace:()=>{if(!1!==e)return e;if(a.errorCall.stack){let b=a.errorDef.stack.trim().split("\n"),c=a.errorCall.stack.trim().split("\n"),d=b.slice(2).join("\n").trim();d.includes("(")||(d=d.replace(/at (.*)/,"at ($1)"));let f=c.slice(2).join("\n").trim();return f.includes("(")||(f=f.replace(/at (.*)/,"at ($1)")),e=`${d}
${f}`}},...a.spanOptions};return xV(b,a.spanName,f)}let xZ=(a,b)=>{switch(b._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(a);case"SymbolKeyword":return Object.getOwnPropertySymbols(a);case"Refinement":return xZ(a,b.from)}},x$=a=>Object.keys(a).concat(Object.getOwnPropertySymbols(a)),x_=a=>{let b,c=!1;return()=>(c||(b=a(),c=!0),b)},x0=a=>{try{return a.toISOString()}catch{return String(a)}},x1=(a,b=!0)=>{if(Array.isArray(a))return`[${a.map(a=>x1(a,b)).join(",")}]`;if(at(a))return x0(a);if(ap(a,"toString")&&"function"==typeof a.toString&&a.toString!==Object.prototype.toString)return a.toString();if(ae(a))return JSON.stringify(a);if(af(a)||null==a||ag(a)||ai(a))return String(a);if(ah(a))return String(a)+"n";if(au(a))return`${a.constructor.name}(${x1(Array.from(a),b)})`;try{b&&JSON.stringify(a);let c=`{${x$(a).map(b=>`${ae(b)?JSON.stringify(b):String(b)}:${x1(a[b],!1)}`).join(",")}}`,d=a.constructor.name;return a.constructor!==Object.prototype.constructor?`${d}(${c})`:c}catch{return"<circular structure>"}},x2=a=>"string"==typeof a?JSON.stringify(a):String(a),x3=a=>Array.isArray(a),x4=a=>`[${x2(a)}]`,x5=a=>x3(a)?a.map(x4).join(""):x4(a),x6=(a,b,c,d)=>{let e=a;return c&&eW(c)&&(e+=`
at path: ${x5(c)}`),void 0!==b&&(e+=`
details: ${b}`),d&&(e+=`
schema (${d._tag}): ${d}`),e},x7=(a,b,c)=>x6("Unsupported schema or overlapping types",`cannot extend ${a} with ${b}`,c),x8=a=>x6("Duplicate index signature",`${a} index signature`),x9=x6("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),ya=x6("Invalid element","A required element cannot follow an optional element. ts(1257)"),yb=a=>x6("Duplicate property signature transformation",`Duplicate key ${x1(a)}`),yc=a=>x6("Duplicate property signature",`Duplicate key ${x1(a)}`),yd=Symbol.for("effect/SchemaId/DateFromSelf"),ye=Symbol.for("effect/SchemaId/GreaterThan"),yf=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),yg=Symbol.for("effect/SchemaId/LessThan"),yh=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),yi=Symbol.for("effect/SchemaId/Int"),yj=Symbol.for("effect/SchemaId/NonNaN"),yk=Symbol.for("effect/SchemaId/Finite"),yl=Symbol.for("effect/SchemaId/JsonNumber"),ym=Symbol.for("effect/SchemaId/Between"),yn=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),yo=Symbol.for("effect/SchemaId/BetweenBigint"),yp=Symbol.for("effect/SchemaId/MinLength"),yq=Symbol.for("effect/SchemaId/Length"),yr=Symbol.for("effect/annotation/Brand"),ys=Symbol.for("effect/annotation/SchemaId"),yt=Symbol.for("effect/annotation/Message"),yu=Symbol.for("effect/annotation/MissingMessage"),yv=Symbol.for("effect/annotation/Identifier"),yw=Symbol.for("effect/annotation/Title"),yx=Symbol.for("effect/annotation/AutoTitle"),yy=Symbol.for("effect/annotation/Description"),yz=Symbol.for("effect/annotation/Examples"),yA=Symbol.for("effect/annotation/Default"),yB=Symbol.for("effect/annotation/JSONSchema"),yC=Symbol.for("effect/annotation/Arbitrary"),yD=Symbol.for("effect/annotation/Pretty"),yE=Symbol.for("effect/annotation/Equivalence"),yF=Symbol.for("effect/annotation/Documentation"),yG=Symbol.for("effect/annotation/Concurrency"),yH=Symbol.for("effect/annotation/Batching"),yI=Symbol.for("effect/annotation/ParseIssueTitle"),yJ=Symbol.for("effect/annotation/ParseOptions"),yK=Symbol.for("effect/annotation/DecodingFallback"),yL=Symbol.for("effect/annotation/Surrogate"),yM=Symbol.for("effect/annotation/StableFilter"),yN=W(2,(a,b)=>Object.prototype.hasOwnProperty.call(a.annotations,b)?bG(a.annotations[b]):ej()),yO=yN(yr),yP=yN(yt),yQ=yN(yu),yR=yN(yw),yS=yN(yx),yT=yN(yv),yU=yN(yy),yV=yN(yG),yW=yN(yH),yX=yN(yI),yY=yN(yJ),yZ=yN(yK),y$=yN(yL),y_=yN(yM),y0=a=>ez(y_(a),a=>!0===a),y1=Symbol.for("effect/annotation/JSONIdentifier"),y2=yN(y1),y3=Symbol.for("effect/schema/ParseJson");class y4{constructor(a,b,c,d={}){this._tag="Declaration",this.typeParameters=a,this.decodeUnknown=b,this.encodeUnknown=c,this.annotations=d}toString(){return el(Am(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(a=>a.toJSON()),annotations:Ai(this.annotations)}}}let y5=a=>b=>b._tag===a;class y6{constructor(a,b={}){this._tag="Literal",this.literal=a,this.annotations=b}toString(){return el(Am(this),()=>x1(this.literal))}toJSON(){return{_tag:this._tag,literal:ah(this.literal)?String(this.literal):this.literal,annotations:Ai(this.annotations)}}}let y7=y5("Literal"),y8=new y6(null);class y9{constructor(a,b={}){this._tag="UniqueSymbol",this.symbol=a,this.annotations=b}toString(){return el(Am(this),()=>x1(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:Ai(this.annotations)}}}class za{constructor(a={}){this._tag="UndefinedKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zb=new za({[yw]:"undefined"});class zc{constructor(a={}){this._tag="VoidKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}class zd{constructor(a={}){this._tag="NeverKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let ze=new zd({[yw]:"never"});class zf{constructor(a={}){this._tag="UnknownKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zg=new zf({[yw]:"unknown"});class zh{constructor(a={}){this._tag="AnyKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zi=new zh({[yw]:"any"});class zj{constructor(a={}){this._tag="StringKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zk=new zj({[yw]:"string",[yy]:"a string"}),zl=y5("StringKeyword");class zm{constructor(a={}){this._tag="NumberKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zn=new zm({[yw]:"number",[yy]:"a number"}),zo=y5("NumberKeyword");class zp{constructor(a={}){this._tag="BooleanKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zq=new zp({[yw]:"boolean",[yy]:"a boolean"}),zr=y5("BooleanKeyword");class zs{constructor(a={}){this._tag="BigIntKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zt=new zs({[yw]:"bigint",[yy]:"a bigint"});class zu{constructor(a={}){this._tag="SymbolKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zv=new zu({[yw]:"symbol",[yy]:"a symbol"}),zw=y5("SymbolKeyword");class zx{constructor(a={}){this._tag="ObjectKeyword",this.annotations=a}toString(){return Ak(this)}toJSON(){return{_tag:this._tag,annotations:Ai(this.annotations)}}}let zy=a=>{switch(a._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return a.types.every(zy)}return!1},zz=a=>{switch(a._tag){case"Literal":return JSON.stringify(String(a.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(a);case"Union":return a.types.map(zz).join(" | ")}};class zA{constructor(a,b={}){this.type=a,this.annotations=b}toJSON(){return{type:this.type.toJSON(),annotations:Ai(this.annotations)}}toString(){return String(this.type)}}class zB extends zA{constructor(a,b,c={}){super(a,c),this.isOptional=b}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:Ai(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let zC=a=>a.map(a=>a.type);class zD{constructor(a,b,c,d={}){this._tag="TupleType",this.elements=a,this.rest=b,this.isReadonly=c,this.annotations=d;let e=!1,f=!1;for(let b of a)if(b.isOptional)e=!0;else if(e){f=!0;break}if(f||e&&b.length>1)throw Error(ya)}toString(){return el(Am(this),()=>zE(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(a=>a.toJSON()),rest:this.rest.map(a=>a.toJSON()),isReadonly:this.isReadonly,annotations:Ai(this.annotations)}}}let zE=a=>{let b=a.elements.map(String).join(", ");return eR(a.rest,{onEmpty:()=>`readonly [${b}]`,onNonEmpty:(c,d)=>{let e=String(c),f=e.includes(" | ")?`(${e})`:e;if(d.length>0){let c=d.map(String).join(", ");return a.elements.length>0?`readonly [${b}, ...${f}[], ${c}]`:`readonly [...${f}[], ${c}]`}return a.elements.length>0?`readonly [${b}, ...${f}[]]`:`ReadonlyArray<${e}>`}})};class zF extends zB{constructor(a,b,c,d,e){super(b,c,e),this.name=a,this.isReadonly=d}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:Ai(this.annotations)}}}let zG=a=>{switch(a._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return zG(a.from)}return!1};class zH{constructor(a,b,c){if(this.type=b,this.isReadonly=c,zG(a))this.parameter=a;else throw Error(x9)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class zI{constructor(a,b,c={}){this._tag="TypeLiteral",this.annotations=c;let d={};for(let b=0;b<a.length;b++){let c=a[b].name;if(Object.prototype.hasOwnProperty.call(d,c))throw Error(yc(c));d[c]=null}let e={string:!1,symbol:!1};for(let a=0;a<b.length;a++){let c=Aj(b[a].parameter);if(zl(c)){if(e.string)throw Error(x8("string"));e.string=!0}else if(zw(c)){if(e.symbol)throw Error(x8("symbol"));e.symbol=!0}}this.propertySignatures=a,this.indexSignatures=b}toString(){return el(Am(this),()=>zK(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(a=>a.toJSON()),indexSignatures:this.indexSignatures.map(a=>a.toJSON()),annotations:Ai(this.annotations)}}}let zJ=a=>a.map(String).join("; "),zK=a=>{if(a.propertySignatures.length>0){let b=a.propertySignatures.map(String).join("; ");return a.indexSignatures.length>0?`{ ${b}; ${zJ(a.indexSignatures)} }`:`{ ${b} }`}return a.indexSignatures.length>0?`{ ${zJ(a.indexSignatures)} }`:"{}"},zL=y5("TypeLiteral"),zM=e5(eE(eD,a=>{switch(a._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),zN={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},zO=a=>fg(a,a=>zR(a)?zO(a.types):[a]);class zP{static{this.make=(a,b)=>zQ(a)?new zP(a,b):1===a.length?a[0]:ze}static{this.unify=(a,b)=>zP.make((a=>{let b=zM(a),c=[],d={},e=[];for(let a of b)switch(a._tag){case"NeverKeyword":break;case"AnyKeyword":return[zi];case"UnknownKeyword":return[zg];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":d[a._tag]||(d[a._tag]=a,c.push(a));break;case"Literal":{let b=typeof a.literal;switch(b){case"string":case"number":case"bigint":case"boolean":d[zN[b]]||e.includes(a.literal)||(e.push(a.literal),c.push(a));break;case"object":e.includes(a.literal)||(e.push(a.literal),c.push(a))}break}case"UniqueSymbol":d.SymbolKeyword||e.includes(a.symbol)||(e.push(a.symbol),c.push(a));break;case"TupleType":d.ObjectKeyword||c.push(a);break;case"TypeLiteral":0===a.propertySignatures.length&&0===a.indexSignatures.length?d["{}"]||(d["{}"]=a,c.push(a)):d.ObjectKeyword||c.push(a);break;default:c.push(a)}return c})(zO(a)),b)}constructor(a,b={}){this._tag="Union",this.types=a,this.annotations=b}toString(){return el(Am(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(a=>a.toJSON()),annotations:Ai(this.annotations)}}}let zQ=a=>a.length>1,zR=y5("Union"),zS=ad(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class zT{constructor(a,b={}){this._tag="Suspend",this.f=a,this.annotations=b,this.f=x_(a)}toString(){return Am(this).pipe(em(()=>eu(eq(this.f)(),a=>Am(a))),el(()=>"<suspended schema>"))}toJSON(){let a=this.f(),b=zS.get(a);return b||(zS.set(a,{_tag:this._tag}),b={_tag:this._tag,ast:a.toJSON(),annotations:Ai(this.annotations)},zS.set(a,b)),b}}class zU{constructor(a,b,c={}){this._tag="Refinement",this.from=a,this.filter=b,this.annotations=c}toString(){return yT(this).pipe(el(()=>ek(Al(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:a=>zV(this.from)?String(this.from)+" & "+a:a})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:Ai(this.annotations)}}}let zV=y5("Refinement"),zW={};class zX{constructor(a,b,c,d={}){this._tag="Transformation",this.from=a,this.to=b,this.transformation=c,this.annotations=d}toString(){return el(Am(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:Ai(this.annotations)}}}let zY=y5("Transformation");class zZ{constructor(a,b){this._tag="FinalTransformation",this.decode=a,this.encode=b}}class z${constructor(){this._tag="ComposeTransformation"}}let z_=new z$;class z0{constructor(a,b,c,d){this.from=a,this.to=b,this.decode=c,this.encode=d}}class z1{constructor(a){this._tag="TypeLiteralTransformation",this.propertySignatureTransformations=a;let b={},c={};for(let d of a){let a=d.from;if(b[a])throw Error(yb(a));b[a]=!0;let e=d.to;if(c[e])throw Error(yb(e));c[e]=!0}}}let z2=(a,b)=>{let c=Object.getOwnPropertyDescriptors(a),d={...a.annotations,...b},e=y$(a);return bE(e)&&(d[yL]=z2(e.value,b)),c.annotations.value=d,Object.create(Object.getPrototypeOf(a),c)},z3=(a,b)=>{switch(a._tag){case"Literal":return nB(String(a.literal));case"StringKeyword":return"[\\s\\S]*";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return z5(a,b,!1);case"Union":return a.types.map(a=>z3(a,b)).join("|")}},z4=(a,b,c,d)=>{if(zR(a)){if(c&&!d)return`(?:${b})`}else if(!c||!d)return b;return`(${b})`},z5=(a,b,c)=>{let d="";if(""!==a.head){let e=nB(a.head);d+=b&&c?`(${e})`:e}for(let e of a.spans){let a=z3(e.type,b);if(d+=z4(e.type,a,b,c),""!==e.literal){let a=nB(e.literal);d+=b&&c?`(${a})`:a}}return d},z6=a=>RegExp(`^${z5(a,!1,!0)}$`),z7=a=>{switch(a._tag){case"TupleType":{let b=!1,c=[];for(let d of a.elements)d.isOptional&&(b=!0),c.push(d.type);return b&&c.push(zb),c=c.concat(zC(a.rest)),zP.make(c)}case"Refinement":return z7(a.from);case"Union":return zP.make(a.types.map(z7));case"Suspend":return z7(a.f())}throw Error(errors_.getASTUnsupportedSchemaErrorMessage(a))},z8=(a,b)=>{let c=[],d=[],e=a=>{switch(a._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":d.push(new zH(a,b,!0));break;case"Literal":if(ae(a.literal)||af(a.literal))c.push(new zF(a.literal,b,!1,!0));else{let b;throw Error((b=a.literal,x6("Unsupported literal",`literal value: ${x1(b)}`)))}break;case"Enums":for(let[d,e]of a.enums)c.push(new zF(e,b,!1,!0));break;case"UniqueSymbol":c.push(new zF(a.symbol,b,!1,!0));break;case"Union":a.types.forEach(e);break;default:throw Error(x6("Unsupported key schema",void 0,void 0,a))}};return e(a),{propertySignatures:c,indexSignatures:d}},z9=a=>{switch(a._tag){case"TupleType":return!1===a.isReadonly?a:new zD(a.elements,a.rest,!1,a.annotations);case"TypeLiteral":{let b=Ae(a.propertySignatures,a=>!1===a.isReadonly?a:new zF(a.name,a.type,a.isOptional,!1,a.annotations)),c=Ae(a.indexSignatures,a=>!1===a.isReadonly?a:new zH(a.parameter,a.type,!1));return b===a.propertySignatures&&c===a.indexSignatures?a:new zI(b,c,a.annotations)}case"Union":{let b=Ae(a.types,z9);return b===a.types?a:zP.make(b,a.annotations)}case"Suspend":return new zT(()=>z9(a.f()),a.annotations);case"Refinement":{let b=z9(a.from);return b===a.from?a:new zU(b,a.filter,a.annotations)}case"Transformation":{let b=z9(a.from),c=z9(a.to);return b===a.from&&c===a.to?a:new zX(b,c,a.transformation,a.annotations)}}return a},Aa=a=>b=>{let c;for(let d of a)Object.prototype.hasOwnProperty.call(b.annotations,d)&&(void 0===c&&(c={}),c[d]=b.annotations[d]);return c},Ab=Aa([yz,yA,yB,yC,yD,yE]),Ac=a=>{switch(a._tag){case"Declaration":{let b=Ae(a.typeParameters,Ac);return b===a.typeParameters?a:new y4(b,a.decodeUnknown,a.encodeUnknown,a.annotations)}case"TupleType":{let b=Ae(a.elements,a=>{let b=Ac(a.type);return b===a.type?a:new zB(b,a.isOptional)}),c=zC(a.rest),d=Ae(c,Ac);return b===a.elements&&d===c?a:new zD(b,d.map(a=>new zA(a)),a.isReadonly,a.annotations)}case"TypeLiteral":{let b=Ae(a.propertySignatures,a=>{let b=Ac(a.type);return b===a.type?a:new zF(a.name,b,a.isOptional,a.isReadonly)}),c=Ae(a.indexSignatures,a=>{let b=Ac(a.type);return b===a.type?a:new zH(a.parameter,b,a.isReadonly)});return b===a.propertySignatures&&c===a.indexSignatures?a:new zI(b,c,a.annotations)}case"Union":{let b=Ae(a.types,Ac);return b===a.types?a:zP.make(b,a.annotations)}case"Suspend":return new zT(()=>Ac(a.f()),a.annotations);case"Refinement":{let b=Ac(a.from);return b===a.from?a:new zU(b,a.filter,a.annotations)}case"Transformation":{let b=Ab(a);return Ac(void 0!==b?z2(a.to,b):a.to)}}return a},Ad=a=>ek((a=>em(y2(a),()=>yT(a)))(a),{onNone:()=>void 0,onSome:a=>({[y1]:a})});function Ae(a,b){let c=!1,d=eM(a.length);for(let e=0;e<a.length;e++){let f=a[e],g=b(f);g!==f&&(c=!0),d[e]=g}return c?d:a}let Af=a=>{switch(a._tag){case"Transformation":return a.from;case"Refinement":return Af(a.from);case"Suspend":return Af(a.f())}},Ag=(a,b)=>{switch(a._tag){case"Declaration":{let c=Ae(a.typeParameters,a=>Ag(a,b));return c===a.typeParameters?a:new y4(c,a.decodeUnknown,a.encodeUnknown,a.annotations)}case"TupleType":{let c=Ae(a.elements,a=>{let c=Ag(a.type,b);return c===a.type?a:new zB(c,a.isOptional)}),d=zC(a.rest),e=Ae(d,a=>Ag(a,b));return c===a.elements&&e===d?a:new zD(c,e.map(a=>new zA(a)),a.isReadonly,Ad(a))}case"TypeLiteral":{let c=Ae(a.propertySignatures,a=>{let c=Ag(a.type,b);return c===a.type?a:new zF(a.name,c,a.isOptional,a.isReadonly)}),d=Ae(a.indexSignatures,a=>{let c=Ag(a.type,b);return c===a.type?a:new zH(a.parameter,c,a.isReadonly)});return c===a.propertySignatures&&d===a.indexSignatures?a:new zI(c,d,Ad(a))}case"Union":{let c=Ae(a.types,a=>Ag(a,b));return c===a.types?a:zP.make(c,Ad(a))}case"Suspend":return new zT(()=>Ag(a.f(),b),Ad(a));case"Refinement":{let c=Ag(a.from,b);if(b){if(c===a.from)return a;if(void 0===Af(a.from)&&y0(a))return new zU(c,a.filter,a.annotations)}let d=Ad(a);return d?z2(c,d):c}case"Transformation":{let c=Ad(a);return Ag(c?z2(a.from,c):a.from,b)}}return a},Ah=a=>Ag(a,!1),Ai=a=>{let b={};for(let c of Object.getOwnPropertySymbols(a))b[String(c)]=a[c];return b},Aj=a=>{switch(a._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return a;case"Refinement":return Aj(a.from)}},Ak=a=>el(Am(a),()=>a._tag),Al=a=>yR(a).pipe(em(()=>yU(a)),em(()=>yS(a)),et(b=>b+ek(yO(a),{onNone:()=>"",onSome:a=>a.map(a=>` & Brand<${x1(a)}>`).join("")}))),Am=a=>em(yT(a),()=>Al(a));class An{constructor(a,b,c){this._tag="Pointer",this.path=a,this.actual=b,this.issue=c}}class Ao{constructor(a,b){this._tag="Unexpected",this.actual=a,this.message=b}}class Ap{constructor(a,b){this._tag="Missing",this.actual=void 0,this.ast=a,this.message=b}}class Aq{constructor(a,b,c,d){this._tag="Composite",this.ast=a,this.actual=b,this.issues=c,this.output=d}}class Ar{constructor(a,b,c,d){this._tag="Refinement",this.ast=a,this.actual=b,this.kind=c,this.issue=d}}class As{constructor(a,b,c,d){this._tag="Transformation",this.ast=a,this.actual=b,this.kind=c,this.issue=d}}class At{constructor(a,b,c){this._tag="Type",this.ast=a,this.actual=b,this.message=c}}class Au{constructor(a,b,c){this._tag="Forbidden",this.ast=a,this.actual=b,this.message=c}}let Av=Symbol.for("effect/Schema/ParseErrorTypeId");class Aw extends oS("ParseError"){get message(){return this.toString()}toString(){return A_.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[aY](){return this.toJSON()}constructor(...a){super(...a),this[Av]=Av}}let Ax=a=>new Aw({issue:a}),Ay=dt,Az=a=>{if("function"==typeof a)try{return dt(a())}catch(a){return ds(a)}try{return dt(a.try())}catch(b){return ds(a.catch(b))}},AA=du,AB=W(2,(a,b)=>dp(a)?dy(a,{onLeft:ds,onRight:b}):lb(a,b)),AC=W(2,(a,b)=>dp(a)?dx(a,b):lp(a,b)),AD=W(2,(a,b)=>dp(a)?dw(a,b):lr(a,b)),AE=W(2,(a,b)=>dp(a)?dv(a,{onLeft:b.onFailure,onRight:b.onSuccess}):lq(a,b)),AF=W(2,(a,b)=>dp(a)?dy(a,{onLeft:b,onRight:dt}):kZ(a,b)),AG=(a,b)=>void 0===b||af(b)?a:void 0===a?b:{...a,...b},AH=(a,b,c)=>{let d=AO(a,b);return(a,b)=>d(a,AG(c,b))},AI=(a,b,c)=>{let d=AO(a,b);return(a,b)=>d(a,{...AG(c,b),isEffectAllowed:!0})},AJ=(a,b)=>AI(a.ast,!0,b),AK=(a,b)=>AI(a.ast,!1,b),AL=(a,b)=>((a,b,c)=>{let d=AH(a,b,c);return(a,b)=>dA(d(a,b),Ax)})(Ac(a.ast),!0,b),AM=ad(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),AN=ad(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),AO=(a,b)=>{let c=b?AM:AN,d=c.get(a);if(d)return d;let e=AR(a,b),f=yY(a),g=bE(f)?(a,b)=>e(a,AG(b,f.value)):e,h=yZ(a),i=b&&bE(h)?(b,c)=>AW(AF(g(b,c),h.value),a,b,c):g;return c.set(a,i),i},AP=a=>ep(yV(a)),AQ=a=>ep(yW(a)),AR=(a,b)=>{switch(a._tag){case"Refinement":if(b){let b=AO(a.from,!0);return(c,d)=>{d=d??zW;let e=d?.errors==="all";return AW(AB(AF(b(c,d),b=>{let f=new Ar(a,c,"From",b);return e&&y0(a)&&A5(b)?ek(a.filter(c,d,a),{onNone:()=>ds(f),onSome:b=>ds(new Aq(a,c,[f,new Ar(a,c,"Predicate",b)]))}):ds(f)}),b=>ek(a.filter(b,d,a),{onNone:()=>dt(b),onSome:b=>ds(new Ar(a,c,"Predicate",b))})),a,c,d)}}{let b=AO(Ac(a),!0),c=AO(AV(a.from),!1);return(d,e)=>AW(AB(b(d,e),a=>c(a,e)),a,d,e)}case"Transformation":{let c=AZ(a.transformation,b),d=b?AO(a.from,!0):AO(a.to,!1),e=b?AO(a.to,!0):AO(a.from,!1);return(f,g)=>AW(AB(AD(d(f,g),c=>new As(a,f,b?"Encoded":"Type",c)),d=>AB(AD(c(d,g??zW,a,f),b=>new As(a,f,"Transformation",b)),c=>AD(e(c,g),c=>new As(a,f,b?"Type":"Encoded",c)))),a,f,g)}case"Declaration":{let c=b?a.decodeUnknown(...a.typeParameters):a.encodeUnknown(...a.typeParameters);return(b,d)=>AW(c(b,d??zW,a),a,b,d)}case"Literal":return AS(a,b=>b===a.literal);case"UniqueSymbol":return AS(a,b=>b===a.symbol);case"UndefinedKeyword":return AS(a,aj);case"NeverKeyword":return AS(a,am);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return dt;case"StringKeyword":return AS(a,ae);case"NumberKeyword":return AS(a,af);case"BooleanKeyword":return AS(a,ag);case"BigIntKeyword":return AS(a,ah);case"SymbolKeyword":return AS(a,ai);case"ObjectKeyword":return AS(a,ao);case"Enums":return AS(a,b=>a.enums.some(([a,c])=>c===b));case"TemplateLiteral":{let b=z6(a);return AS(a,a=>ae(a)&&b.test(a))}case"TupleType":{let c=a.elements.map(a=>AO(a.type,b)),d=a.rest.map(a=>AO(a.type,b)),e=a.elements.filter(a=>!a.isOptional);a.rest.length>0&&(e=e.concat(a.rest.slice(1)));let f=e.length,g=a.elements.length>0?a.elements.map((a,b)=>b).join(" | "):"never",h=AP(a),i=AQ(a);return(b,j)=>{let k;if(!eV(b))return ds(new At(a,b));let l=j?.errors==="all",m=[],n=0,o=[],p=b.length;for(let c=p;c<=f-1;c++){let d=new An(c,b,new Ap(e[c-p]));if(!l)return ds(new Aq(a,b,d,o));m.push([n++,d])}if(0===a.rest.length)for(let c=a.elements.length;c<=p-1;c++){let d=new An(c,b,new Ao(b[c],`is unexpected, expected: ${g}`));if(!l)return ds(new Aq(a,b,d,o));m.push([n++,d])}let q=0;for(;q<c.length;q++)if(p<q+1){if(a.elements[q].isOptional)continue}else{let d=(0,c[q])(b[q],j);if(dp(d)){if(dq(d)){let c=new An(q,b,d.left);if(!l)return ds(new Aq(a,b,c,AY(o)));m.push([n++,c]);continue}o.push([n++,d.right])}else{let c=n++,e=q;k||(k=[]),k.push(({es:f,output:g})=>lb(k3(d),d=>{if(dq(d)){let h=new An(e,b,d.left);return l?(f.push([c,h]),lF):ds(new Aq(a,b,h,AY(g)))}return g.push([c,d.right]),lF}))}}if(eW(d)){let[c,...e]=d;for(;q<p-e.length;q++){let d=c(b[q],j);if(dp(d))if(dq(d)){let c=new An(q,b,d.left);if(!l)return ds(new Aq(a,b,c,AY(o)));m.push([n++,c]);continue}else o.push([n++,d.right]);else{let c=n++,e=q;k||(k=[]),k.push(({es:f,output:g})=>lb(k3(d),d=>{if(!dq(d))return g.push([c,d.right]),lF;{let h=new An(e,b,d.left);return l?(f.push([c,h]),lF):ds(new Aq(a,b,h,AY(g)))}}))}}for(let c=0;c<e.length;c++)if(!(p<(q+=c)+1)){let d=e[c](b[q],j);if(dp(d)){if(dq(d)){let c=new An(q,b,d.left);if(!l)return ds(new Aq(a,b,c,AY(o)));m.push([n++,c]);continue}o.push([n++,d.right])}else{let c=n++,e=q;k||(k=[]),k.push(({es:f,output:g})=>lb(k3(d),d=>{if(dq(d)){let h=new An(e,b,d.left);return l?(f.push([c,h]),lF):ds(new Aq(a,b,h,AY(g)))}return g.push([c,d.right]),lF}))}}}let r=({es:c,output:d})=>ei(c)?ds(new Aq(a,b,AY(c),AY(d))):dt(AY(d));if(k&&k.length>0){let a=k;return lz(()=>{let b={es:fa(m),output:fa(o)};return lb(uq(a,a=>a(b),{concurrency:h,batching:i,discard:!0}),()=>r(b))})}return r({output:o,es:m})}}case"TypeLiteral":{if(0===a.propertySignatures.length&&0===a.indexSignatures.length)return AS(a,ar);let c=[],d={},e=[];for(let f of a.propertySignatures)c.push([AO(f.type,b),f]),d[f.name]=null,e.push(f.name);let f=a.indexSignatures.map(a=>[AO(a.parameter,b),AO(a.type,b),a.parameter]),g=zP.make(a.indexSignatures.map(a=>a.parameter).concat(e.map(a=>ai(a)?new y9(a):new y6(a)))),h=AO(g,b),i=AP(a),j=AQ(a);return(b,k)=>{let l,m;if(!av(b))return ds(new At(a,b));let n=k?.errors==="all",o=[],p=0,q=k?.onExcessProperty==="error",r=k?.onExcessProperty==="preserve",s={};if(q||r)for(let c of l=x$(b)){let d=h(c,k);if(dp(d)&&dq(d))if(q){let d=new An(c,b,new Ao(b[c],`is unexpected, expected: ${String(g)}`));if(!n)return ds(new Aq(a,b,d,s));o.push([p++,d]);continue}else s[c]=b[c]}let t=k?.exact===!0;for(let d=0;d<c.length;d++){let e=c[d][1],f=e.name,g=Object.prototype.hasOwnProperty.call(b,f);if(!g){if(e.isOptional)continue;else if(t){let c=new An(f,b,new Ap(e));if(!n)return ds(new Aq(a,b,c,s));o.push([p++,c]);continue}}let h=(0,c[d][0])(b[f],k);if(dp(h)){if(dq(h)){let c=new An(f,b,g?h.left:new Ap(e));if(!n)return ds(new Aq(a,b,c,s));o.push([p++,c]);continue}s[f]=h.right}else{let c=p++;m||(m=[]),m.push(({es:d,output:i})=>lb(k3(h),h=>{if(dq(h)){let j=new An(f,b,g?h.left:new Ap(e));return n?(d.push([c,j]),lF):ds(new Aq(a,b,j,i))}return i[f]=h.right,lF}))}}for(let c=0;c<f.length;c++){let e=f[c],g=e[0],h=e[1];for(let c of xZ(b,e[2])){let e=g(c,k);if(dp(e)&&dr(e)){let e=h(b[c],k);if(dp(e))if(dq(e)){let d=new An(c,b,e.left);if(!n)return ds(new Aq(a,b,d,s));o.push([p++,d]);continue}else Object.prototype.hasOwnProperty.call(d,c)||(s[c]=e.right);else{let f=p++,g=c;m||(m=[]),m.push(({es:h,output:i})=>lb(k3(e),e=>{if(!dq(e))return Object.prototype.hasOwnProperty.call(d,c)||(i[c]=e.right),lF;{let c=new An(g,b,e.left);return n?(h.push([f,c]),lF):ds(new Aq(a,b,c,i))}}))}}}}let u=({es:c,output:d})=>{if(ei(c))return ds(new Aq(a,b,AY(c),d));if(k?.propertyOrder==="original"){let a=l||x$(b);for(let b of e)-1===a.indexOf(b)&&a.push(b);let c={};for(let b of a)Object.prototype.hasOwnProperty.call(d,b)&&(c[b]=d[b]);return dt(c)}return dt(d)};if(m&&m.length>0){let a=m;return lz(()=>{let b={es:fa(o),output:Object.assign({},s)};return lb(uq(a,a=>a(b),{concurrency:i,batching:j,discard:!0}),()=>u(b))})}return u({es:o,output:s})}}case"Union":{let c=AU(a.types,b),d=x$(c.keys),e=d.length,f=a.types.length,g=new Map;for(let c=0;c<f;c++)g.set(a.types[c],AO(a.types[c],b));let h=AP(a)??1,i=AQ(a);return(b,j)=>{let k,l=[],m=0,n=[];if(e>0)if(an(b))for(let a=0;a<e;a++){let e=d[a],g=c.keys[e].buckets;if(Object.prototype.hasOwnProperty.call(b,e)){let a=String(b[e]);if(Object.prototype.hasOwnProperty.call(g,a))n=n.concat(g[a]);else{let{candidates:a,literals:d}=c.keys[e],g=zP.make(d),h=a.length===f?new zI([new zF(e,g,!1,!0)],[]):zP.make(a);l.push([m++,new Aq(h,b,new An(e,b,new At(g,b[e])))])}}else{let{candidates:a,literals:d}=c.keys[e],g=new zF(e,zP.make(d),!1,!0),h=a.length===f?new zI([g],[]):zP.make(a);l.push([m++,new Aq(h,b,new An(e,b,new Ap(g)))])}}else{let d=c.candidates.length===f?a:zP.make(c.candidates);l.push([m++,new At(d,b)])}c.otherwise.length>0&&(n=n.concat(c.otherwise));for(let a=0;a<n.length;a++){let c=n[a],d=g.get(c)(b,j);if(dp(d)&&(!k||0===k.length))if(dr(d))return d;else l.push([m++,d.left]);else{let a=m++;k||(k=[]),k.push(b=>lz(()=>"finalResult"in b?lF:lb(k3(d),c=>(dr(c)?b.finalResult=c:b.es.push([a,c.left]),lF))))}}let o=c=>ei(c)?1===c.length&&"Type"===c[0][1]._tag?ds(c[0][1]):ds(new Aq(a,b,AY(c))):ds(new At(a,b));if(k&&k.length>0){let a=k;return lz(()=>{let b={es:fa(l)};return lb(uq(a,a=>a(b),{concurrency:h,batching:i,discard:!0}),()=>"finalResult"in b?b.finalResult:o(b.es))})}return o(l)}}case"Suspend":{let c=x_(()=>AO(z2(a.f(),a.annotations),b));return(a,b)=>c()(a,b)}}},AS=(a,b)=>c=>b(c)?dt(c):ds(new At(a,c)),AT=(a,b)=>{switch(a._tag){case"Declaration":{let c=y$(a);if(bE(c))return AT(c.value,b);break}case"TypeLiteral":{let c=[];for(let d=0;d<a.propertySignatures.length;d++){let e=a.propertySignatures[d],f=b?Ah(e.type):Ac(e.type);y7(f)&&!e.isOptional&&c.push([e.name,f])}return c}case"TupleType":{let c=[];for(let d=0;d<a.elements.length;d++){let e=a.elements[d],f=b?Ah(e.type):Ac(e.type);y7(f)&&!e.isOptional&&c.push([d,f])}return c}case"Refinement":return AT(a.from,b);case"Suspend":return AT(a.f(),b);case"Transformation":return AT(b?a.from:a.to,b)}return[]},AU=(a,b)=>{let c={},d=[],e=[];for(let f=0;f<a.length;f++){let g=a[f],h=AT(g,b);if(h.length>0){e.push(g);for(let a=0;a<h.length;a++){let[b,d]=h[a],e=String(d.literal);c[b]=c[b]||{buckets:{},literals:[],candidates:[]};let f=c[b].buckets;if(Object.prototype.hasOwnProperty.call(f,e)){if(a<h.length-1)continue;f[e].push(g),c[b].literals.push(d),c[b].candidates.push(g)}else{f[e]=[g],c[b].literals.push(d),c[b].candidates.push(g);break}}}else d.push(g)}return{keys:c,otherwise:d,candidates:e}},AV=a=>zV(a)?AV(a.from):a,AW=(a,b,c,d)=>{if(d?.isEffectAllowed===!0||dp(a))return a;let e=new rf,f=vW(a,{scheduler:e});e.flush();let g=f.unsafePoll();if(g){if(mV(g))return dt(g.value);let a=g.cause;return a._tag===jV?ds(a.error):ds(new Au(b,c,ku(a)))}return ds(new Au(b,c,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},AX=([a],[b])=>a>b?1:a<b?-1:0;function AY(a){return a.sort(AX).map(a=>a[1])}let AZ=(a,b)=>{switch(a._tag){case"FinalTransformation":return b?a.decode:a.encode;case"ComposeTransformation":return dt;case"TypeLiteralTransformation":return c=>{let d=dt(c);for(let c of a.propertySignatureTransformations){let[a,e]=b?[c.from,c.to]:[c.to,c.from],f=b?c.decode:c.encode;d=AC(d,b=>{let c=f(Object.prototype.hasOwnProperty.call(b,a)?bG(b[a]):ej());return delete b[a],bE(c)&&(b[e]=c.value),b})}return d}}},A$=(a,b=[])=>({value:a,forest:b}),A_={formatIssue:a=>AC(Bd(a),A0),formatIssueSync:a=>{let b=A_.formatIssue(a);return dp(b)?dB(b):vZ(b)},formatError:a=>A_.formatIssue(a.issue),formatErrorSync:a=>A_.formatIssueSync(a.issue)},A0=a=>a.value+A1("\n",a.forest),A1=(a,b)=>{let c,d="",e=b.length;for(let f=0;f<e;f++){c=b[f];let g=f===e-1;d+=a+(g?"└":"├")+"─ "+c.value,d+=A1(a+(e>1&&!g?"│  ":"   "),c.forest)}return d},A2=a=>"ast"in a?bG(a.ast):ej(),A3=dt(void 0),A4=a=>b=>b._tag===a,A5=A4("Composite"),A6=A4("Refinement"),A7=A4("Transformation"),A8=a=>AB((a=>A2(a).pipe(eu(yP),ek({onNone:()=>A3,onSome:b=>{let c=b(a);return ae(c)?dt({message:c,override:!1}):kP(c)?lp(c,a=>({message:a,override:!1})):ae(c.message)?dt({message:c.message,override:c.override}):lp(c.message,a=>({message:a,override:c.override}))}})))(a),b=>void 0!==b?!b.override&&(A5(a)||A6(a)&&"From"===a.kind||A7(a)&&"Transformation"!==a.kind)?A7(a)||A6(a)?A8(a.issue):A3:dt(b.message):A3),A9=a=>A2(a).pipe(eu(yX),ev(b=>b(a)),ep),Ba=a=>AC(A8(a),b=>b??A9(a)??function(a){var b;if(void 0!==a.message)return a.message;let c=zV(a.ast)?yU(b=a.ast).pipe(em(()=>yR(b)),em(()=>yS(b)),em(()=>yT(b)),el(()=>`{ ${b.from} | filter }`)):String(a.ast);return`Expected ${c}, actual ${x1(a.actual)}`}(a)),Bb=a=>A9(a)??String(a.ast),Bc=a=>{let b=yQ(a.ast);if(bE(b)){let a=b.value();return ae(a)?dt(a):a}return dt(a.message??"is missing")},Bd=a=>{switch(a._tag){case"Type":return AC(Ba(a),A$);case"Forbidden":return dt(A$(Bb(a),[A$(a.message??"is forbidden")]));case"Unexpected":return dt(A$(a.message??"is unexpected"));case"Missing":return AC(Bc(a),A$);case"Transformation":return AB(A8(a),b=>void 0!==b?dt(A$(b)):AC(Bd(a.issue),b=>A$(Bb(a),[A$((a=>{switch(a){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(a.kind),[b])])));case"Refinement":return AB(A8(a),b=>void 0!==b?dt(A$(b)):AC(Bd(a.issue),b=>A$(Bb(a),[A$((a=>{switch(a){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(a.kind),[b])])));case"Pointer":return AC(Bd(a.issue),b=>A$(x5(a.path),[b]));case"Composite":return AB(A8(a),b=>{if(void 0!==b)return dt(A$(b));let c=Bb(a);return x3(a.issues)?AC(uq(a.issues,Bd),a=>A$(c,a)):AC(Bd(a.issues),a=>A$(c,[a]))})}},Be=W(a=>ao(a[0]),(a,...b)=>{let c={};for(let d of b)d in a&&(c[d]=a[d]);return c}),Bf=W(a=>ao(a[0]),(a,...b)=>{let c={...a};for(let a of b)delete c[a];return c}),Bg=Symbol.for("effect/Schema");function Bh(a){return class{static{this.ast=a}static annotations(a){return Bh(Bl(this.ast,a))}static pipe(){return a7(this,arguments)}static toString(){return String(a)}static{this[Bg]=Bi}constructor(){this[Bg]=Bi}}}let Bi={_A:a=>a,_I:a=>a,_R:a=>a},Bj={schemaId:ys,message:yt,missingMessage:yu,identifier:yv,title:yw,description:yy,examples:yz,default:yA,documentation:yF,jsonSchema:yB,arbitrary:yC,pretty:yD,equivalence:yE,concurrency:yG,batching:yH,parseIssueTitle:yI,parseOptions:yJ,decodingFallback:yK},Bk=a=>{if(!a)return{};let b={...a};for(let c in Bj)c in a&&(b[Bj[c]]=a[c],delete b[c]);return b},Bl=(a,b)=>z2(a,Bk(b)),Bm=a=>Bh(Ac(a.ast)),Bn=(a,b)=>{let c=AJ(a,b);return(a,b)=>AD(c(a,b),Ax)},Bo=a=>ap(a,Bg)&&ao(a[Bg]);function Bp(...a){return eW(a)?function a(b,c=function(a){let b;return zQ(a)?zP.make((b=a=>new y6(a),a.map(b))):new y6(a[0])}(b)){return class extends Bh(c){static annotations(b){return a(this.literals,Bl(this.ast,b))}static{this.literals=[...b]}}}(a):Bw}function Bq(a,b){return class extends Bh(b){static annotations(a){return Bq(this.typeParameters,Bl(this.ast,a))}static{this.typeParameters=[...a]}}}let Br=function(){if(Array.isArray(arguments[0])){let a=arguments[0],b=arguments[1],c=arguments[2];return Bq(a,new y4(a.map(a=>a.ast),(...a)=>b.decode(...a.map(Bh)),(...a)=>b.encode(...a.map(Bh)),Bk(c)))}let a=arguments[0],b=arguments[1],c=()=>(b,c,d)=>a(b)?Ay(b):ds(new At(d,b));return Bq([],new y4([],c,c,Bk(b)))},Bs=Symbol.for("effect/SchemaId/InstanceOf"),Bt=(a,b)=>Br(b=>b instanceof a,{title:a.name,description:`an instance of ${a.name}`,pretty:()=>String,schemaId:Bs,[Bs]:{constructor:a},...b});class Bu extends Bh(zb){}class Bv extends Bh(y8){}class Bw extends Bh(ze){}class Bx extends Bh(zg){}class By extends Bh(zt){}class Bz extends Bh(zv){}class BA extends Bh(zk){}class BB extends Bh(zn){}class BC extends Bh(zq){}function BD(...a){return zQ(a)?function a(b,c=(a=>zP.make(a.map(a=>a.ast)))(b)){return class extends Bh(c){static annotations(b){return a(this.members,Bl(this.ast,b))}static{this.members=[...b]}}}(a):eW(a)?a[0]:Bw}let BE=a=>BD(a,Bv),BF=a=>BD(a,Bu),BG=a=>BD(a,Bv,Bu),BH=a=>new BI(new zB(a.ast,!1),a);class BI{constructor(a,b){this.ast=a,this.from=b}annotations(a){return new BI(new zB(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...Bk(a)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function BJ(a,b,c=((a,b)=>new zD(a.map(a=>Bo(a)?new zB(a.ast,!1):a.ast),b.map(a=>Bo(a)?new zA(a.ast):a.ast),!0))(a,b)){return class extends Bh(c){static annotations(a){return BJ(this.elements,this.rest,Bl(this.ast,a))}static{this.elements=[...a]}static{this.rest=[...b]}}}function BK(...a){return Array.isArray(a[0])?BJ(a[0],a.slice(1)):BJ(a,[])}let BL=a=>(function a(b,c){return class extends BJ([],[b],c){static annotations(b){return a(this.value,Bl(this.ast,b))}static{this.value=b}}})(a),BM=a=>a?'"?:"':'":"';class BN extends zB{constructor(a,b,c,d,e){super(a,b,d),this._tag="PropertySignatureDeclaration",this.isReadonly=c,this.defaultValue=e}toString(){let a=BM(this.isOptional),b=String(this.type);return`PropertySignature<${a}, ${b}, never, ${a}, ${b}>`}}class BO extends zB{constructor(a,b,c,d,e){super(a,b,d),this.isReadonly=c,this.fromKey=e}}class BP extends zB{constructor(a,b,c,d,e){super(a,b,d),this.isReadonly=c,this.defaultValue=e}}class BQ{constructor(a,b,c,d){this._tag="PropertySignatureTransformation",this.from=a,this.to=b,this.decode=c,this.encode=d}toString(){var a;return`PropertySignature<${BM(this.to.isOptional)}, ${this.to.type}, ${void 0===(a=this.from.fromKey)?"never":ae(a)?JSON.stringify(a):String(a)}, ${BM(this.from.isOptional)}, ${this.from.type}>`}}let BR=(a,b)=>{switch(a._tag){case"PropertySignatureDeclaration":return new BN(a.type,a.isOptional,a.isReadonly,{...a.annotations,...b},a.defaultValue);case"PropertySignatureTransformation":return new BQ(a.from,new BP(a.to.type,a.to.isOptional,a.to.isReadonly,{...a.to.annotations,...b},a.to.defaultValue),a.decode,a.encode)}},BS=Symbol.for("effect/PropertySignature"),BT=a=>ap(a,BS);class BU{constructor(a){this[BS]=null,this.ast=a}pipe(){return a7(this,arguments)}annotations(a){return new BU(BR(this.ast,Bk(a)))}toString(){return String(this.ast)}}let BV=a=>new BU(a);class BW extends BU{constructor(a,b){super(a),this.from=b}annotations(a){return new BW(BR(this.ast,Bk(a)),this.from)}}let BX=a=>new BW(new BN(a.ast,!1,!0,{},void 0),a),BY=W(2,(a,b)=>{let c=a.ast;switch(c._tag){case"PropertySignatureDeclaration":return BV(new BN(c.type,c.isOptional,c.isReadonly,c.annotations,b));case"PropertySignatureTransformation":return BV(new BQ(c.from,new BP(c.to.type,c.to.isOptional,c.to.isReadonly,c.to.annotations,b),c.decode,c.encode))}}),BZ=a=>AST.pruneUndefined(a,BZ,a=>{let b=BZ(a.to);if(b)return new AST.Transformation(a.from,b,a.transformation)}),B$=(a,b,c)=>BV(new BQ(new BO(a.ast,!0,!0,{},void 0),new BP(b.ast,!1,!0,{},void 0),a=>bG(c.decode(a)),eu(c.encode))),B_=(a,b,c)=>BV(new BQ(new BO(a.ast,!0,!0,{},void 0),new BP(b.ast,!0,!0,{},void 0),c.decode,c.encode)),B0=a=>new BW(new BN(a.ast===zb||a.ast===ze?zb:BF(a).ast,!0,!0,{},void 0),a),B1=W(a=>Bo(a[0]),(a,b)=>new BW(((a,b)=>{let c=b?.exact,d=b?.default,e=b?.nullable,f=b?.as=="Option",g=b?.onNoneEncoding?em(b.onNoneEncoding):X;if(c)if(d)if(e)return BY(B$(BE(a),Bm(a),{decode:ek({onNone:d,onSome:a=>null===a?d():a}),encode:bG}),d).ast;else return BY(B$(a,Bm(a),{decode:ek({onNone:d,onSome:X}),encode:bG}),d).ast;else if(f)if(e)return B$(BE(a),C2(Bm(a)),{decode:ew(al),encode:g}).ast;else return B$(a,C2(Bm(a)),{decode:X,encode:X}).ast;else if(e)return B_(BE(a),Bm(a),{decode:ew(al),encode:X}).ast;else return new BN(a.ast,!0,!0,{},void 0);if(d)if(e)return BY(B$(BG(a),Bm(a),{decode:ek({onNone:d,onSome:a=>null==a?d():a}),encode:bG}),d).ast;else return BY(B$(BF(a),Bm(a),{decode:ek({onNone:d,onSome:a=>void 0===a?d():a}),encode:bG}),d).ast;if(f)if(e)return B$(BG(a),C2(Bm(a)),{decode:ew(a=>null!=a),encode:g}).ast;else return B$(BF(a),C2(Bm(a)),{decode:ew(ak),encode:g}).ast;if(e)return B_(BG(a),BF(Bm(a)),{decode:ew(al),encode:X}).ast;return new BN(BF(a).ast,!0,!0,{},void 0)})(a,b),a)),B2=Aa([yu]),B3=(a,b)=>{for(let c of x$(a)){let d=a[c];if(void 0===b[c]&&BT(d)){let a=d.ast,e="PropertySignatureDeclaration"===a._tag?a.defaultValue:a.to.defaultValue;void 0!==e&&(b[c]=e())}}return b};function B4(a,b,c=((a,b)=>{let c=x$(a),d=[];if(c.length>0){let e=[],f=[],g=[];for(let b=0;b<c.length;b++){let h=c[b],i=a[h];if(BT(i)){let a=i.ast;switch(a._tag){case"PropertySignatureDeclaration":{let b=a.type,c=a.isOptional,g=a.annotations;e.push(new zF(h,b,c,!0,B2(a))),f.push(new zF(h,Ac(b),c,!0,g)),d.push(new zF(h,b,c,!0,g));break}case"PropertySignatureTransformation":{let b=a.from.fromKey??h;e.push(new zF(b,a.from.type,a.from.isOptional,!0,a.from.annotations)),f.push(new zF(h,a.to.type,a.to.isOptional,!0,a.to.annotations)),g.push(new z0(b,h,a.decode,a.encode))}}}else e.push(new zF(h,i.ast,!1,!0)),f.push(new zF(h,Ac(i.ast),!1,!0)),d.push(new zF(h,i.ast,!1,!0))}if(eW(g)){let a=[],c=[];for(let d of b){let{indexSignatures:b,propertySignatures:g}=z8(d.key.ast,d.value.ast);g.forEach(a=>{e.push(a),f.push(new zF(a.name,Ac(a.type),a.isOptional,a.isReadonly,a.annotations))}),b.forEach(b=>{a.push(b),c.push(new zH(b.parameter,Ac(b.type),b.isReadonly))})}return new zX(new zI(e,a,{[yx]:"Struct (Encoded side)"}),new zI(f,c,{[yx]:"Struct (Type side)"}),new z1(g))}}let e=[];for(let a of b){let{indexSignatures:b,propertySignatures:c}=z8(a.key.ast,a.value.ast);c.forEach(a=>d.push(a)),b.forEach(a=>e.push(a))}return new zI(d,e)})(a,b)){return class extends Bh(c){static annotations(a){return B4(this.fields,this.records,Bl(this.ast,a))}static{this.fields={...a}}static{this.records=[...b]}static{this.make=(b,c)=>{let d=B3(a,{...b});return Dc(c)?d:AL(this)(d)}}static pick(...b){return B5(Be(a,...b))}static omit(...b){return B5(Bf(a,...b))}}}function B5(a,...b){return B4(a,b)}let B6=(a,b)=>B5({_tag:(a=>Bp(a).pipe(BX,BY(()=>a)))(a),...b}),B7=(a,b,c)=>{if(zL(a)&&zL(b)){let d=[...a.propertySignatures];for(let a of b.propertySignatures){let b=a.name,e=d.findIndex(a=>a.name===b);if(-1===e)d.push(a);else{let{isOptional:f,type:g}=d[e];d[e]=new zF(b,Ca(g,a.type,c.concat(b)),f,!0)}}return new zI(d,a.indexSignatures.concat(b.indexSignatures))}throw Error(x7(a,b,c))},B8=(v=[yv],a=>{let b={...a.annotations};for(let a of v)delete b[a];return b}),B9=(a,b)=>b.map(b=>new zU(b,a.filter,B8(a))),Ca=(a,b,c)=>zP.make(Cc([a],[b],c)),Cb=a=>zR(a)?a.types:[a],Cc=(a,b,c)=>fg(a,a=>fg(b,b=>{switch(b._tag){case"Literal":if(ae(b.literal)&&zl(a)||af(b.literal)&&zo(a)||ag(b.literal)&&zr(a))return[b];break;case"StringKeyword":if(b===zk){if(zl(a)||y7(a)&&ae(a.literal))return[a];else if(zV(a))return B9(a,Cc(Cb(a.from),[b],c))}else if(a===zk)return[b];break;case"NumberKeyword":if(b===zn){if(zo(a)||y7(a)&&af(a.literal))return[a];else if(zV(a))return B9(a,Cc(Cb(a.from),[b],c))}else if(a===zn)return[b];break;case"BooleanKeyword":if(b===zq){if(zr(a)||y7(a)&&ag(a.literal))return[a];else if(zV(a))return B9(a,Cc(Cb(a.from),[b],c))}else if(a===zq)return[b];break;case"Union":return Cc(Cb(a),b.types,c);case"Suspend":return[new zT(()=>Ca(a,b.f(),c))];case"Refinement":return B9(b,Cc(Cb(a),Cb(b.from),c));case"TypeLiteral":switch(a._tag){case"Union":return Cc(a.types,[b],c);case"Suspend":return[new zT(()=>Ca(a.f(),b,c))];case"Refinement":return B9(a,Cc(Cb(a.from),[b],c));case"TypeLiteral":return[B7(a,b,c)];case"Transformation":{let d=a.transformation,e=B7(a.from,b,c),f=B7(a.to,Ac(b),c);switch(d._tag){case"TypeLiteralTransformation":return[new zX(e,f,new z1(d.propertySignatureTransformations))];case"ComposeTransformation":return[new zX(e,f,z_)];case"FinalTransformation":return[new zX(e,f,new zZ((a,b,c,e)=>AC(d.decode(a,b,c,e),b=>({...a,...b})),(a,b,c,e)=>AC(d.encode(a,b,c,e),b=>({...a,...b}))))]}}}break;case"Transformation":if(!zY(a))return Cc([b],[a],c);if("TypeLiteralTransformation"===b.transformation._tag&&"TypeLiteralTransformation"===a.transformation._tag)return[new zX(B7(a.from,b.from,c),B7(a.to,b.to,c),new z1(b.transformation.propertySignatureTransformations.concat(a.transformation.propertySignatureTransformations)))]}throw Error(x7(a,b,c))})),Cd=W(2,(a,b)=>Bh(Ca(a.ast,b.ast,[]))),Ce=W(a=>Bo(a[1]),(a,b)=>{let c;return Cj(a,b,(c=a.ast,new zX(c,b.ast,z_)))}),Cf=a=>Bh(new zT(()=>a().ast)),Cg=Symbol.for("effect/SchemaId/Refine"),Ch=(a,b,c)=>{if(ag(a))return a?ej():bG(new At(b,c));if(ae(a))return bG(new At(b,c,a));if(void 0!==a){if("_tag"in a)return bG(a);let d=new At(b,c,a.message);return bG(eW(a.path)?new An(a.path,c,d):d)}return ej()};function Ci(a,b){return c=>{function d(b,c,d){var e=a(b,c,d);if(!Array.isArray(e))return Ch(e,d,b);if(eW(e)){let a=fi(e,a=>Ch(a,d,b));if(eW(a))return bG(1===a.length?a[0]:new Aq(d,b,a))}return ej()}let e=new zU(c.ast,d,Bk(b));return function a(b,c,d){return class extends Bh(d){static annotations(b){return a(this.from,this.filter,Bl(this.ast,b))}static{this[Cg]=b}static{this.from=b}static{this.filter=c}static{this.make=(a,b)=>Dc(b)?a:AL(this)(a)}}}(c,d,e)}}function Cj(a,b,c){return class extends Bh(c){static annotations(a){return Cj(this.from,this.to,Bl(this.ast,a))}static{this.from=a}static{this.to=b}}}let Ck=W(a=>Bo(a[0])&&Bo(a[1]),(a,b,c)=>Cj(a,b,new zX(a.ast,b.ast,new zZ(c.decode,c.encode)))),Cl=W(a=>Bo(a[0])&&Bo(a[1]),(a,b,c)=>Ck(a,b,{strict:!0,decode:(a,b,d,e)=>Ay(c.decode(a,e)),encode:(a,b,d,e)=>Ay(c.encode(a,e))})),Cm=Symbol.for("effect/SchemaId/Trimmed"),Cn=a=>b=>b.pipe(Ci(a=>a===a.trim(),{schemaId:Cm,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...a})),Co=Symbol.for("effect/SchemaId/Pattern"),Cp=Symbol.for("effect/SchemaId/StartsWith"),Cq=Symbol.for("effect/SchemaId/Lowercased"),Cr=a=>b=>b.pipe(Ci(a=>a===a.toLowerCase(),{schemaId:Cq,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...a})),Cs=Symbol.for("effect/SchemaId/Uppercased"),Ct=a=>b=>b.pipe(Ci(a=>a===a.toUpperCase(),{schemaId:Cs,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...a})),Cu=Symbol.for("effect/SchemaId/Capitalized"),Cv=a=>b=>b.pipe(Ci(a=>a[0]?.toUpperCase()===a[0],{schemaId:Cu,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...a})),Cw=Symbol.for("effect/SchemaId/Uncapitalized"),Cx=a=>b=>b.pipe(Ci(a=>a[0]?.toLowerCase()===a[0],{schemaId:Cw,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...a})),Cy=a=>((a,b)=>c=>c.pipe(Ci(b=>b.length>=a,{schemaId:yp,title:`minLength(${a})`,description:`a string at least ${a} character(s) long`,jsonSchema:{minLength:a},...b})))(1,{title:"nonEmptyString",description:"a non empty string",...a});class Cz extends BA.pipe(Cn({identifier:"Trimmed"})){}let CA=a=>a instanceof Error?a.message:String(a),CB=(a,b)=>Bo(a)?Ce(CB(b),a):(a=>Ck(BA.annotations({description:"a string to be decoded into JSON"}),Bx,{strict:!0,decode:(b,c,d)=>Az({try:()=>JSON.parse(b,a?.reviver),catch:a=>new At(d,b,CA(a))}),encode:(b,c,d)=>Az({try:()=>JSON.stringify(b,a?.replacer,a?.space),catch:a=>new At(d,b,CA(a))})}).annotations({title:"parseJson",schemaId:y3}))(a);/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.source,URL;let CC=a=>b=>b.pipe(Ci(a=>Number.isSafeInteger(a),{schemaId:yi,title:"int",description:"an integer",jsonSchema:{type:"integer"},...a})),CD=(a,b,c)=>d=>d.pipe(Ci(c=>c>=a&&c<=b,{schemaId:ym,title:`between(${a}, ${b})`,description:`a number between ${a} and ${b}`,jsonSchema:{minimum:a,maximum:b},...c})),CE=a=>((a,b)=>c=>c.pipe(Ci(b=>b>=a,{schemaId:yf,title:`greaterThanOrEqualTo(${a})`,description:0===a?"a non-negative number":`a number greater than or equal to ${a}`,jsonSchema:{minimum:a},...b})))(0,{title:"nonNegative",...a});class CF extends BB.pipe(CC({identifier:"Int"})){}class CG extends BB.pipe(CE({identifier:"NonNegative"})){}class CH extends Ck(BA.annotations({description:"a string to be decoded into a bigint"}),By,{strict:!0,decode:(a,b,c)=>AA(fM(a),()=>new At(c,a,`Unable to decode ${JSON.stringify(a)} into a bigint`)),encode:a=>Ay(String(a))}).annotations({identifier:"BigInt"}){}((a,b)=>c=>c.pipe(Ci(b=>b>=a,{schemaId:yn,[yn]:{min:a},title:`greaterThanOrEqualToBigInt(${a})`,description:0n===a?"a non-negative bigint":`a bigint greater than or equal to ${a}n`,...b})))(0n,{title:"nonNegativeBigInt",identifier:"NonNegativeBigintFromSelf"});let CI=a=>b=>a(b).map(dY),CJ=(a,b,c,d)=>AE(a,{onFailure:a=>new Aq(c,d,a),onSuccess:b}),CK=a=>(b,c,d)=>dX(b)?CJ(a(dZ(b),c),dY,d,b):ds(new At(d,b)),CL=CG.pipe(CC()).annotations({identifier:"NonNegativeInt"}),CM=B6("Millis",{millis:CL}),CN=B6("Nanos",{nanos:CH}),CO=B6("Infinity",{}),CP=BK(BH(CL).annotations({title:"seconds"}),BH(CL).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"});class CQ extends Br(as,{identifier:"Uint8ArrayFromSelf",pretty:()=>a=>`new Uint8Array(${JSON.stringify(Array.from(a))})`,arbitrary:()=>a=>a.uint8Array(),equivalence:()=>fr(aV)}){}let CR=(w=a=>(a=>{let b=dH(a),c=b.length;if(c%4!=0)return ds(dD(b,`Length must be a multiple of 4, but is ${c}`));let d=b.indexOf("=");if(-1!==d&&(d<c-2||d===c-2&&"="!==b[c-1]))return ds(dD(b,"Found a '=' character, but it is not at the end"));try{let a=b.endsWith("==")?2:+!!b.endsWith("="),d=new Uint8Array(c/4*3-a);for(let a=0,e=0;a<c;a+=4,e+=3){let c=dI(b.charCodeAt(a))<<18|dI(b.charCodeAt(a+1))<<12|dI(b.charCodeAt(a+2))<<6|dI(b.charCodeAt(a+3));d[e]=c>>16,d[e+1]=c>>8&255,d[e+2]=255&c}return dt(d)}catch(a){return ds(dD(b,a instanceof Error?a.message:"Invalid input"))}})(a),x=a=>"string"==typeof a?dG(dF.encode(a)):dG(a),Ck(BA.annotations({description:"a string to be decoded into a Uint8Array"}),CQ,{strict:!0,decode:(a,b,c)=>dw(w(a),b=>new At(c,a,b.message)),encode:a=>Ay(x(a))}).annotations({identifier:"Uint8ArrayFromBase64"})),CS=Symbol.for("effect/SchemaId/ValidDate"),CT=yd;class CU extends Br(at,{identifier:"DateFromSelf",schemaId:CT,[CT]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>a=>`new Date(${JSON.stringify(a)})`,arbitrary:()=>a=>a.date({noInvalidDate:!1}),equivalence:()=>dR}){}a=>qO(a)&&qR(a);let CV=()=>a=>a.integer({min:-432e5,max:504e5}).map(qu);class CW extends Br(qP,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>a=>a.toString(),arbitrary:CV}){}let CX=()=>a=>a.constantFrom(...Intl.supportedValuesOf("timeZone")).map(qt);class CY extends Br(qQ,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>a=>a.toString(),arbitrary:CX}){}let CZ=a=>a.oneof(CV()(a),CX()(a));a=>qO(a)&&qS(a);let C$=a=>"None"===a._tag?ej():bG(a.value),C_=(a,b)=>c=>c.oneof(b,c.record({_tag:c.constant("None")}),c.record({_tag:c.constant("Some"),value:a(c)})).map(C$),C0=a=>ek({onNone:()=>"none()",onSome:b=>`some(${a(b)})`}),C1=a=>(b,c,d)=>bC(b)?bD(b)?Ay(ej()):CJ(a(b.value,c),bG,d,b):ds(new At(d,b)),C2=a=>Br([a],{decode:a=>C1(AJ(a)),encode:a=>C1(AK(a))},{description:`Option<${String(a.ast)}>`,pretty:C0,arbitrary:C_,equivalence:ex}),C3=()=>a=>`BigDecimal(${fI(fE(a))})`,C4=()=>a=>a.tuple(a.bigInt(),a.integer({min:0,max:18})).map(([a,b])=>fz(a,b)),C5=a=>x$(a).every(b=>(a=>Bo(a)||BT(a))(a[b])),C6=a=>"fields"in a?a.fields:C6(a[Cg]),C7=a=>C5(a)?B5(a):Bo(a)?a:B5(C6(a)),C8=a=>C5(a)?a:C6(a),C9=a=>(b,c)=>De({kind:"Class",identifier:a,schema:C7(b),fields:C8(b),Base:iT,annotations:c}),Da=a=>(b,c,d)=>{class e extends oR{}e.prototype.name=b;let f=C8(c),g=C7(c),h={_tag:(a=>BY(BX(Bp(a)),()=>a))(b)},i=Db(h,f),j="message"in i;class k extends De({kind:"TaggedError",identifier:a??b,schema:Cd(g,B5(h)),fields:i,Base:e,annotations:d,disableToString:!0}){static{this._tag=b}}return j||Object.defineProperty(k.prototype,"message",{get(){return`{ ${x$(f).map(a=>`${x2(a)}: ${x1(this[a])}`).join(", ")} }`},enumerable:!1,configurable:!0}),k},Db=(a,b)=>{let c={...a};for(let d of x$(b)){if(d in a)throw Error(yc(d));c[d]=b[d]}return c};function Dc(a){return ag(a)?a:a?.disableValidation??!1}let Dd=ad("effect/Schema/astCache",()=>new WeakMap),De=({Base:a,annotations:b,disableToString:c,fields:d,identifier:e,kind:f,schema:g})=>{let h=Symbol.for(`effect/Schema/${f}/${e}`),[i,j,k]=(a=>void 0===a?[]:Array.isArray(a)?a:[a])(b),l=Bm(g),m=l.annotations({identifier:e,...i}),n=l.annotations({[yx]:`${e} (Type side)`,...i}),o=g.annotations({[yx]:`${e} (Constructor)`,...i}),p=g.annotations({[yx]:`${e} (Encoded side)`,...k}),q=g.annotations({[y1]:e,...k,...i,...j}),r=class extends a{constructor(a={},b=!1){a={...a},"Class"!==f&&delete a._tag,a=B3(d,a),Dc(b)||(a=AL(o)(a)),super(a,!0)}static{this[Bg]=Bi}static get ast(){let a=Dd.get(this);return a||(a=Cl(p,Br([g],{decode:()=>(a,b,c)=>a instanceof this||ap(a,h)&&((a,b)=>{let c=AO(Ac(a.ast),!0);return(a,d)=>dr(c(a,{exact:!0,...AG(b,d)}))})(n)(a)?Ay(a):ds(new At(c,a)),encode:()=>(a,b)=>a instanceof this?Ay(a):AC(AK(n)(a,b),a=>new this(a,!0))},{identifier:e,pretty:a=>b=>`${e}(${a(b)})`,arbitrary:a=>b=>a(b).map(a=>new this(a)),equivalence:X,[yL]:m.ast,...i}),{strict:!0,decode:a=>new this(a,!0),encode:X}).annotations({[yL]:q.ast,...j}).ast,Dd.set(this,a)),a}static pipe(){return a7(this,arguments)}static annotations(a){return Bh(this.ast).annotations(a)}static toString(){return`(${String(p)} <-> ${e})`}static make(...a){return new this(...a)}static{this.fields={...d}}static{this.identifier=e}static extend(a){return(b,c)=>{let e=C8(b),h=C7(b),i=Db(d,e);return De({kind:f,identifier:a,schema:Cd(g,h),fields:i,Base:this,annotations:c})}}static transformOrFail(a){return(b,c,e)=>{let h=Db(d,b);return De({kind:f,identifier:a,schema:Ck(g,Bm(B5(h)),c),fields:h,Base:this,annotations:e})}}static transformOrFailFrom(a){return(b,c,e)=>{let h=Db(d,b);return De({kind:f,identifier:a,schema:Ck(Bh(Ah(g.ast)),B5(h),c),fields:h,Base:this,annotations:e})}}get[h](){return h}};return!0!==c&&Object.defineProperty(r.prototype,"toString",{value(){return`${e}({ ${x$(d).map(a=>`${x2(a)}: ${x1(this[a])}`).join(", ")} })`},configurable:!0,writable:!0}),r},Df=B5({_tag:Bp("None")}).annotations({identifier:"FiberIdNoneEncoded"}),Dg=BD(Df,B5({_tag:Bp("Runtime"),id:CF,startTimeMillis:CF}).annotations({identifier:"FiberIdRuntimeEncoded"}),B5({_tag:Bp("Composite"),left:Cf(()=>Dg),right:Cf(()=>Dg)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),Dh=a=>a.letrec(b=>({None:a.record({_tag:a.constant("None")}),Runtime:a.record({_tag:a.constant("Runtime"),id:a.integer(),startTimeMillis:a.integer()}),Composite:a.record({_tag:a.constant("Composite"),left:b("FiberId"),right:b("FiberId")}),FiberId:a.oneof(b("None"),b("Runtime"),b("Composite"))})).FiberId.map(Dj),Di=a=>{switch(a._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${a.id}, ${a.startTimeMillis})`;case"Composite":return`FiberId.composite(${Di(a.right)}, ${Di(a.left)})`}},Dj=a=>{switch(a._tag){case"None":return ix;case"Runtime":return iy(a.id,a.startTimeMillis);case"Composite":return new im(Dj(a.left),Dj(a.right))}};class Dk extends Cl(Bx,Bx,{strict:!0,decode:a=>{if(ao(a)&&"message"in a&&"string"==typeof a.message){let b=Error(a.message,{cause:a});return"name"in a&&"string"==typeof a.name&&(b.name=a.name),b.stack="stack"in a&&"string"==typeof a.stack?a.stack:"",b}return String(a)},encode:a=>a instanceof Error?{name:a.name,message:a.message}:kx(a)}).annotations({identifier:"Defect"}){}let Dl=B6("symbol",{key:BA}).annotations({description:"an object to be decoded into a globally shared symbol"}),Dm=Ck(Dl,Bz,{strict:!0,decode:a=>Ay(Symbol.for(a.key)),encode:(a,b,c)=>AC(((a,b)=>{let c=Symbol.keyFor(a);return void 0===c?ds(new At(b,a,`Unable to encode a unique symbol ${String(a)} into a string`)):Ay(c)})(a,c),a=>Dl.make({key:a}))});Bp("inline","attachment"),Bp("public-read","private");let Dn=Bp("upload"),Do=Bp("callback","error"),Dp=Cl(CQ,BA,{decode:a=>new TextDecoder().decode(a),encode:a=>new TextEncoder().encode(a)}),Dq=B5({apiKey:function(a){return Cl(a,Br([Bm(a)],{decode:a=>CK(AJ(a)),encode:a=>CK(AK(a))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:CI,equivalence:d$}),{strict:!0,decode:a=>dY(a),encode:a=>dZ(a)})}(BA.pipe(((a,b)=>c=>{let d=JSON.stringify(a);return c.pipe(Ci(b=>b.startsWith(a),{schemaId:Cp,[Cp]:{startsWith:a},title:`startsWith(${d})`,description:`a string starting with ${d}`,jsonSchema:{pattern:`^${a}`},...b}))})("sk_"))),appId:BA,regions:function a(b,c){return class extends BJ([b],[b],c){static annotations(b){return a(this.value,Bl(this.ast,b))}static{this.value=b}}}(BA),ingestHost:BA.pipe(B1({default:()=>"ingest.uploadthing.com"}))}),Dr=CR.pipe(Ce(Dp),Ce(CB(Dq)));var Ds=class extends C9("FileUploadData")({name:BA,size:BB,type:BA,lastModified:BB.pipe(B0)}){},Dt=class extends Ds.extend("FileUploadDataWithCustomId")({customId:BE(BA)}){},Du=class extends Dt.extend("UploadedFileData")({key:BA,url:BA,appUrl:BA,ufsUrl:BA,fileHash:BA}){},Dv=class extends C9("MetadataFetchStreamPart")({payload:BA,signature:BA,hook:Do}){},Dw=class extends C9("MetadataFetchResponse")({ok:BC}){},Dx=class extends C9("CallbackResultResponse")({ok:BC}){},Dy=class extends C9("UploadActionPayload")({files:BL(Ds),input:Bx}){};let Dz=Symbol.for("@effect/platform/Error"),DA=(a,b)=>{class c extends oR{constructor(...a){super(...a),this._tag=b}}return c.prototype[a]=a,c.prototype.name=b,c},DB=Bp("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class DC extends Da("@effect/platform/Error/BadArgument")("BadArgument",{module:DB,method:BA,description:B0(BA),cause:B0(Dk)}){get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}constructor(...a){super(...a),this[Dz]=Dz}}let DD=Bp("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class DE extends Da("@effect/platform/Error/SystemError")("SystemError",{reason:DD,module:DB,method:BA,description:B0(BA),syscall:B0(BA),pathOrDescriptor:B0(BD(BA,BB)),cause:B0(Dk)}){get message(){return`${this.reason}: ${this.module}.${this.method}${void 0!==this.pathOrDescriptor?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}constructor(...a){super(...a),this[Dz]=Dz}}let DF=Symbol.for("effect/QueueEnqueue"),DG=Symbol.for("effect/QueueDequeue"),DH=Symbol.for("effect/QueueStrategy"),DI=Symbol.for("effect/BackingQueue"),DJ={_A:a=>a},DK={_A:a=>a},DL={_In:a=>a},DM={_Out:a=>a};class DN extends b2{constructor(a,b,c,d,e){super(),this[DF]=DL,this[DG]=DM,this.queue=a,this.takers=b,this.shutdownHook=c,this.shutdownFlag=d,this.strategy=e}pipe(){return a7(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return lz(()=>kZ(this.unsafeSize(),()=>ll))}unsafeSize(){return this.shutdownFlag.current?ej():bG(this.queue.length()-xv(this.takers)+this.strategy.surplusSize())}get isEmpty(){return lp(this.size,a=>a<=0)}get isFull(){return lp(this.size,a=>a>=this.capacity())}get shutdown(){return lD(kQ(a=>(aa(this.shutdownFlag,ic(!0)),aa(us(D2(this.takers),b=>nj(b,a.id()),!1,!1),lO(this.strategy.shutdown),lH(nk(this.shutdownHook,void 0)),kT))))}get isShutdown(){return lA(()=>this.shutdownFlag.current)}get awaitShutdown(){return nf(this.shutdownHook)}isActive(){return!this.shutdownFlag.current}unsafeOffer(a){let b;if(this.shutdownFlag.current)return!1;if(0===this.queue.length()){let c=aa(this.takers,xz(xq));c!==xq?(D0(c,a),b=!0):b=!1}else b=!1;if(b)return!0;let c=this.queue.offer(a);return D5(this.strategy,this.queue,this.takers),c}offer(a){return lz(()=>{let b;if(this.shutdownFlag.current)return ll;if(0===this.queue.length()){let c=aa(this.takers,xz(xq));c!==xq?(D0(c,a),b=!0):b=!1}else b=!1;if(b)return ly(!0);let c=this.queue.offer(a);return D5(this.strategy,this.queue,this.takers),c?ly(!0):this.strategy.handleSurplus([a],this.queue,this.takers,this.shutdownFlag)})}offerAll(a){return lz(()=>{if(this.shutdownFlag.current)return ll;let b=eO(a),c=0===this.queue.length()?eO(D3(this.takers,b.length)):fd,[d,e]=aa(b,e8(c.length));for(let a=0;a<c.length;a++)D0(c[a],d[a]);if(0===e.length)return ly(!0);let f=this.queue.offerAll(e);return D5(this.strategy,this.queue,this.takers),gf(f)?ly(!0):this.strategy.handleSurplus(f,this.queue,this.takers,this.shutdownFlag)})}get take(){return kQ(a=>{if(this.shutdownFlag.current)return ll;let b=this.queue.poll(xq);if(b!==xq)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),ly(b);{let b=nc(a.id());return aa(lz(()=>(aa(this.takers,xx(b)),D5(this.strategy,this.queue,this.takers),this.shutdownFlag.current?ll:nf(b))),lt(()=>lA(()=>D4(this.takers,b))))}})}get takeAll(){return lz(()=>this.shutdownFlag.current?ll:lA(()=>{let a=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),fY(a)}))}takeUpTo(a){return lz(()=>this.shutdownFlag.current?ll:lA(()=>{let b=this.queue.pollUpTo(a);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),fY(b)}))}takeBetween(a,b){return lz(()=>DO(this,a,b,fV()))}}let DO=(a,b,c,d)=>c<b?ly(d):aa(DV(a,c),lb(e=>{let f=b-e.length;return 1===f?aa(DU(a),lp(a=>aa(d,f9(e),f4(a)))):f>1?aa(DU(a),lb(b=>DO(a,f-1,c-e.length-1,aa(d,f9(e),f4(b))))):ly(aa(d,f9(e)))})),DP=(a,b)=>aa(nd(),lp(c=>{let d;return d=xu(),new DN(a,d,c,ia(!1),b)}));class DQ{constructor(a){this[DI]=DK,this.mutable=a}poll(a){return xz(this.mutable,a)}pollUpTo(a){return xA(this.mutable,a)}offerAll(a){return xy(this.mutable,a)}offer(a){return xx(this.mutable,a)}capacity(){let a;return void 0===(a=this.mutable).capacity?1/0:a.capacity}length(){return xv(this.mutable)}}let DR=a=>new DQ(a),DS=W(2,(a,b)=>a.offer(b)),DT=W(2,(a,b)=>a.offerAll(b)),DU=a=>a.take,DV=W(2,(a,b)=>a.takeUpTo(b)),DW=W(3,(a,b,c)=>a.takeBetween(b,c)),DX=W(2,(a,b)=>a.takeBetween(b,b)),DY=()=>new D$;class DZ{surplusSize(){return xv(this.putters)}onCompleteTakersWithEmptyQueue(a){for(;!xw(this.putters)&&!xw(a);){let b=xz(a,void 0),c=xz(this.putters,void 0);c[2]&&D0(c[1],!0),D0(b,c[0])}}get shutdown(){return aa(k9,lb(a=>aa(lA(()=>D2(this.putters)),lb(b=>us(b,([b,c,d])=>d?aa(nj(c,a),kT):lF,!1,!1)))))}handleSurplus(a,b,c,d){return kQ(e=>{let f=nc(e.id());return aa(lz(()=>(this.unsafeOffer(a,f),this.unsafeOnQueueEmptySpace(b,c),D5(this,b,c),d.current?ll:nf(f))),lt(()=>lA(()=>this.unsafeRemove(f))))})}unsafeOnQueueEmptySpace(a,b){let c=!0;for(;c&&(a.capacity()===1/0||a.length()<a.capacity());){let d=aa(this.putters,xz(xq));if(d===xq)c=!1;else{let c=a.offer(d[0]);c&&d[2]?D0(d[1],!0):c||D1(this.putters,aa(D2(this.putters),f5(d))),D5(this,a,b)}}}unsafeOffer(a,b){let c=eO(a);for(let a=0;a<c.length;a++){let d=c[a];a===c.length-1?aa(this.putters,xx([d,b,!0])):aa(this.putters,xx([d,b,!1]))}}unsafeRemove(a){D1(this.putters,aa(D2(this.putters),gb(([,b])=>b!==a)))}constructor(){this[DH]=DJ,this.putters=xu()}}class D${surplusSize(){return 0}get shutdown(){return lF}onCompleteTakersWithEmptyQueue(){}handleSurplus(a,b,c,d){return ly(!1)}unsafeOnQueueEmptySpace(a,b){}constructor(){this[DH]=DJ}}class D_{surplusSize(){return 0}get shutdown(){return lF}onCompleteTakersWithEmptyQueue(){}handleSurplus(a,b,c,d){return lA(()=>(this.unsafeOffer(b,a),D5(this,b,c),!0))}unsafeOnQueueEmptySpace(a,b){}unsafeOffer(a,b){let c,d=b[Symbol.iterator](),e=!0;for(;!(c=d.next()).done&&e;){if(0===a.capacity())return;a.poll(xq),e=a.offer(c.value)}}constructor(){this[DH]=DJ}}let D0=(a,b)=>nl(a,ly(b)),D1=(a,b)=>aa(a,xy(b)),D2=a=>aa(a,xA(1/0)),D3=(a,b)=>aa(a,xA(b)),D4=(a,b)=>{D1(a,aa(D2(a),gb(a=>b!==a)))},D5=(a,b,c)=>{let d=!0;for(;d&&0!==b.length();){let e=aa(c,xz(xq));if(e!==xq){let f=b.poll(xq);f!==xq?(D0(e,f),a.unsafeOnQueueEmptySpace(b,c)):D1(c,aa(D2(c),f5(e))),d=!0}else d=!1}d&&0===b.length()&&!xw(c)&&a.onCompleteTakersWithEmptyQueue(c)},D6=a=>aa(lA(()=>xt(a)),lb(a=>DP(DR(a),new DZ))),D7=a=>aa(lA(()=>xt(a)),lb(a=>DP(DR(a),DY()))),D8=a=>aa(lA(()=>xt(a)),lb(a=>DP(DR(a),new D_))),D9=()=>aa(lA(()=>xu()),lb(a=>DP(DR(a),DY()))),Ea=a=>a.shutdown,Eb=W(2,(a,b)=>mb(ud,b)(a)),Ec=a=>wm(uR(ul,h_(a))),Ed=a=>wv(lp(a,Ec)),Ee=a=>(a=>{let b=bY("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return we(wl(b,a),a=>bV(a,b))})(lp(a,Ec)),Ef=a=>wm(uR(ul,h0(a))),Eg=W(2,(a,b)=>we(Ef(a),()=>Ec(b))),Eh=W(2,(a,b)=>we(Ef(a),()=>Ed(b))),Ei=W(2,(a,b)=>we(Ef(a),()=>Ee(b))),Ej=Symbol.for("effect/PubSub/AbsentValue"),Ek=(a,b)=>c=>{c.has(a)||c.set(a,new Set),c.get(a).add(b)},El=(a,b)=>c=>{if(!c.has(a))return;let d=c.get(a);d.delete(b),0===d.size&&c.delete(a)},Em=a=>{let b="number"==typeof a?{capacity:a}:a;EA(b.capacity);let c=b.replay&&b.replay>0?new EN(Math.ceil(b.replay)):void 0;return 1===b.capacity?new Er(c):Math.max(Math.pow(2,Math.ceil(Math.log(b.capacity)/Math.log(2))),2)===b.capacity?new Ep(b.capacity,c):new En(b.capacity,c)};class En{constructor(a,b){this.publisherIndex=0,this.subscriberCount=0,this.subscribersIndex=0,this.capacity=a,this.replayBuffer=b,this.array=Array.from({length:a}),this.subscribers=Array.from({length:a})}replayWindow(){return this.replayBuffer?new EO(this.replayBuffer):EP}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(a){if(this.isFull())return!1;if(0!==this.subscriberCount){let b=this.publisherIndex%this.capacity;this.array[b]=a,this.subscribers[b]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(a),!0}publishAll(a){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(a),fV();let b=fY(a),c=b.length,d=this.publisherIndex-this.subscribersIndex,e=Math.min(c,this.capacity-d);if(0===e)return b;let f=0,g=this.publisherIndex+e;for(;this.publisherIndex!==g;){let a=f3(b,f++),c=this.publisherIndex%this.capacity;this.array[c]=a,this.subscribers[c]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(a)}return f7(b,f)}slide(){if(this.subscribersIndex!==this.publisherIndex){let a=this.subscribersIndex%this.capacity;this.array[a]=Ej,this.subscribers[a]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new Eo(this,this.publisherIndex,!1)}}class Eo{constructor(a,b,c){this.self=a,this.subscriberIndex=b,this.unsubscribed=c}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(a){if(this.unsubscribed)return a;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let a=this.subscriberIndex%this.self.capacity,b=this.self.array[a];return this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),this.subscriberIndex+=1,b}return a}pollUpTo(a){if(this.unsubscribed)return fV();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let b=Math.min(a,this.self.publisherIndex-this.subscriberIndex);if(b<=0)return fV();let c=[],d=this.subscriberIndex+b;for(;this.subscriberIndex!==d;){let a=this.subscriberIndex%this.self.capacity,b=this.self.array[a];this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),c.push(b),this.subscriberIndex+=1}return fY(c)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let a=this.subscriberIndex%this.self.capacity;this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class Ep{constructor(a,b){this.publisherIndex=0,this.subscriberCount=0,this.subscribersIndex=0,this.capacity=a,this.replayBuffer=b,this.array=Array.from({length:a}),this.mask=a-1,this.subscribers=Array.from({length:a})}replayWindow(){return this.replayBuffer?new EO(this.replayBuffer):EP}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(a){if(this.isFull())return!1;if(0!==this.subscriberCount){let b=this.publisherIndex&this.mask;this.array[b]=a,this.subscribers[b]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(a),!0}publishAll(a){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(a),fV();let b=fY(a),c=b.length,d=this.publisherIndex-this.subscribersIndex,e=Math.min(c,this.capacity-d);if(0===e)return b;let f=0,g=this.publisherIndex+e;for(;this.publisherIndex!==g;){let a=f3(b,f++),c=this.publisherIndex&this.mask;this.array[c]=a,this.subscribers[c]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(a)}return f7(b,f)}slide(){if(this.subscribersIndex!==this.publisherIndex){let a=this.subscribersIndex&this.mask;this.array[a]=Ej,this.subscribers[a]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new Eq(this,this.publisherIndex,!1)}}class Eq{constructor(a,b,c){this.self=a,this.subscriberIndex=b,this.unsubscribed=c}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(a){if(this.unsubscribed)return a;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let a=this.subscriberIndex&this.self.mask,b=this.self.array[a];return this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),this.subscriberIndex+=1,b}return a}pollUpTo(a){if(this.unsubscribed)return fV();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let b=Math.min(a,this.self.publisherIndex-this.subscriberIndex);if(b<=0)return fV();let c=[],d=this.subscriberIndex+b;for(;this.subscriberIndex!==d;){let a=this.subscriberIndex&this.self.mask,b=this.self.array[a];this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),c.push(b),this.subscriberIndex+=1}return fY(c)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let a=this.subscriberIndex&this.self.mask;this.self.subscribers[a]-=1,0===this.self.subscribers[a]&&(this.self.array[a]=Ej,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class Er{constructor(a){this.publisherIndex=0,this.subscriberCount=0,this.subscribers=0,this.value=Ej,this.capacity=1,this.replayBuffer=a}replayWindow(){return this.replayBuffer?new EO(this.replayBuffer):EP}pipe(){return a7(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(a){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=a,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(a),!0)}publishAll(a){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(a),fV();let b=fY(a);return gf(b)?b:this.publish(gi(b))?f7(b,1):b}slide(){this.isFull()&&(this.subscribers=0,this.value=Ej),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new Es(this,this.publisherIndex,!1)}}class Es{constructor(a,b,c){this.self=a,this.subscriberIndex=b,this.unsubscribed=c}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(a){if(this.isEmpty())return a;let b=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Ej),this.subscriberIndex+=1,b}pollUpTo(a){if(this.isEmpty()||a<1)return fV();let b=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Ej),this.subscriberIndex+=1,fX(b)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Ej)))}}class Et{constructor(a){this.publisherHead={value:Ej,subscribers:0,next:null},this.publisherTail=this.publisherHead,this.publisherIndex=0,this.subscribersIndex=0,this.capacity=Number.MAX_SAFE_INTEGER,this.replayBuffer=a}replayWindow(){return this.replayBuffer?new EO(this.replayBuffer):EP}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(a){let b=this.publisherTail.subscribers;return 0!==b&&(this.publisherTail.next={value:a,subscribers:b,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(a),!0}publishAll(a){if(0!==this.publisherTail.subscribers)for(let b of a)this.publish(b);else this.replayBuffer&&this.replayBuffer.offerAll(a);return fV()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=Ej,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new Eu(this,this.publisherTail,this.publisherIndex,!1)}}class Eu{constructor(a,b,c,d){this.self=a,this.subscriberHead=b,this.subscriberIndex=c,this.unsubscribed=d}isEmpty(){if(this.unsubscribed)return!0;let a=!0,b=!0;for(;b;)this.subscriberHead===this.self.publisherTail?b=!1:this.subscriberHead.next.value!==Ej?(a=!1,b=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return a}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(a){if(this.unsubscribed)return a;let b=!0,c=a;for(;b;)if(this.subscriberHead===this.self.publisherTail)b=!1;else{let a=this.subscriberHead.next.value;a!==Ej&&(c=a,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Ej,this.self.subscribersIndex+=1),b=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return c}pollUpTo(a){let b=[],c=0;for(;c!==a;){let d=this.poll(Ej);d===Ej?c=a:(b.push(d),c+=1)}return fY(b)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==Ej&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Ej,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class Ev extends b2{static{j=DG}constructor(a,b,c,d,e,f,g,h){super(),this[j]=DM,this.pubsub=a,this.subscribers=b,this.subscription=c,this.pollers=d,this.shutdownHook=e,this.shutdownFlag=f,this.strategy=g,this.replayWindow=h}commit(){return this.take}pipe(){return a7(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!this.shutdownFlag.current}get size(){return lz(()=>this.shutdownFlag.current?ll:ly(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return this.shutdownFlag.current?ej():bG(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return lz(()=>this.shutdownFlag.current?ll:ly(this.subscription.size()===this.capacity()))}get isEmpty(){return lp(this.size,a=>0===a)}get shutdown(){return lD(kQ(a=>(ic(this.shutdownFlag,!0),aa(ur(ED(this.pollers),b=>nj(b,a.id()),!1),lO(lA(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),lH(nk(this.shutdownHook,void 0)),kT))))}get isShutdown(){return lA(()=>this.shutdownFlag.current)}get awaitShutdown(){return nf(this.shutdownHook)}get take(){return kQ(a=>{if(this.shutdownFlag.current)return ll;if(this.replayWindow.remaining>0)return ly(this.replayWindow.take());let b=xw(this.pollers)?this.subscription.poll(xq):xq;if(b!==xq)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),ly(b);{let b=nc(a.id());return aa(lz(()=>(aa(this.pollers,xx(b)),aa(this.subscribers,Ek(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),this.shutdownFlag.current?ll:nf(b))),lt(()=>lA(()=>EH(this.pollers,b))))}})}get takeAll(){return lz(()=>{if(this.shutdownFlag.current)return ll;let a=xw(this.pollers)?EE(this.subscription):fV();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?ly(f9(this.replayWindow.takeAll(),a)):ly(a)})}takeUpTo(a){return lz(()=>{let b;if(this.shutdownFlag.current)return ll;if(this.replayWindow.remaining>=a)return ly(this.replayWindow.takeN(a));this.replayWindow.remaining>0&&(b=this.replayWindow.takeAll(),a-=b.length);let c=xw(this.pollers)?EF(this.subscription,a):fV();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),b?ly(f9(b,c)):ly(c)})}takeBetween(a,b){return lz(()=>Ew(this,a,b,fV()))}}let Ew=(a,b,c,d)=>c<b?ly(d):aa(a.takeUpTo(c),lb(e=>{let f=b-e.length;return 1===f?aa(a.take,lp(a=>aa(d,f9(e),f4(a)))):f>1?aa(a.take,lb(b=>Ew(a,f-1,c-e.length-1,aa(d,f9(e),f4(b))))):ly(aa(d,f9(e)))}));class Ex{static{k=DF,l=DG}constructor(a,b,c,d,e,f){this[k]=DL,this[l]=DM,this.pubsub=a,this.subscribers=b,this.scope=c,this.shutdownHook=d,this.shutdownFlag=e,this.strategy=f}capacity(){return this.pubsub.capacity}get size(){return lz(()=>this.shutdownFlag.current?ll:lA(()=>this.pubsub.size()))}unsafeSize(){return this.shutdownFlag.current?ej():bG(this.pubsub.size())}get isFull(){return lp(this.size,a=>a===this.capacity())}get isEmpty(){return lp(this.size,a=>0===a)}get awaitShutdown(){return nf(this.shutdownHook)}get isShutdown(){return lA(()=>this.shutdownFlag.current)}get shutdown(){return lD(kQ(a=>(aa(this.shutdownFlag,ic(!0)),aa(this.scope.close(m2(a.id())),lO(this.strategy.shutdown),lH(nk(this.shutdownHook,void 0)),kT))))}publish(a){return lz(()=>this.shutdownFlag.current?ll:this.pubsub.publish(a)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),ly(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,fX(a),this.shutdownFlag))}isActive(){return!this.shutdownFlag.current}unsafeOffer(a){return!this.shutdownFlag.current&&!!this.pubsub.publish(a)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(a){return lz(()=>{if(this.shutdownFlag.current)return ll;let b=EG(this.pubsub,a);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),gf(b))?ly(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,b,this.shutdownFlag)})}get subscribe(){let a,b,c,d=lB(up([this.scope.fork(qZ),(a=this.pubsub,b=this.subscribers,c=this.strategy,lp(nd(),d=>{let e,f,g,h,i,j;return e=a,f=b,g=a.subscribe(),h=xu(),i=d,j=ia(!1),new Ev(e,f,g,h,i,j,c,e.replayWindow())}))]),a=>a[0].addFinalizer(()=>a[1].shutdown));return lp(un(d,(a,b)=>a[0].close(b)),a=>a[1])}offer(a){return this.publish(a)}offerAll(a){return this.publishAll(a)}pipe(){return a7(this,arguments)}}let Ey=(a,b)=>lb(uN(),c=>lp(nd(),d=>Ez(a,new Map,c,d,ia(!1),b))),Ez=(a,b,c,d,e,f)=>new Ex(a,b,c,d,e,f),EA=a=>{if(a<=0)throw new mQ(`Cannot construct PubSub with capacity of ${a}`)},EB=(a,b)=>{nl(a,ly(b))},EC=(a,b)=>aa(a,xy(b)),ED=a=>aa(a,xA(1/0)),EE=a=>a.pollUpTo(1/0),EF=(a,b)=>a.pollUpTo(b),EG=(a,b)=>a.publishAll(b),EH=(a,b)=>{EC(a,aa(ED(a),gb(a=>a!==b)))};class EI{get shutdown(){return lb(k9,a=>lb(lA(()=>ED(this.publishers)),b=>us(b,([b,c,d])=>d?aa(nj(c,a),kT):lF,!1,!1)))}handleSurplus(a,b,c,d){return kQ(e=>{let f=nc(e.id());return aa(lz(()=>(this.unsafeOffer(c,f),this.unsafeOnPubSubEmptySpace(a,b),this.unsafeCompleteSubscribers(a,b),d.current?ll:nf(f))),lt(()=>lA(()=>this.unsafeRemove(f))))})}unsafeOnPubSubEmptySpace(a,b){let c=!0;for(;c&&!a.isFull();){let d=aa(this.publishers,xz(xq));if(d===xq)c=!1;else{let c=a.publish(d[0]);c&&d[2]?EB(d[1],!0):c||EC(this.publishers,aa(ED(this.publishers),f5(d))),this.unsafeCompleteSubscribers(a,b)}}}unsafeCompletePollers(a,b,c,d){return EL(this,a,b,c,d)}unsafeCompleteSubscribers(a,b){return EM(this,a,b)}unsafeOffer(a,b){let c=a[Symbol.iterator](),d=c.next();if(!d.done)for(;;){let a=d.value;if((d=c.next()).done){aa(this.publishers,xx([a,b,!0]));break}aa(this.publishers,xx([a,b,!1]))}}unsafeRemove(a){EC(this.publishers,aa(ED(this.publishers),gb(([b,c])=>c!==a)))}constructor(){this.publishers=xu()}}class EJ{get shutdown(){return lF}handleSurplus(a,b,c,d){return ly(!1)}unsafeOnPubSubEmptySpace(a,b){}unsafeCompletePollers(a,b,c,d){return EL(this,a,b,c,d)}unsafeCompleteSubscribers(a,b){return EM(this,a,b)}}class EK{get shutdown(){return lF}handleSurplus(a,b,c,d){return lA(()=>(this.unsafeSlidingPublish(a,c),this.unsafeCompleteSubscribers(a,b),!0))}unsafeOnPubSubEmptySpace(a,b){}unsafeCompletePollers(a,b,c,d){return EL(this,a,b,c,d)}unsafeCompleteSubscribers(a,b){return EM(this,a,b)}unsafeSlidingPublish(a,b){let c=b[Symbol.iterator](),d=c.next();if(!d.done&&a.capacity>0){let b=d.value,e=!0;for(;e;){a.slide();let f=a.publish(b);f&&(d=c.next())&&!d.done?b=d.value:f&&(e=!1)}}}}let EL=(a,b,c,d,e)=>{let f=!0;for(;f&&!d.isEmpty();){let g=aa(e,xz(xq));if(g===xq)aa(c,El(d,e)),xw(e)?f=!1:aa(c,Ek(d,e));else{let f=d.poll(xq);f===xq?EC(e,aa(ED(e),f5(g))):(EB(g,f),a.unsafeOnPubSubEmptySpace(b,c))}}},EM=(a,b,c)=>{for(let[d,e]of c)for(let f of e)a.unsafeCompletePollers(b,c,d,f)};class EN{constructor(a){this.head={value:Ej,next:null},this.tail=this.head,this.size=0,this.index=0,this.capacity=a}slide(){this.index++}offer(a){this.tail.value=a,this.tail.next={value:Ej,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(a){for(let b of a)this.offer(b)}}class EO{constructor(a){this.buffer=a,this.index=a.index,this.remaining=a.size,this.head=a.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let a=this.head.value;return this.head=this.head.next,a}takeN(a){if(0===this.remaining)return fV();this.index<this.buffer.index&&this.fastForward();let b=Math.min(a,this.remaining),c=Array(b);for(let a=0;a<b;a++){let b=this.head.value;this.head=this.head.next,c[a]=b}return this.remaining-=b,f1(c)}takeAll(){return this.takeN(this.remaining)}}let EP={remaining:0,take:()=>void 0,takeN:()=>fV(),takeAll:()=>fV()},EQ=a=>lz(()=>Ey(Em(a),new EI)),ER="Continue",ES=Symbol.for("effect/ChannelChildExecutorDecision"),ET={[ES]:ES},EU=a=>{let b=Object.create(ET);return b._tag=ER,b},EV="ContinuationK",EW=Symbol.for("effect/ChannelContinuation"),EX={_Env:a=>a,_InErr:a=>a,_InElem:a=>a,_InDone:a=>a,_OutErr:a=>a,_OutDone:a=>a,_OutErr2:a=>a,_OutElem:a=>a,_OutDone2:a=>a};class EY{constructor(a,b){this._tag=EV,this[EW]=EX,this.onSuccess=a,this.onHalt=b}onExit(a){return"Failure"===a._tag?this.onHalt(a.cause):this.onSuccess(a.value)}}class EZ{constructor(a){this._tag="ContinuationFinalizer",this[EW]=EX,this.finalizer=a}}let E$="PullAfterNext",E_={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:a=>a}},E0=a=>{let b=Object.create(E_);return b._tag=E$,b.emitSeparator=a,b},E1="BracketOut",E2="Bridge",E3="ConcatAll",E4="Emit",E5="Ensuring",E6="Fail",E7="Fold",E8="FromEffect",E9="PipeTo",Fa="Provide",Fb="Read",Fc="Succeed",Fd="SucceedNow",Fe="Suspend",Ff=Symbol.for("effect/Channel"),Fg={[Ff]:{_Env:a=>a,_InErr:a=>a,_InElem:a=>a,_InDone:a=>a,_OutErr:a=>a,_OutElem:a=>a,_OutDone:a=>a},pipe(){return a7(this,arguments)}},Fh=a=>ap(a,Ff)||kP(a),Fi=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E1,c.acquire=()=>a,c.finalizer=b,c}),Fj=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E7,c.channel=a,c.k=new EY(FA,b),c}),Fk=a=>FC(()=>{let b=[];return Ft(Fw(a,Fl(b)),a=>FD(()=>[fY(b),a]))}),Fl=a=>Fy({onInput:b=>Ft(FD(()=>{a.push(b)}),()=>Fl(a)),onFailure:Fq,onDone:FB}),Fm=(a,b,c)=>{let d=Object.create(Fg);return d._tag=E3,d.combineInners=b,d.combineAll=c,d.onPull=()=>E0(ej()),d.onEmit=()=>EU,d.value=()=>a,d.k=X,d},Fn=W(4,(a,b,c,d)=>{let e=Object.create(Fg);return e._tag=E3,e.combineInners=c,e.combineAll=d,e.onPull=()=>E0(ej()),e.onEmit=()=>EU,e.value=()=>a,e.k=b,e}),Fo=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E2,c.input=b,c.channel=a,c}),Fp=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E5,c.channel=a,c.finalizer=b,c}),Fq=a=>Fr(j1(a)),Fr=a=>Fs(()=>a),Fs=a=>{let b=Object.create(Fg);return b._tag=E6,b.error=a,b},Ft=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E7,c.channel=a,c.k=new EY(b,Fr),c}),Fu=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E7,c.channel=a,c.k=new EY(b.onSuccess,b.onFailure),c}),Fv=a=>{let b=Object.create(Fg);return b._tag=E8,b.effect=()=>a,b},Fw=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=E9,c.left=()=>a,c.right=()=>b,c}),Fx=W(2,(a,b)=>{let c=Object.create(Fg);return c._tag=Fa,c.context=()=>b,c.inner=a,c}),Fy=a=>Fz({onInput:a.onInput,onFailure:b=>dy(kd(b),{onLeft:a.onFailure,onRight:Fr}),onDone:a.onDone}),Fz=a=>{let b=Object.create(Fg);return b._tag=Fb,b.more=a.onInput,b.done=new EY(a.onDone,a.onFailure),b},FA=a=>FD(()=>a),FB=a=>{let b=Object.create(Fg);return b._tag=Fd,b.terminal=a,b},FC=a=>{let b=Object.create(Fg);return b._tag=Fe,b.channel=a,b},FD=a=>{let b=Object.create(Fg);return b._tag=Fc,b.evaluate=a,b},FE=FB(void 0),FF=a=>{let b=Object.create(Fg);return b._tag=E4,b.out=a,b},FG="Done",FH="Emit",FI="FromEffect",FJ="Read",FK={[Symbol.for("effect/ChannelState")]:{_E:a=>a,_R:a=>a}},FL=()=>{let a=Object.create(FK);return a._tag=FG,a},FM=()=>{let a=Object.create(FK);return a._tag=FH,a},FN=a=>{let b=Object.create(FK);return b._tag=FI,b.effect=a,b},FO=(a,b,c,d)=>{let e=Object.create(FK);return e._tag=FJ,e.upstream=a,e.onEffect=b,e.onEmit=c,e.onDone=d,e},FP=a=>a._tag===FI,FQ=a=>FP(a)?pH(a.effect,{onFailure:_,onSuccess:_}):void 0,FR="PullFromChild",FS="PullFromUpstream",FT="DrainChildExecutors",FU="Emit";class FV{constructor(a,b,c){this._tag=FR,this.childExecutor=a,this.parentSubexecutor=b,this.onEmit=c}close(a){let b=this.childExecutor.close(a),c=this.parentSubexecutor.close(a);return void 0!==b&&void 0!==c?uI(k4(b),k4(c),(a,b)=>aa(a,m9(b))):void 0!==b?b:void 0!==c?c:void 0}enqueuePullFromChild(a){return this}}class FW{constructor(a,b,c,d,e,f,g,h){this._tag=FS,this.upstreamExecutor=a,this.createChild=b,this.lastDone=c,this.activeChildExecutors=d,this.combineChildResults=e,this.combineWithChildResult=f,this.onPull=g,this.onEmit=h}close(a){let b=this.upstreamExecutor.close(a);return[...this.activeChildExecutors.map(b=>void 0!==b?b.childExecutor.close(a):void 0),b].reduce((a,b)=>void 0!==a&&void 0!==b?uI(a,k4(b),(a,b)=>m9(a,b)):void 0!==a?a:void 0!==b?k4(b):void 0,void 0)}enqueuePullFromChild(a){return new FW(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,a],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class FX{constructor(a,b,c,d,e,f,g){this._tag=FT,this.upstreamExecutor=a,this.lastDone=b,this.activeChildExecutors=c,this.upstreamDone=d,this.combineChildResults=e,this.combineWithChildResult=f,this.onPull=g}close(a){let b=this.upstreamExecutor.close(a);return[...this.activeChildExecutors.map(b=>void 0!==b?b.childExecutor.close(a):void 0),b].reduce((a,b)=>void 0!==a&&void 0!==b?uI(a,k4(b),(a,b)=>m9(a,b)):void 0!==a?a:void 0!==b?k4(b):void 0,void 0)}enqueuePullFromChild(a){return new FX(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,a],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class FY{constructor(a,b){this._tag=FU,this.value=a,this.next=b}close(a){return this.next.close(a)}enqueuePullFromChild(a){return this}}let FZ={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:a=>a}},F$=a=>{let b=Object.create(FZ);return b._tag="Pulled",b.value=a,b};class F_{constructor(a,b,c){this._activeSubexecutor=void 0,this._cancelled=void 0,this._closeLastSubstream=void 0,this._done=void 0,this._doneStack=[],this._emitted=void 0,this._input=void 0,this._inProgressFinalizer=void 0,this._currentChannel=a,this._executeCloseLastSubstream=c,this._providedEnv=b}run(){let a;for(;void 0===a;)if(void 0!==this._cancelled)a=this.processCancellation();else if(void 0!==this._activeSubexecutor)a=this.runSubexecutor();else try{if(void 0===this._currentChannel)a=FL();else switch(kP(this._currentChannel)&&(this._currentChannel=Fv(this._currentChannel)),this._currentChannel._tag){case E1:a=this.runBracketOut(this._currentChannel);break;case E2:{let b=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let c=this._input;this._input=void 0;let d=()=>lb(b.awaitRead(),()=>lz(()=>{let a=c.run();switch(a._tag){case FG:return m4(c.getDone(),{onFailure:a=>b.error(a),onSuccess:a=>b.done(a)});case FH:return lb(b.emit(c.getEmit()),()=>d());case FI:return lg(a.effect,{onFailure:a=>b.error(a),onSuccess:()=>d()});case FJ:return F2(a,()=>d(),a=>b.error(a))}}));a=FN(lb(uu(ln(d())),a=>lA(()=>this.addFinalizer(b=>lb(lR(a),()=>lz(()=>{let a=this.restorePipe(b,c);return void 0!==a?a:lF}))))))}break}case E3:{let a=new F_(this._currentChannel.value(),this._providedEnv,a=>lA(()=>{let b=void 0===this._closeLastSubstream?lF:this._closeLastSubstream;this._closeLastSubstream=aa(b,uH(a))}));a._input=this._input;let b=this._currentChannel;this._activeSubexecutor=new FW(a,a=>b.k(a),void 0,[],(a,c)=>b.combineInners(a,c),(a,c)=>b.combineAll(a,c),a=>b.onPull(a),a=>b.onEmit(a)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case E4:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:FE,a=FM();break;case E5:this.runEnsuring(this._currentChannel);break;case E6:a=this.doneHalt(this._currentChannel.error());break;case E7:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case E8:{let b=void 0===this._providedEnv?this._currentChannel.effect():aa(this._currentChannel.effect(),wy(this._providedEnv));a=FN(lg(b,{onFailure:a=>{let b=this.doneHalt(a);return void 0!==b&&FP(b)?b.effect:lF},onSuccess:a=>{let b=this.doneSucceed(a);return void 0!==b&&FP(b)?b.effect:lF}}));break}case E9:{let a=this._input,b=new F_(this._currentChannel.left(),this._providedEnv,a=>this._executeCloseLastSubstream(a));b._input=a,this._input=b,this.addFinalizer(b=>{let c=this.restorePipe(b,a);return void 0!==c?c:lF}),this._currentChannel=this._currentChannel.right();break}case Fa:{let a=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>lA(()=>{this._providedEnv=a}));break}case Fb:{let b=this._currentChannel;a=FO(this._input,X,a=>{try{this._currentChannel=b.more(a)}catch(a){this._currentChannel=b.done.onExit(mZ(a))}},a=>{let c=a=>b.done.onExit(a);this._currentChannel=c(a)});break}case Fc:a=this.doneSucceed(this._currentChannel.evaluate());break;case Fd:a=this.doneSucceed(this._currentChannel.terminal);break;case Fe:this._currentChannel=this._currentChannel.channel()}}catch(a){this._currentChannel=Fr(j2(a))}return a}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(a){this._cancelled=a}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(a){this._inProgressFinalizer=a}popAllFinalizers(a){let b=[],c=this._doneStack.pop();for(;c;)"ContinuationFinalizer"===c._tag&&b.push(c.finalizer),c=this._doneStack.pop();let d=0===b.length?lF:F1(b,a);return this.storeInProgressFinalizer(d),d}popNextFinalizers(){let a=[];for(;0!==this._doneStack.length;){let b=this._doneStack[this._doneStack.length-1];if(b._tag===EV)break;a.push(b),this._doneStack.pop()}return a}restorePipe(a,b){let c=this._input;return(this._input=b,void 0!==c)?c.close(a):lF}close(a){let b,c,d=this._inProgressFinalizer;void 0!==d&&(b=aa(d,uY(lA(()=>this.clearInProgressFinalizer()))));let e=this.popAllFinalizers(a);void 0!==e&&(c=aa(e,uY(lA(()=>this.clearInProgressFinalizer()))));let f=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(a);if(void 0!==f||void 0!==b||void 0!==c)return aa(k4(F0(f)),uF(k4(F0(b))),uF(k4(F0(c))),lp(([[a,b],c])=>aa(a,m9(b),m9(c))),lD,lb(a=>lz(()=>a)))}doneSucceed(a){if(0===this._doneStack.length)return this._done=m6(a),this._currentChannel=void 0,FL();let b=this._doneStack[this._doneStack.length-1];if(b._tag===EV){this._doneStack.pop(),this._currentChannel=b.onSuccess(a);return}let c=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=c.reverse(),this._done=m6(a),this._currentChannel=void 0,FL();let d=F1(c.map(a=>a.finalizer),m6(a));return this.storeInProgressFinalizer(d),FN(aa(d,uY(lA(()=>this.clearInProgressFinalizer())),lD,lb(()=>lA(()=>this.doneSucceed(a)))))}doneHalt(a){if(0===this._doneStack.length)return this._done=m_(a),this._currentChannel=void 0,FL();let b=this._doneStack[this._doneStack.length-1];if(b._tag===EV){this._doneStack.pop();try{this._currentChannel=b.onHalt(a)}catch(a){this._currentChannel=Fr(j2(a))}return}let c=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=c.reverse(),this._done=m_(a),this._currentChannel=void 0,FL();let d=F1(c.map(a=>a.finalizer),m_(a));return this.storeInProgressFinalizer(d),FN(aa(d,uY(lA(()=>this.clearInProgressFinalizer())),lD,lb(()=>lA(()=>this.doneHalt(a)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,FL()}runBracketOut(a){return FN(lD(lg(this.provide(a.acquire()),{onFailure:a=>lA(()=>{this._currentChannel=Fr(a)}),onSuccess:b=>lA(()=>{this.addFinalizer(c=>this.provide(a.finalizer(b,c))),this._currentChannel=FF(b)})})))}provide(a){return void 0===this._providedEnv?a:aa(a,wy(this._providedEnv))}runEnsuring(a){this.addFinalizer(a.finalizer),this._currentChannel=a.channel}addFinalizer(a){this._doneStack.push(new EZ(a))}runSubexecutor(){let a=this._activeSubexecutor;switch(a._tag){case FR:return this.pullFromChild(a.childExecutor,a.parentSubexecutor,a.onEmit,a);case FS:return this.pullFromUpstream(a);case FT:return this.drainChildExecutors(a);case FU:return this._emitted=a.value,this._activeSubexecutor=a.next,FM()}}replaceSubexecutor(a){this._currentChannel=void 0,this._activeSubexecutor=a}finishWithExit(a){let b=m4(a,{onFailure:a=>this.doneHalt(a),onSuccess:a=>this.doneSucceed(a)});return this._activeSubexecutor=void 0,void 0===b?lF:FP(b)?b.effect:lF}finishSubexecutorWithCloseEffect(a,...b){this.addFinalizer(()=>aa(b,uq(b=>aa(lA(()=>b(a)),lb(a=>void 0!==a?a:lF)),{discard:!0})));let c=aa(a,m4({onFailure:a=>this.doneHalt(a),onSuccess:a=>this.doneSucceed(a)}));return this._activeSubexecutor=void 0,c}applyUpstreamPullStrategy(a,b,c){switch(c._tag){case E$:{let d=!a||b.some(a=>void 0!==a);return[c.emitSeparator,d?[void 0,...b]:b]}case"PullAfterAllEnqueued":{let d=!a||b.some(a=>void 0!==a);return[c.emitSeparator,d?[...b,void 0]:b]}}}pullFromChild(a,b,c,d){return FO(a,X,e=>{let f=c(e);switch(f._tag){case ER:break;case"Close":this.finishWithDoneValue(a,b,f.value);break;case"Yield":{let a=b.enqueuePullFromChild(d);this.replaceSubexecutor(a)}}this._activeSubexecutor=new FY(e,this._activeSubexecutor)},m4({onFailure:c=>{let d=this.handleSubexecutorFailure(a,b,c);return void 0===d?void 0:FQ(d)},onSuccess:c=>{this.finishWithDoneValue(a,b,c)}}))}finishWithDoneValue(a,b,c){switch(b._tag){case FS:{let d=new FW(b.upstreamExecutor,b.createChild,void 0!==b.lastDone?b.combineChildResults(b.lastDone,c):c,b.activeChildExecutors,b.combineChildResults,b.combineWithChildResult,b.onPull,b.onEmit);this._closeLastSubstream=a.close(m6(c)),this.replaceSubexecutor(d);break}case FT:{let d=new FX(b.upstreamExecutor,void 0!==b.lastDone?b.combineChildResults(b.lastDone,c):c,b.activeChildExecutors,b.upstreamDone,b.combineChildResults,b.combineWithChildResult,b.onPull);this._closeLastSubstream=a.close(m6(c)),this.replaceSubexecutor(d)}}}handleSubexecutorFailure(a,b,c){return this.finishSubexecutorWithCloseEffect(m_(c),a=>b.close(a),b=>a.close(b))}pullFromUpstream(a){if(0===a.activeChildExecutors.length)return this.performPullFromUpstream(a);let b=a.activeChildExecutors[0],c=new FW(a.upstreamExecutor,a.createChild,a.lastDone,a.activeChildExecutors.slice(1),a.combineChildResults,a.combineWithChildResult,a.onPull,a.onEmit);if(void 0===b)return this.performPullFromUpstream(c);this.replaceSubexecutor(new FV(b.childExecutor,c,b.onEmit))}performPullFromUpstream(a){return FO(a.upstreamExecutor,a=>{let b=void 0===this._closeLastSubstream?lF:this._closeLastSubstream;return this._closeLastSubstream=void 0,aa(this._executeCloseLastSubstream(b),uH(a))},b=>{if(void 0!==this._closeLastSubstream){let c=this._closeLastSubstream;return this._closeLastSubstream=void 0,aa(this._executeCloseLastSubstream(c),lp(()=>{let c=new F_(a.createChild(b),this._providedEnv,this._executeCloseLastSubstream);c._input=this._input;let[d,e]=this.applyUpstreamPullStrategy(!1,a.activeChildExecutors,a.onPull(F$(b)));this._activeSubexecutor=new FV(c,new FW(a.upstreamExecutor,a.createChild,a.lastDone,e,a.combineChildResults,a.combineWithChildResult,a.onPull,a.onEmit),a.onEmit),bE(d)&&(this._activeSubexecutor=new FY(d.value,this._activeSubexecutor))}))}let c=new F_(a.createChild(b),this._providedEnv,this._executeCloseLastSubstream);c._input=this._input;let[d,e]=this.applyUpstreamPullStrategy(!1,a.activeChildExecutors,a.onPull(F$(b)));this._activeSubexecutor=new FV(c,new FW(a.upstreamExecutor,a.createChild,a.lastDone,e,a.combineChildResults,a.combineWithChildResult,a.onPull,a.onEmit),a.onEmit),bE(d)&&(this._activeSubexecutor=new FY(d.value,this._activeSubexecutor))},b=>{if(a.activeChildExecutors.some(a=>void 0!==a)){let b=new FX(a.upstreamExecutor,a.lastDone,[void 0,...a.activeChildExecutors],a.upstreamExecutor.getDone(),a.combineChildResults,a.combineWithChildResult,a.onPull);if(void 0!==this._closeLastSubstream){let a=this._closeLastSubstream;return this._closeLastSubstream=void 0,aa(this._executeCloseLastSubstream(a),lp(()=>this.replaceSubexecutor(b)))}return void this.replaceSubexecutor(b)}let c=this._closeLastSubstream,d=this.finishSubexecutorWithCloseEffect(aa(b,m3(b=>a.combineWithChildResult(a.lastDone,b))),()=>c,b=>a.upstreamExecutor.close(b));return void 0===d?void 0:FQ(d)})}drainChildExecutors(a){if(0===a.activeChildExecutors.length){let b=this._closeLastSubstream;return void 0!==b&&this.addFinalizer(()=>ly(b)),this.finishSubexecutorWithCloseEffect(a.upstreamDone,()=>b,b=>a.upstreamExecutor.close(b))}let b=a.activeChildExecutors[0],c=a.activeChildExecutors.slice(1);if(void 0===b){let[b,d]=this.applyUpstreamPullStrategy(!0,c,a.onPull((a=>{let b=Object.create(FZ);return b._tag="NoUpstream",b.activeDownstreamCount=a,b})(c.reduce((a,b)=>void 0!==b?a+1:a,0))));return(this.replaceSubexecutor(new FX(a.upstreamExecutor,a.lastDone,d,a.upstreamDone,a.combineChildResults,a.combineWithChildResult,a.onPull)),bE(b))?(this._emitted=b.value,FM()):void 0}let d=new FX(a.upstreamExecutor,a.lastDone,c,a.upstreamDone,a.combineChildResults,a.combineWithChildResult,a.onPull);this.replaceSubexecutor(new FV(b.childExecutor,d,b.onEmit))}}let F0=a=>void 0!==a?a:lF,F1=(a,b)=>aa(uq(a,a=>k4(a(b))),lp(a=>aa(mY(a),el(()=>m7))),lb(a=>lz(()=>a))),F2=(a,b,c)=>{let d=[a],e=()=>{let a=d.pop();if(void 0===a||void 0===a.upstream)return k2("Unexpected end of input for channel execution");let f=a.upstream.run();switch(f._tag){case FH:{let f=a.onEmit(a.upstream.getEmit());if(0===d.length){if(void 0===f)return lz(b);return aa(f,lg({onFailure:c,onSuccess:b}))}if(void 0===f)return lz(()=>e());return aa(f,lg({onFailure:c,onSuccess:()=>e()}))}case FG:{let f=a.onDone(a.upstream.getDone());if(0===d.length){if(void 0===f)return lz(b);return aa(f,lg({onFailure:c,onSuccess:b}))}if(void 0===f)return lz(()=>e());return aa(f,lg({onFailure:c,onSuccess:()=>e()}))}case FI:return d.push(a),aa(a.onEffect(f.effect),kY(b=>lz(()=>{let c=a.onDone(m_(b));return void 0===c?lF:c})),lg({onFailure:c,onSuccess:()=>e()}));case FJ:return d.push(a),d.push(f),lz(()=>e())}};return e()},F3=W(2,(a,b)=>lE(c=>up([mC(b,qZ),nd(),nd()]).pipe(lb(([d,e,f])=>c(((b,c,d)=>kR(lA(()=>new F_(a,void 0,X)),a=>lz(()=>F4(a.run(),a).pipe(lo(b),uH(nf(b)),uG(nf(c)))),(a,b)=>{let c=a.close(b);return void 0===c?lF:p_(c,a=>mz(d,k7(a)))}))(e,f,d)).pipe(u4(b),lb(a=>b.addFinalizer(b=>{let c="Failure"===b._tag?kb(b.cause):void 0;return qW(e).pipe(lb(b=>b?nk(f,void 0).pipe(uH(a.await),uH(a.inheritAll)):nk(f,void 0).pipe(uH(c&&h7(c)>0?lS(a,aa(c,h4(io,(a,b)=>ir(b)(a)))):lR(a)),uH(a.inheritAll))))}).pipe(uH(c(nf(e)))))))))),F4=(a,b)=>{switch(a._tag){case FI:return aa(a.effect,lb(()=>F4(b.run(),b)));case FH:return F4(b.run(),b);case FG:return lz(()=>b.getDone());case FJ:return F2(a,()=>F4(b.run(),b),k7)}},F5="Done",F6={[Symbol.for("effect/ChannelMergeDecision")]:{_R:a=>a,_E0:a=>a,_Z0:a=>a,_E:a=>a,_Z:a=>a}},F7=a=>{let b=Object.create(F6);return b._tag=F5,b.effect=a,b},F8=a=>{let b=Object.create(F6);return b._tag="Await",b.f=a,b},F9="BothRunning",Ga="LeftDone",Gb="RightDone",Gc=Symbol.for("effect/ChannelMergeState"),Gd={[Gc]:Gc},Ge=(a,b)=>{let c=Object.create(Gd);return c._tag=F9,c.left=a,c.right=b,c},Gf=a=>{let b=Object.create(Gd);return b._tag=Ga,b.f=a,b},Gg=a=>{let b=Object.create(Gd);return b._tag=Gb,b.f=a,b},Gh="BackPressure",Gi="BufferSliding",Gj=Symbol.for("effect/ChannelMergeStrategy"),Gk={[Gj]:Gj},Gl=a=>{let b=Object.create(Gk);return b._tag=Gh,b},Gm=W(2,(a,{onBackPressure:b,onBufferSliding:c})=>{switch(a._tag){case Gh:return b();case Gi:return c()}}),Gn="Empty",Go="Emit",Gp="Error",Gq="Done",Gr=a=>({_tag:Gn,notifyProducer:a}),Gs=a=>({_tag:Go,notifyConsumers:a});class Gt{constructor(a){this.ref=a}awaitRead(){return le(pi(this.ref,a=>a._tag===Gn?[nf(a.notifyProducer),a]:[lF,a]))}get close(){return la(a=>this.error(j3(a)))}done(a){return le(pi(this.ref,b=>{switch(b._tag){case Gn:return[nf(b.notifyProducer),b];case Go:return[uq(b.notifyConsumers,b=>nk(b,ds(a)),{discard:!0}),{_tag:Gq,done:a}];case Gp:case Gq:return[ll,b]}}))}emit(a){return lb(nd(),b=>le(pi(this.ref,c=>{switch(c._tag){case Gn:return[nf(c.notifyProducer),c];case Go:{let d=c.notifyConsumers[0],e=c.notifyConsumers.slice(1);if(void 0!==d)return[nk(d,dt(a)),0===e.length?Gr(b):Gs(e)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case Gp:case Gq:return[ll,c]}})))}error(a){return le(pi(this.ref,b=>{switch(b._tag){case Gn:return[nf(b.notifyProducer),b];case Go:return[uq(b.notifyConsumers,b=>ni(b,a),{discard:!0}),{_tag:Gp,cause:a}];case Gp:case Gq:return[ll,b]}}))}get take(){return this.takeWith(a=>m_(kh(a,ds)),a=>m6(a),a=>m$(dt(a)))}takeWith(a,b,c){return lb(nd(),d=>le(pi(this.ref,e=>{switch(e._tag){case Gn:return[uH(nk(e.notifyProducer,void 0),lf(nf(d),{onFailure:a,onSuccess:dy({onLeft:c,onRight:b})})),Gs([d])];case Go:return[lf(nf(d),{onFailure:a,onSuccess:dy({onLeft:c,onRight:b})}),Gs([...e.notifyConsumers,d])];case Gp:return[ly(a(e.cause)),e];case Gq:return[ly(c(e.done)),e]}})))}}let Gu=()=>aa(nd(),lb(a=>pf(Gr(a))),lp(a=>new Gt(a))),Gv=W(2,(a,b)=>GI(a,()=>b)),Gw=W(2,(a,b)=>Fj(a,a=>dy(kd(a),{onLeft:b,onRight:Fr}))),Gx=W(2,(a,b)=>Fn(a,b,()=>void 0,()=>void 0)),Gy=a=>Fy({onInput:b=>Ft(FD(()=>{a.push(b)}),()=>Gy(a)),onFailure:Fq,onDone:FA}),Gz=a=>{let b=Fz({onInput:()=>b,onFailure:Fr,onDone:FA});return Fw(a,b)},GA=W(2,(a,b)=>Fp(a,()=>b)),GB=W(2,(a,b)=>Fu(a,{onFailure:a=>{let c=kd(a);switch(c._tag){case"Left":return b.onFailure(c.left);case"Right":return Fr(c.right)}},onSuccess:b.onSuccess})),GC=a=>G0(a.takeWith(Fr,b=>Ft(FF(b),()=>GC(a)),FA)),GD=a=>FC(()=>GE(a)),GE=a=>aa(Fv(DU(a)),Ft(dy({onLeft:m4({onFailure:Fr,onSuccess:FB}),onRight:b=>Ft(FF(b),()=>GE(a))}))),GF=()=>Fy({onInput:a=>Ft(FF(a),()=>GF()),onFailure:Fq,onDone:FB}),GG=W(2,(a,b)=>GR(a,{other:Fv(b),onSelfDone:a=>F7(lz(()=>a)),onOtherDone:a=>F7(lz(()=>a))})),GH=W(2,(a,b)=>GG(a,nf(b))),GI=W(2,(a,b)=>Ft(a,a=>FD(()=>b(a)))),GJ=W(2,(a,b)=>Ft(a,a=>Fv(b(a)))),GK=W(2,(a,b)=>GL(a,kh(b))),GL=W(2,(a,b)=>Fj(a,a=>Fr(b(a)))),GM=W(2,(a,b)=>{let c=Fy({onInput:a=>Ft(FF(b(a)),()=>c),onFailure:Fq,onDone:FB});return Fw(a,c)}),GN=W(2,(a,b)=>{let c=Fz({onInput:a=>aa(Fv(b(a)),Ft(FF),Ft(()=>c)),onFailure:Fr,onDone:FB});return Fw(a,c)}),GO=W(3,(a,b,c)=>G2(d=>xP(function*(){let e=yield*Gu(),f=GC(e),g=yield*D6(c);yield*mz(d,Ea(g));let h=yield*nd(),i=c===1/0?a=>X:(yield*xT(c)).withPermits,j=yield*f.pipe(Fw(a),GZ(d));yield*j.pipe(lg({onFailure:a=>DS(g,k7(a)),onSuccess:dy({onLeft:a=>uH(ln(i(c)(lF)),kT(DS(g,ly(ds(a))))),onRight:a=>xP(function*(){let c=yield*nd(),e=yield*nd();yield*DS(g,lp(nf(c),dt)),yield*nk(e,void 0).pipe(uH(lE(c=>k4(c(nf(h))).pipe(u6(k4(c(b(a)))),lb(X))).pipe(p_(a=>ni(h,a)),lo(c))),i(1),u4(d)),yield*nf(e)})})}),pI,ln,u4(d));let k=G0(lf(le(DU(g)),{onFailure:Fr,onSuccess:dy({onLeft:FB,onRight:a=>Ft(FF(a),()=>k)})}));return Fo(k,e)}))),GP=({bufferSize:a=16,concurrency:b,mergeStrategy:c=Gl()})=>(d,e)=>G2(f=>xP(function*(){let g="unbounded"===b?Number.MAX_SAFE_INTEGER:b,h=yield*Gu(),i=GC(h),j=yield*D6(a);yield*mz(f,Ea(j));let k=yield*D9();yield*mz(f,Ea(k));let l=yield*pf(ej()),m=yield*nd(),n=(yield*xT(g)).withPermits,o=yield*GZ(Fw(i,d),f);function p(a){return a.pipe(lb(dy({onLeft:a=>ly(bG(a)),onRight:a=>kS(DS(j,ly(dt(a))),ej())})),w9({until:a=>bE(a)}),lb(a=>pj(l,ek({onNone:()=>bG(a.value),onSome:b=>bG(e(b,a.value))}))),kY(a=>j8(a)?k7(a):DS(j,k7(a)).pipe(uH(nk(m,void 0)),kT)))}yield*o.pipe(lg({onFailure:a=>DS(j,k7(a)).pipe(uH(ly(!1))),onSuccess:dy({onLeft:a=>uU(ln(nf(m)),ln(n(g)(lF)),{onSelfDone:(a,b)=>kS(lR(b),!1),onOtherDone:(b,c)=>uH(lR(c),l.get.pipe(lb(ek({onNone:()=>DS(j,ly(ds(a))),onSome:b=>DS(j,ly(ds(e(b,a))))})),kS(!1)))}),onRight:a=>Gm(c,{onBackPressure:()=>xP(function*(){let b=yield*nd(),c=uD(b=>GZ(Fw(i,a),b).pipe(lb(a=>uV(k4(p(a)),k4(ln(nf(m))))),lb(X)));return yield*nk(b,void 0).pipe(uH(c),n(1),u4(f)),yield*nf(b),!(yield*qW(m))}),onBufferSliding:()=>xP(function*(){let b=yield*nd(),c=yield*nd(),d=yield*k.size;yield*DU(k).pipe(lb(a=>nk(a,void 0)),p3(()=>d>=g)),yield*DS(k,b);let e=uD(c=>GZ(Fw(i,a),c).pipe(lb(a=>k4(p(a)).pipe(uV(k4(ln(nf(m)))),uV(k4(ln(nf(b)))))),lb(X)));return yield*nk(c,void 0).pipe(uH(e),n(1),u4(f)),yield*nf(c),!(yield*qW(m))})})})}),w9({while:a=>a}),u4(f));let q=aa(DU(j),le,lf({onFailure:Fr,onSuccess:dy({onLeft:FB,onRight:a=>Ft(FF(a),()=>q)})}),G0);return Fo(q,h)})),GQ=W(3,(a,b,c)=>{let d;return(d=c,a=>GP(d)(a,_))(GM(a,b))}),GR=W(2,(a,b)=>G2(function(c){return xP(function*(){let d=yield*Gu(),e=GC(d),f=yield*GZ(Fw(e,a),c),g=yield*GZ(Fw(e,b.other),c);function h(a,b,d){return(e,f,g)=>{function h(a){return a._tag===F5?ly(Fv(uH(lR(b),a.effect))):lp(b.await,m4({onFailure:b=>Fv(a.f(m_(b))),onSuccess:dy({onLeft:b=>Fv(a.f(m6(b))),onRight:b=>G7(FF(b),i(g(a.f)))})}))}return m4(a,{onFailure:a=>h(e(m_(a))),onSuccess:dy({onLeft:a=>h(e(m6(a))),onRight:a=>ly(Ft(FF(a),()=>Ft(Fv(u4(ln(d),c)),a=>i(f(a,b)))))})})}}function i(a){switch(a._tag){case F9:return G0(uU(ln(rU(a.left)),ln(rU(a.right)),{onSelfDone:(c,d)=>uH(lR(d),h(c,a.right,f)(b.onSelfDone,Ge,a=>Gf(a))),onOtherDone:(c,d)=>uH(lR(d),h(c,a.left,g)(b.onOtherDone,(a,b)=>Ge(b,a),a=>Gg(a)))}));case Ga:return G0(lp(k4(g),m4({onFailure:b=>Fv(a.f(m_(b))),onSuccess:dy({onLeft:b=>Fv(a.f(m6(b))),onRight:b=>Ft(FF(b),()=>i(Gf(a.f)))})})));case Gb:return G0(lp(k4(f),m4({onFailure:b=>Fv(a.f(m_(b))),onSuccess:dy({onLeft:b=>Fv(a.f(m6(b))),onRight:b=>Ft(FF(b),()=>i(Gg(a.f)))})})))}}return Fv(kQ(a=>{let b=kQ(b=>(b.transferChildren(a.scope()),lF));return uI(ln(f).pipe(uY(b),u4(c)),ln(g).pipe(uY(b),u4(c)),(a,b)=>Ge(a,b))})).pipe(Ft(i),Fo(d))})})),GS=((a,b)=>Gw(a,a=>Fs(()=>j2(b(a)))),W(2,(a,b)=>Gw(a,b))),GT=W(2,(a,b)=>FC(()=>{let c,d=Fy({onInput:a=>Ft(FF(a),()=>d),onFailure:a=>Fr(j2(c=G9(a))),onDone:FB}),e=Fz({onInput:a=>aa(FF(a),Ft(()=>e)),onFailure:a=>"Die"===a._tag&&Ha(a.defect)&&aV(a.defect,c)?Fq(a.defect.error):Fr(a),onDone:FB});return Fw(Fw(Fw(a,d),b),e)})),GU=((a,b)=>G2(c=>lp(v7(b,c),b=>Fx(a,b))),a=>uD(b=>F3(a,b))),GV=a=>GU(Gz(a)),GW=a=>uC(b=>F3(a,b)),GX=a=>G0(lE(b=>lp(uN(),c=>Fi(p_(b(uO(a,c)),a=>mB(c,m_(a))),(a,b)=>mB(c,b))))),GY=a=>G1(lp(uK,b=>Ft(Fv(a(b)),FF))),GZ=W(2,(a,b)=>uF(lA(()=>new F_(a,void 0,X)),vU()).pipe(lB(([a,c])=>mA(b,b=>{let d=a.close(b);return void 0!==d?wy(d,c):lF})),lD,lp(([a])=>lz(()=>G$(a.run(),a))))),G$=(a,b)=>{switch(a._tag){case FG:return m4(b.getDone(),{onFailure:k7,onSuccess:a=>ly(ds(a))});case FH:return ly(dt(b.getEmit()));case FI:return aa(a.effect,lb(()=>G$(b.run(),b)));case FJ:return F2(a,()=>G$(b.run(),b),a=>k7(a))}},G_=a=>Fz({onInput:b=>Ft(Fv(DS(a,dt(b))),()=>G_(a)),onFailure:b=>Fv(aa(DS(a,ds(m_(b))))),onDone:b=>Fv(aa(DS(a,ds(m6(b)))))}),G0=a=>Ft(Fv(a),X),G1=a=>Fm(GX(a),(a,b)=>a,(a,b)=>a),G2=a=>Fm(GY(a),(a,b)=>a,(a,b)=>a),G3=a=>G4(0,a.length,a),G4=(a,b,c)=>a===b?FE:aa(FF(aa(c,f3(a))),Ft(()=>G4(a+1,b,c))),G5=W(a=>Fh(a[1]),(a,b,c)=>c?.concurrent?GR(a,{other:b,onSelfDone:a=>F8(b=>lz(()=>m8(a,b))),onOtherDone:a=>F8(b=>lz(()=>m8(b,a)))}):Ft(a,a=>GI(b,b=>[a,b]))),G6=W(a=>Fh(a[1]),(a,b,c)=>c?.concurrent?GI(G5(a,b,{concurrent:!0}),a=>a[0]):Ft(a,a=>Gv(b,a))),G7=W(a=>Fh(a[1]),(a,b,c)=>c?.concurrent?GI(G5(a,b,{concurrent:!0}),a=>a[1]):Ft(a,()=>b)),G8=Symbol.for("effect/Channel/ChannelException"),G9=a=>({_tag:"ChannelException",[G8]:G8,error:a}),Ha=a=>ap(a,G8),Hb=Symbol.for("effect/RcRef"),Hc={_tag:"Empty"},Hd={_A:X,_E:X};class He extends b2{static{m=pa}constructor(a,b,c,d){super(),this[Hb]=Hd,this[m]=pa,this.state=Hc,this.semaphore=u_(1),this.acquire=a,this.context=b,this.scope=c,this.idleTimeToLive=d,this.get=Hf(this)}commit(){return this.get}}let Hf=a=>lE(b=>lz(()=>{switch(a.state._tag){case"Closed":return ll;case"Acquired":return a.state.refCount++,a.state.fiber?kS(lR(a.state.fiber),a.state):ly(a.state);case"Empty":return uN().pipe(pE("scope"),pD("value",({scope:c})=>b(mb(a.acquire,mg,bS(a.context,uJ,c)))),lp(({scope:b,value:c})=>{let d={_tag:"Acquired",value:c,scope:b,fiber:void 0,refCount:1};return a.state=d,d}))}})).pipe(a.semaphore.withPermits(1),pE("state"),pD("scope",()=>uJ),lB(({scope:b,state:c})=>b.addFinalizer(()=>lz(()=>(c.refCount--,c.refCount>0)?lF:void 0===a.idleTimeToLive?(a.state=Hc,mB(c.scope,m7)):oV(a.idleTimeToLive).pipe(ln,lO(lz(()=>"Acquired"===a.state._tag&&0===a.state.refCount?(a.state=Hc,mB(c.scope,m7)):lF)),uY(lA(()=>{c.fiber=void 0})),u4(a.scope),lB(a=>{c.fiber=a}),a.semaphore.withPermits(1))))),lp(({state:a})=>a.value)),Hg={_tag:"Left"},Hh={_tag:"Right"},Hi={_tag:"Both"},Hj={_tag:"Either"},Hk=Symbol.for("effect/Sink"),Hl={_A:a=>a,_In:a=>a,_L:a=>a,_E:a=>a,_R:a=>a};class Hm{constructor(a){this[Hk]=Hl,this.channel=a}pipe(){return a7(this,arguments)}}let Hn=a=>ap(a,Hk),Ho=a=>new Hm(FC(()=>HJ(a()))),Hp=((a,b)=>aa(a,Hp(gk(b))),W(2,(a,b)=>{let c=Fy({onInput:a=>aa(FF(b(a)),Ft(()=>c)),onFailure:Fq,onDone:FA});return new Hm(aa(c,Fw(HJ(a))))})),Hq=W(2,(a,b)=>{let c=Fy({onInput:a=>aa(Fv(b(a)),Ft(FF),Ft(()=>c)),onFailure:Fq,onDone:FA});return new Hm(aa(c,GT(HJ(a))))}),Hr=new Hm(Gz(GF())),Hs=a=>new Hm(Fq(a)),Ht=(a,b,c)=>Ho(()=>new Hm(Hu(a,b,c))),Hu=(a,b,c)=>b(a)?Fy({onInput:d=>{let[e,f]=Hv(a,d,b,c,0,d.length);return gg(f)?aa(FF(f),Gv(e)):Hu(e,b,c)},onFailure:Fq,onDone:()=>FB(a)}):FB(a),Hv=(a,b,c,d,e,f)=>{if(e===f)return[a,fV()];let g=d(a,aa(b,f3(e)));return c(g)?Hv(g,b,c,d,e+1,f):[g,aa(b,f7(e+1))]},Hw=W(2,(a,b)=>new Hm(aa(HJ(a),Fk,GB({onFailure:a=>HJ(b.onFailure(a)),onSuccess:([a,c])=>FC(()=>{let d={ref:aa(a,gb(gg))},e=aa(FD(()=>{let a=d.ref;return d.ref=fV(),a}),Ft(a=>G3(a)));return Ft(Fk(aa(e,G7(GF()),Fw(HJ(b.onSuccess(c))))),([a,b])=>aa(FA(d.ref),Ft(G3),G7(G3(a)),Gv(b)))})})))),Hx=(a,b,c)=>Ho(()=>new Hm(Hy(a,b,c))),Hy=(a,b,c)=>b(a)?Fy({onInput:d=>aa(Fv(Hz(a,d,b,c)),Ft(([a,d])=>aa(d,ek({onNone:()=>Hy(a,b,c),onSome:b=>aa(FF(b),Gv(a))})))),onFailure:Fq,onDone:()=>FB(a)}):FB(a),Hz=(a,b,c,d)=>HA(a,b,0,b.length,c,d),HA=(a,b,c,d,e,f)=>c===d?ly([a,ej()]):aa(f(a,aa(b,f3(c))),lb(a=>e(a)?HA(a,b,c+1,d,e,f):ly([a,bG(aa(b,f7(c+1)))]))),HB=W(2,(a,b)=>Hw(a,{onFailure:Hs,onSuccess:b})),HC=a=>{let b=Fz({onInput:c=>aa(Fv(uq(c,b=>a(b),{discard:!0})),Ft(()=>b)),onFailure:Fr,onDone:()=>FE});return new Hm(b)},HD=a=>{let b=Fz({onInput:c=>aa(Fv(a(c)),Ft(()=>b)),onFailure:Fr,onDone:()=>FE});return new Hm(b)},HE=(a,b,c,d,e)=>c===d?e:aa(Fv(a(aa(b,f3(c)))),Ft(f=>f?HE(a,b,c+1,d,e):FF(aa(b,f7(c)))),Gw(a=>aa(FF(aa(b,f7(c))),G7(Fq(a))))),HF=(a,b)=>b?.shutdown?HK(lp(un(ly(a),Ea),HF)):HD(b=>aa(DT(a,b))),HG=W(2,(a,b)=>new Hm(aa(HJ(a),GI(b)))),HH=((a,b)=>new Hm(aa(HJ(a),GJ(b))),W(2,(a,b)=>HL(function(c){return xP(function*(){let d,e=yield*EQ(b?.capacity??16),f=yield*uO(e.subscribe,c),g=yield*uO(e.subscribe,c),h=(d=e,FC(()=>G_(d))),i=GD(f).pipe(Fw(HJ(a)),G6(Fv(Ea(f))),GR({other:GD(g).pipe(Fw(HJ(b.other)),G6(Fv(Ea(g)))),onSelfDone:b.onSelfDone,onOtherDone:b.onOtherDone}));return new Hm(GR(h,{other:i,onSelfDone:()=>F8(X),onOtherDone:a=>F7(a)}))})}))),HI=((a,b,c)=>new Hm(aa(a,HJ,Gw(a=>ek(b(a),{onNone:()=>Fs(()=>j2(c(a))),onSome:Fq})))),(a,b,c=0)=>{let d,e=a[Symbol.iterator](),f=0,g=-1;for(;g<0&&(d=e.next())&&!d.done;){let a=d.value;f>=c&&b(a)&&(g=f),f+=1}return g}),HJ=((a,b,c)=>new Hm(aa(Fv(b),Ft(d=>aa(a,HJ,Ft(a=>aa(Fv(b),GI(b=>[a,c(d,b)]))))))),a=>kP(a)?HJ(new Hm(Fv(a))):a.channel),HK=a=>new Hm(G1(a.pipe(lp(a=>HJ(a))))),HL=a=>new Hm(G2(b=>a(b).pipe(lp(a=>HJ(a))))),HM=((a=>Hn(a[1]),(a,b,c)=>HM(a,b,(a,b)=>b,c)),W(a=>Hn(a[1]),(a,b,c,d)=>d?.concurrent?HH(a,{other:b,onSelfDone:m4({onFailure:a=>F7(k7(a)),onSuccess:a=>F8(m4({onFailure:k7,onSuccess:b=>ly(c(a,b))}))}),onOtherDone:m4({onFailure:a=>F7(k7(a)),onSuccess:a=>F8(m4({onFailure:k7,onSuccess:b=>ly(c(b,a))}))})}):HB(a,a=>HG(b,b=>c(a,b)))));class HN{constructor(a){this.value=a}}let HO=(a,b)=>{a.isChanged=!0,a.newValue=b},HP=a=>{a.ref.versioned=new HN(a.newValue)},HQ=a=>a.ref.versioned!==a.expected,HR=a=>a.isChanged,HS="Invalid",HT="ReadWrite",HU=a=>{for(let b of a)HP(b[1])},HV=a=>{let b="ReadOnly";for(let[,c]of a)if((b=HQ(c)?HS:HR(c)?HT:b)===HS)break;return b},HW="WithSTMRuntime",HX="OnFailure",HY="OnRetry",HZ="OnSuccess",H$="Sync",H_="Succeed",H0="Retry",H1="Fail",H2="Interrupt",H3="Fail",H4="Interrupt",H5="Succeed",H6="Retry",H7="Done",H8="Suspend",H9="Done",Ia="Interrupted",Ib="Running",Ic="effect/STM/State",Id=Symbol.for(Ic),Ie=a=>ap(a,Id),If=a=>({[Id]:Id,_tag:H9,exit:a,[aJ](){return aa(aK(Ic),aM(aK(H9)),aM(aK(a)),aT(this))},[aU]:b=>Ie(b)&&b._tag===H9&&aV(a,b.exit)}),Ig=aa(aK(Ic),aM(aK(Ia)),aM(aK("interrupted"))),Ih={[Id]:Id,_tag:Ia,[aJ]:()=>Ig,[aU]:a=>Ie(a)&&a._tag===Ia},Ii=aa(aK(Ic),aM(aK(Ib)),aM(aK("running"))),Ij={[Id]:Id,_tag:Ib,[aJ]:()=>Ii,[aU]:a=>Ie(a)&&a._tag===Ib},Ik=a=>{switch(a._tag){case H3:return If(m$(a.error));case"Die":return If(mZ(a.defect));case H4:return If(m2(a.fiberId));case H5:return If(m6(a.value));case H6:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},Il="effect/TExit",Im=Symbol.for(Il),In={_A:a=>a,_E:a=>a},Io=a=>ap(a,Im),Ip=a=>({[Im]:In,_tag:H3,error:a,[aJ](){return aa(aK(Il),aM(aK(H3)),aM(aK(a)),aT(this))},[aU]:b=>Io(b)&&b._tag===H3&&aV(a,b.error)}),Iq=a=>({[Im]:In,_tag:"Die",defect:a,[aJ](){return aa(aK(Il),aM(aK("Die")),aM(aK(a)),aT(this))},[aU]:b=>Io(b)&&"Die"===b._tag&&aV(a,b.defect)}),Ir=a=>({[Im]:In,_tag:H4,fiberId:a,[aJ](){return aa(aK(Il),aM(aK(H4)),aM(aK(a)),aT(this))},[aU]:b=>Io(b)&&b._tag===H4&&aV(a,b.fiberId)}),Is=a=>({[Im]:In,_tag:H5,value:a,[aJ](){return aa(aK(Il),aM(aK(H5)),aM(aK(a)),aT(this))},[aU]:b=>Io(b)&&b._tag===H5&&aV(a,b.value)}),It=aa(aK(Il),aM(aK(H6)),aM(aK("retry"))),Iu={[Im]:In,_tag:H6,[aJ]:()=>It,[aU]:a=>Io(a)&&a._tag===H6},Iv=a=>({_tag:H8,journal:a}),Iw={ref:0},Ix=Symbol.for("effect/STM"),Iy={_R:a=>a,_E:a=>a,_A:a=>a};class Iz{get[Ix](){return Iy}constructor(a){this._op=a9,this.effect_instruction_i1=void 0,this.effect_instruction_i2=void 0,this.effect_instruction_i0=a,this[kK]=bq,this[bn]=Iy,this[Hk]=Iy,this[Ff]=Iy}[aU](a){return this===a}[aJ](){return aT(this,aL(this))}[Symbol.iterator](){return new kI(new aC(this))}commit(){return IA(this,_,_)}pipe(){return a7(this,arguments)}}let IA=(a,b,c)=>kQ(d=>{let e=d.id(),f=d.getFiberRef(mg),g=d.getFiberRef(rg),h=d.getFiberRef(mh),i=IB(e,a,f,g,h);switch(i._tag){case H7:return b(i.exit),i.exit;case H8:{let d=(()=>{let a=Iw.ref+1;return Iw.ref=a,a})(),i={value:Ij},j=kX(b=>IC(e,a,d,i,f,g,h,b));return lE(a=>aa(a(j),kY(a=>{let d=i.value;return d._tag===Ib&&(i.value=Ih),(d=i.value)._tag===H9?(b(d.exit),d.exit):(c(),k7(a))})))}}}),IB=(a,b,c,d,e)=>{let f=new Map,g=new IF(b,f,a,c).run(),h=HV(f);if(h===HT&&g._tag===H5)HU(f);else if(h===HS)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(g._tag){case H5:return ID(m6(g.value),f,d,e);case H3:return ID(m_(j1(g.error)),f,d,e);case"Die":return ID(m_(j2(g.defect)),f,d,e);case H4:return ID(m_(j3(a)),f,d,e);case H6:return Iv(f)}},IC=(a,b,c,d,e,f,g,h)=>{if(d.value._tag===Ib){let i=((a,b,c,d,e,f)=>{let g=new Map,h=new IF(b,g,a,d).run(),i=HV(g);if(i===HT)HU(g);else if(i===HS)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(h._tag){case H5:return c.value=Ik(h),ID(m6(h.value),g,e,f);case H3:return c.value=Ik(h),ID(m_(j1(h.error)),g,e,f);case"Die":return c.value=Ik(h),ID(m_(j2(h.defect)),g,e,f);case H4:return c.value=Ik(h),ID(m_(j3(a)),g,e,f);case H6:return Iv(g)}})(a,b,d,e,f,g);switch(i._tag){case H7:IE(i.exit,h);break;case H8:((a,b,c)=>{for(let[,d]of b)d.ref.todos.has(a)||d.ref.todos.set(a,c)})(c,i.journal,()=>IC(a,b,c,d,e,f,g,h))}}},ID=(a,b,c,d)=>{let e=(a=>{let b=new Map;for(let[,c]of a){for(let a of c.ref.todos)b.set(a[0],a[1]);c.ref.todos=new Map}return b})(b);return e.size>0&&c.scheduleTask(()=>(a=>{for(let[b,c]of Array.from(a.entries()).sort((a,b)=>a[0]-b[0]))c()})(e),d),{_tag:H7,exit:a}},IE=(a,b)=>{b(a)};class IF{constructor(a,b,c,d){this.contStack=[],this.self=a,this.journal=b,this.fiberId=c,this.env=d}getEnv(){return this.env}pushStack(a){this.contStack.push(a)}popStack(){return this.contStack.pop()}nextSuccess(){let a=this.popStack();for(;void 0!==a&&a.effect_instruction_i0!==HZ;)a=this.popStack();return a}nextFailure(){let a=this.popStack();for(;void 0!==a&&a.effect_instruction_i0!==HX;)a=this.popStack();return a}nextRetry(){let a=this.popStack();for(;void 0!==a&&a.effect_instruction_i0!==HY;)a=this.popStack();return a}run(){let a,b=this.self;for(;void 0===a&&void 0!==b;)try{let c=b;if(c)switch(c._op){case"Tag":b=IJ((a,b,d)=>bV(d,c));break;case"Left":b=IL(c.left);break;case"None":b=IL(new mO);break;case"Right":b=IT(c.right);break;case"Some":b=IT(c.value);break;case"Commit":switch(c.effect_instruction_i0){case"Die":a=Iq(aG(()=>c.effect_instruction_i1()));break;case H1:{let d=this.nextFailure();void 0===d?a=Ip(aG(()=>c.effect_instruction_i1())):b=aG(()=>d.effect_instruction_i2(aG(()=>c.effect_instruction_i1())));break}case H0:{let c=this.nextRetry();void 0===c?a=Iu:b=aG(()=>c.effect_instruction_i2());break}case H2:a=Ir(this.fiberId);break;case HW:b=aG(()=>c.effect_instruction_i1(this));break;case HZ:case HX:case HY:this.pushStack(c),b=c.effect_instruction_i1;break;case"Provide":{let a=this.env;this.env=aG(()=>c.effect_instruction_i2(a)),b=aa(c.effect_instruction_i1,IK(IU(()=>this.env=a)));break}case H_:{let d=c.effect_instruction_i1,e=this.nextSuccess();void 0===e?a=Is(d):b=aG(()=>e.effect_instruction_i2(d));break}case H$:{let d=aG(()=>c.effect_instruction_i1()),e=this.nextSuccess();void 0===e?a=Is(d):b=aG(()=>e.effect_instruction_i2(d))}}}}catch(a){b=IH(a)}return a}}let IG=W(2,(a,b)=>{let c=new Iz(HX);return c.effect_instruction_i1=a,c.effect_instruction_i2=b,c}),IH=a=>II(()=>a),II=a=>{let b=new Iz("Die");return b.effect_instruction_i1=a,b},IJ=a=>IP(b=>IT(a(b.journal,b.fiberId,b.getEnv()))),IK=W(2,(a,b)=>IO(a,{onFailure:a=>IV(b,IL(a)),onSuccess:a=>IV(b,IT(a))})),IL=a=>IM(()=>a),IM=a=>{let b=new Iz(H1);return b.effect_instruction_i1=a,b},IN=W(2,(a,b)=>{let c=new Iz(HZ);return c.effect_instruction_i1=a,c.effect_instruction_i2=b,c}),IO=W(2,(a,{onFailure:b,onSuccess:c})=>aa(a,IR(dt),IG(a=>aa(b(a),IR(ds))),IN(a=>{switch(a._tag){case"Left":return IT(a.left);case"Right":return c(a.right)}}))),IP=a=>{let b=new Iz(HW);return b.effect_instruction_i1=a,b},IQ=a=>{let b=new Iz(H2);return b.effect_instruction_i1=a,b},IR=W(2,(a,b)=>aa(a,IN(a=>IU(()=>b(a))))),IS=new Iz(H0),IT=a=>{let b=new Iz(H_);return b.effect_instruction_i1=a,b},IU=a=>{let b=new Iz(H$);return b.effect_instruction_i1=a,b},IV=W(2,(a,b)=>aa(a,IN(()=>b))),IW=W(3,(a,b,c)=>aa(a,IN(a=>aa(b,IR(b=>c(a,b)))))),IX=((a,b)=>aa(a,IR(()=>b)),W(a=>au(a[0]),(a,b,c)=>c?.discard?aa(IU(()=>a[Symbol.iterator]()),IN(a=>{let c=IY(()=>{let d=a.next();return d.done?IZ:aa(b(d.value),IN(()=>c))});return c})):IY(()=>eO(a).reduce((a,c)=>IW(a,b(c),(a,b)=>(a.push(b),a)),IT([]))))),IY=a=>IN(IU(a),X),IZ=IT(void 0),I$=Symbol.for("effect/TRef"),I_={_A:a=>a};class I0{constructor(a){this[I$]=I_,this.versioned=new HN(a),this.todos=new Map}modify(a){return IJ(b=>{let c=I1(this,b),[d,e]=a(c.newValue);return HO(c,e),d})}pipe(){return a7(this,arguments)}}let I1=(a,b)=>{if(b.has(a))return b.get(a);let c=((a,b)=>({ref:a,isNew:b,isChanged:!1,expected:a.versioned,newValue:a.versioned.value}))(a,!1);return b.set(a,c),c},I2=W(2,(a,b)=>I1(a,b).newValue),I3=W(3,(a,b,c)=>{HO(I1(a,c),b)}),I4=Symbol.for("effect/TQueue/TEnqueue"),I5=Symbol.for("effect/TQueue/TDequeue"),I6={_Out:a=>a},I7={_In:a=>a},I8=((a,b,c)=>IY(()=>{let d=(b,c,e)=>c<b?IT(e):aa(a.takeUpTo(c),IN(f=>{let g=b-f.length;return 1===g?aa(a.take,IR(a=>aa(e,f9(f1(f)),f4(a)))):g>1?aa(a.take,IN(a=>d(g-1,c-f.length-1,aa(e,f9(f1(f)),f4(a))))):IT(aa(e,f9(f1(f))))}));return IR(d(b,c,fV()),a=>Array.from(a))}),Symbol.for("effect/TPubSub")),I9=Symbol.for("effect/TPubSub/AbsentValue"),Ja=(a,b,c)=>({head:a,subscribers:b,tail:c});class Jb{static{n=I4}constructor(a,b,c,d,e,f,g){this[I8]={_A:a=>a},this[n]=I7,this.isShutdown=IJ(a=>void 0===I2(this.publisherTail,a)),this.awaitShutdown=IN(this.isShutdown,a=>a?IZ:IS),this.size=IP(a=>void 0===I2(this.publisherTail,a.journal)?IQ(a.fiberId):IT(I2(this.pubsubSize,a.journal))),this.isEmpty=IR(this.size,a=>0===a),this.isFull=IR(this.size,a=>a===this.capacity()),this.shutdown=IJ(a=>{void 0!==I2(this.publisherTail,a)&&(I3(this.publisherTail,void 0,a),h3(I2(this.subscribers,a),b=>{I3(b,void 0,a)}),I3(this.subscribers,hU(),a))}),this.pubsubSize=a,this.publisherHead=b,this.publisherTail=c,this.requestedCapacity=d,this.strategy=e,this.subscriberCount=f,this.subscribers=g}capacity(){return this.requestedCapacity}offer(a){return IP(b=>{let c=I2(this.publisherTail,b.journal);if(void 0===c)return IQ(b.fiberId);let d=I2(this.subscriberCount,b.journal);if(0===d)return IT(!0);let e=I2(this.pubsubSize,b.journal);if(e<this.requestedCapacity){let f=new I0(void 0);return I3(c,Ja(a,d,f),b.journal),I3(this.publisherTail,f,b.journal),I3(this.pubsubSize,e+1,b.journal),IT(!0)}switch(this.strategy._tag){case"BackPressure":return IS;case"Dropping":return IT(!1);case"Sliding":{if(this.requestedCapacity>0){let a=I2(this.publisherHead,b.journal),c=!0;for(;c;){let d=I2(a,b.journal);if(void 0===d)return IS;let e=d.head,f=d.tail;e!==I9?(I3(a,Ja(I9,d.subscribers,d.tail),b.journal),I3(this.publisherHead,f,b.journal),c=!1):a=f}}let e=new I0(void 0);return I3(c,Ja(a,d,e),b.journal),I3(this.publisherTail,e,b.journal),IT(!0)}}})}offerAll(a){return IR(IX(a,a=>this.offer(a)),fp(X))}}class Jc{static{o=I5}constructor(a,b,c,d,e,f){this[I8]=I8,this[o]=I6,this.isShutdown=IJ(a=>void 0===I2(this.subscriberHead,a)),this.awaitShutdown=IN(this.isShutdown,a=>a?IZ:IS),this.size=IP(a=>{let b=I2(this.subscriberHead,a.journal);if(void 0===b)return IQ(a.fiberId);let c=!0,d=0;for(;c;){let e=I2(b,a.journal);if(void 0===e)c=!1;else{let a=e.head;a!==I9&&(d+=1)>=Number.MAX_SAFE_INTEGER&&(c=!1),b=e.tail}}return IT(d)}),this.isEmpty=IR(this.size,a=>0===a),this.isFull=IR(this.size,a=>a===this.capacity()),this.peek=IP(a=>{let b=I2(this.subscriberHead,a.journal);if(void 0===b)return IQ(a.fiberId);let c=I9,d=!0;for(;d;){let e=I2(b,a.journal);if(void 0===e)return IS;let f=e.head,g=e.tail;f!==I9?(c=f,d=!1):b=g}return IT(c)}),this.peekOption=IP(a=>{let b=I2(this.subscriberHead,a.journal);if(void 0===b)return IQ(a.fiberId);let c=ej(),d=!0;for(;d;){let e=I2(b,a.journal);if(void 0===e)c=ej(),d=!1;else{let a=e.head,f=e.tail;a!==I9?(c=bG(a),d=!1):b=f}}return IT(c)}),this.shutdown=IJ(a=>{let b=I2(this.subscriberHead,a);if(void 0!==b){I3(this.subscriberHead,void 0,a);let c=!0;for(;c;){let d=I2(b,a);if(void 0===d)c=!1;else{let c=d.head,e=d.tail;if(c!==I9){let f=d.subscribers;if(1===f){let c=I2(this.pubsubSize,a);I3(b,Ja(I9,0,e),a),I3(this.publisherHead,e,a),I3(this.pubsubSize,c-1,a)}else I3(b,Ja(c,f-1,e),a)}b=e}}let d=I2(this.subscriberCount,a);I3(this.subscriberCount,d-1,a),I3(this.subscribers,h0(I2(this.subscribers,a),this.subscriberHead),a)}}),this.take=IP(a=>{let b=I2(this.subscriberHead,a.journal);if(void 0===b)return IQ(a.fiberId);let c=I9,d=!0;for(;d;){let e=I2(b,a.journal);if(void 0===e)return IS;let f=e.head,g=e.tail;if(f!==I9){let h=e.subscribers;if(1===h){let c=I2(this.pubsubSize,a.journal);I3(b,Ja(I9,0,g),a.journal),I3(this.publisherHead,g,a.journal),I3(this.pubsubSize,c-1,a.journal)}else I3(b,Ja(f,h-1,g),a.journal);I3(this.subscriberHead,g,a.journal),c=f,d=!1}else b=g}return IT(c)}),this.takeAll=this.takeUpTo(1/0),this.pubsubSize=a,this.publisherHead=b,this.requestedCapacity=c,this.subscriberHead=d,this.subscriberCount=e,this.subscribers=f}capacity(){return this.requestedCapacity}takeUpTo(a){return IP(b=>{let c=I2(this.subscriberHead,b.journal);if(void 0===c)return IQ(b.fiberId);let d=[],e=0;for(;e!==a;){let f=I2(c,b.journal);if(void 0===f)e=a;else{let a=f.head,g=f.tail;if(a!==I9){let h=f.subscribers;if(1===h){let a=I2(this.pubsubSize,b.journal);I3(c,Ja(I9,0,g),b.journal),I3(this.publisherHead,g,b.journal),I3(this.pubsubSize,a-1,b.journal)}else I3(c,Ja(a,h-1,g),b.journal);d.push(a),e+=1}c=g}}return I3(this.subscriberHead,c,b.journal),IT(d)})}}class Jd{constructor(a){this.size=0,this.current=0,this.capacity=a,this.array=Array.from({length:a},_)}head(){return eo(this.array[this.current])}lastOrNull(){if(0===this.size)return;let a=0===this.current?this.array.length-1:this.current-1;return this.array[a]??void 0}put(a){this.array[this.current]=a,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let a=this.current-this.size;return fY(a<0?[...this.array.slice(this.capacity+a,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(a,this.current))}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let Je=Symbol.for("effect/Stream/Handoff"),Jf="Empty",Jg="Full",Jh=a=>({_tag:Jf,notifyConsumer:a}),Ji=(a,b)=>c=>{switch(c._tag){case Jf:return a(c.notifyConsumer);case Jg:return b(c.value,c.notifyProducer)}},Jj={_A:a=>a},Jk=()=>aa(nd(),lb(a=>pf(Jh(a))),lp(a=>({[Je]:Jj,ref:a}))),Jl=W(2,(a,b)=>lb(nd(),c=>le(pi(a.ref,d=>aa(d,Ji(a=>[uH(nk(a,void 0),nf(c)),{_tag:Jg,value:b,notifyProducer:c}],(c,e)=>[lb(nf(e),()=>aa(a,Jl(b))),d])))))),Jm=a=>lb(nd(),b=>le(pi(a.ref,c=>aa(c,Ji(b=>[lb(nf(b),()=>Jm(a)),c],(a,c)=>[kS(nk(c,void 0),a),Jh(b)]))))),Jn="Emit",Jo="Halt",Jp=a=>({_tag:Jo,cause:a}),Jq=a=>({_tag:"End",reason:a}),Jr="ScheduleEnd",Js="UpstreamEnd",Jt={_tag:Jr},Ju={_tag:Js},Jv="DrainLeft",Jw="DrainRight",Jx="PullBoth",Jy="PullLeft",Jz="PullRight",JA={_tag:Jv},JB={_tag:Jw},JC={_tag:Jx},JD=a=>({_tag:Jy,rightChunk:a}),JE=a=>({_tag:Jz,leftChunk:a}),JF="PullBoth",JG="PullLet",JH="PullRight",JI={_tag:JF},JJ=a=>({_tag:JG,rightChunk:a}),JK=a=>({_tag:JH,leftChunk:a}),JL=Symbol.for("effect/Take"),JM={_A:a=>a,_E:a=>a};class JN{constructor(a){this[JL]=JM,this.exit=a}pipe(){return a7(this,arguments)}}let JO=a=>new JN(m6(a)),JP=a=>lz(()=>a.exit),JQ=new JN(m$(ej())),JR=a=>new JN(m_(aa(a,kh(bG)))),JS=W(2,(a,{onEnd:b,onFailure:c,onSuccess:d})=>m4(a.exit,{onFailure:a=>ek(oT(a),{onNone:b,onSome:c}),onSuccess:d})),JT=a=>new JN(m6(fX(a))),JU=Symbol.for("effect/Stream"),JV={_R:a=>a,_E:a=>a,_A:a=>a};class JW{constructor(a){this[JU]=JV,this.channel=a}pipe(){return a7(this,arguments)}}let JX=a=>ap(a,JU)||kP(a),JY=4096,JZ=((a,b,c)=>Kg(JZ(a,b,c),a=>dy(a,{onLeft:ej,onRight:bG})),W(3,(a,b,c)=>Kq(up([Jk(),pf(Jt),pf(fV()),wT(c),pf(!1),pf(!1)])).pipe(Kh(([c,d,e,f,g,h])=>{let i=Fz({onInput:a=>Ft(Fv(aa(c,Jl({_tag:Jn,elements:a}),p3(()=>gg(a)))),()=>i),onFailure:a=>Fv(Jl(c,Jp(a))),onDone:()=>Fv(Jl(c,Jq(Ju)))}),j=aa(ph(e,fV()),lb(a=>gg(a)?aa(pg(g,!0),uH(ly(aa(FF(a),Ft(()=>j))))):aa(Jm(c),lp(a=>{switch(a._tag){case Jn:return aa(Fv(pg(g,!0)),G7(FF(a.elements)),G7(Fv(h.get)),Ft(a=>a?FE:j));case Jo:return Fr(a.cause);case"End":if(a.reason._tag===Jr)return aa(g.get,lp(a=>a?Fv(aa(pg(d,Jt),uH(pg(h,!0)))):aa(Fv(aa(pg(d,Jt),uH(pg(h,!0)))),Ft(()=>j))),G0);return aa(pg(d,a.reason),uH(pg(h,!0)),Fv)}}))),G0),k=a=>f.next(a),l=(a,f,i)=>{let m=aa(pg(g,!1),uH(pg(h,!1)),uH(aa(j,GT(HJ(b)),Fk,GU,u4(i)))),n=(a,b,c)=>aa(pg(e,ge(a)),uH(lp(d.get,a=>{switch(a._tag){case Jr:return aa(up([g.get,m,aa(k(bG(b)),u4(i))]),lp(([a,d,e])=>{let f=aa(c,ek({onNone:()=>fX(dt(b)),onSome:a=>fW(dt(b),ds(a))}));return a?aa(FF(f),Ft(()=>l(d,e,i))):l(d,e,i)}),G0);case Js:return aa(g.get,lp(a=>a?FF(fX(dt(b))):FE),G0)}})),G0);return G0(uU(rU(a),rU(f),{onSelfDone:(a,b)=>aa(lR(f),uH(aa(lz(()=>a),lp(([a,b])=>n(a,b,ej()))))),onOtherDone:(b,d)=>lg(lz(()=>b),{onFailure:b=>dy(kd(b),{onLeft:()=>aa(c,Jl(Jq(Jt)),uu,uH(aa(rU(a),lp(([a,b])=>n(a,b,ej()))))),onRight:b=>aa(c,Jl(Jp(b)),uu,uH(aa(rU(a),lp(([a,b])=>n(a,b,ej())))))}),onSuccess:b=>aa(c,Jl(Jq(Jt)),uu,uH(aa(rU(a),lp(([a,c])=>n(a,c,bG(b))))))})}))};return Lf(c=>Fw(Ko(a),i).pipe(GU,u4(c),uH(GT(j,HJ(b)).pipe(Fk,GU,u4(c),lb(a=>k(ej()).pipe(u4(c),lp(b=>new JW(l(a,b,c)))))))))})))),J$=((a,b)=>lp(K7(a,b),a=>Km(Ks(a))),(a,b)=>{let c=(a,b)=>{let d=c=>aa(b.get,lB(nf),uH(nd()),lb(d=>aa(DS(a,[c,d]),uH(pg(b,d)),uH(nf(d)))),kT,Fv);return Fz({onInput:d=>aa(nd(),lb(c=>aa(DS(a,[JO(d),c]),lb(a=>aa(pg(b,c),p3(()=>a))))),kT,Fv,Ft(()=>c(a,b))),onFailure:a=>d(JR(a)),onDone:()=>d(JQ)})};return G1(aa(a,lb(a=>aa(nd(),lB(a=>nk(a,void 0)),lb(d=>aa(pf(d),lb(d=>aa(b,Fw(c(a,d)),GW,u5)),kS((a=>{let b=aa(Fv(DU(a)),Ft(([a,c])=>G7(Fv(nk(c,void 0)),JS(a,{onEnd:()=>FE,onFailure:Fr,onSuccess:a=>aa(FF(a),Ft(()=>b))}))));return b})(a))))))))}),J_=W(2,(a,b)=>J0(a,a=>dy(kd(a),{onLeft:b,onRight:Kf}))),J0=W(2,(a,b)=>new JW(aa(Ko(a),Fj(a=>Ko(b(a)))))),J1=W(2,(a,b)=>aa(a,J0(a=>aa(b(a),el(()=>Kf(a)))))),J2=a=>kZ(py(a),a=>"None"===a._tag?pX:k5(a.value)),J3=W(4,(a,b,c,d)=>{let e=(a,b)=>G7(Fv(Jm(b)),Fz({onInput:c=>Ft(Fv(aa(a,Jl(JO(c)))),()=>e(a,b)),onFailure:b=>Fv(Jl(a,JR(b))),onDone:()=>Fv(Jl(a,JQ))}));return new JW(G2(f=>up([Jk(),Jk(),Jk(),Jk()]).pipe(lB(([b,c,d])=>Fw(Ko(a),e(b,d)).pipe(F3(f),u4(f))),lB(([a,c,d,g])=>Fw(Ko(b),e(c,g)).pipe(F3(f),u4(f))),lp(([a,b,e,f])=>{let g=Jl(e,void 0).pipe(uH(Jm(a).pipe(lb(JP)))),h=Jl(f,void 0).pipe(uH(Jm(b).pipe(lb(JP))));return Ko(Lc(c,a=>lb(d(a,g,h),J2)))}))))}),J4=W(2,(a,b)=>new JW(aa(Ko(a),G7(Ko(b))))),J5=((a,b)=>Kh(a,()=>b),W(2,(a,b)=>aa(nd(),lb(c=>aa(a,J8({maximumLag:b.maximumLag,decide:a=>lb(nf(c),b=>b(a))}),lb(a=>aa(up(gk(((a,b)=>a<=b?gr(b-a+1,b=>a+b):fX(a))(0,b.size-1),b=>lp(a,([a,c])=>[[a,b],c]))),lp(f1),lb(a=>{let[d,e]=fo(a,[new Map,fV()],([a,b],[c,d])=>[a.set(c[0],c[1]),aa(b,f5(d))]);return aa(nk(c,a=>lp(b.decide(a),a=>b=>aa(a(d.get(b))))),kS(Array.from(e)))})))))))),J6={ref:0},J7=()=>{let a=J6.ref;return J6.ref=a+1,a},J8=W(2,(a,b)=>J9(a,b.maximumLag,b.decide,()=>lF)),J9=W(4,(a,b,c,d)=>aa(un(pf(new Map),(a,b)=>aa(a.get,lb(a=>aa(a.values(),uq(Ea))))),lb(e=>xP(function*(){let f=yield*xT(1),g=yield*pf(aa(D6(b),lb(a=>{let b=J7();return aa(pj(e,c=>c.set(b,a)),kS([b,a]))}))),h=a=>f.withPermits(1)(aa(pg(g,aa(D6(1),lB(b=>DS(b,a)),lb(a=>{let b=J7();return aa(pj(e,c=>c.set(b,a)),kS(eK(b,a)))}))),uH(aa(e.get,lb(b=>aa(fY(b.values()),uq(b=>aa(DS(b,a),pA(a=>j8(a)?bG(lF):ej()))))))),uH(d(a)),kT));return yield*aa(a,KX(a=>aa(c(a),lb(b=>aa(e.get,lb(c=>aa(c.entries(),pW(fV(),(c,[d,e])=>b(d)?aa(DS(e,m6(a)),lg({onFailure:a=>j8(a)?ly(aa(c,f5(d))):k7(a),onSuccess:()=>ly(c)})):ly(c)),lb(a=>gg(a)?aa(pj(e,b=>{for(let c of a)b.delete(c);return b})):lF))))),kT)),lg({onFailure:a=>h(m_(aa(a,kh(bG)))),onSuccess:()=>h(m$(ej()))}),u5),f.withPermits(1)(le(g.get))})))),Ka=((a,b)=>{let c=a=>Fy({onInput:b=>{let d=aa(b,f7(a)),e=Math.max(0,a-b.length);return gf(b)||e>0?c(e):aa(FF(d),G7(GF()))},onFailure:Fq,onDone:()=>FE});return new JW(aa(Ko(a),GT(c(b))))},new JW(FE)),Kb=W(2,(a,b)=>new JW(aa(Ko(a),GA(b)))),Kc=W(2,(a,b)=>new JW(Fp(Ko(a),b))),Kd=a=>aa(Kq(nn),Kh(a)),Ke=a=>Kr(k5(bG(a))),Kf=a=>Kq(k7(a)),Kg=W(2,(a,b)=>KA(a,ga(b))),Kh=W(a=>JX(a[0]),(a,b,c)=>{let d=c?.bufferSize??16;return c?.switch?Ki(c?.concurrency,()=>Kj(a,1,d,b),c=>Kj(a,c,d,b)):Ki(c?.concurrency,()=>new JW(Gx(Ko(a),a=>aa(a,gk(a=>Ko(b(a))),fn(FE,(a,b)=>aa(a,G7(b)))))),d=>new JW(aa(Ko(a),Gx(G3),GQ(a=>Ko(b(a)),c))))}),Ki=(a,b,c)=>{switch(a){case void 0:return b();case"unbounded":return c(Number.MAX_SAFE_INTEGER);default:return a>1?c(a):b()}},Kj=W(4,(a,b,c,d)=>new JW(aa(Ko(a),Gx(G3),GQ(a=>Ko(d(a)),{concurrency:b,mergeStrategy:(a=>{let b=Object.create(Gk);return b._tag=Gi,b})(),bufferSize:c})))),Kk=W(a=>JX(a[0]),(a,b)=>Kh(a,X,b)),Kl=a=>{let b=Fz({onInput:a=>((a,b)=>{let[c,d]=aa(a,gm(a=>!mV(a))),e=aa(gh(d),ek({onNone:()=>b,onSome:m4({onFailure:a=>ek(oT(a),{onNone:()=>FE,onSome:Fr}),onSuccess:()=>FE})}));return aa(FF(aa(c,ga(a=>mV(a)?bG(a.value):ej()))),Ft(()=>e))})(a,b),onFailure:a=>Fr(a),onDone:()=>FE});return new JW(aa(Ko(a),Fw(b)))},Km=a=>(a=>{let b=Fz({onInput:a=>Ft(G3(a),()=>b),onFailure:Fr,onDone:()=>FE});return new JW(aa(Ko(a),Fw(b)))})(Kl(aa(a,Ky(a=>a.exit)))),Kn=a=>new JW(a),Ko=a=>{if("channel"in a)return a.channel;if(kP(a))return Ko(Kq(a));throw TypeError("Expected a Stream.")},Kp=a=>new JW(gf(a)?FE:FF(a)),Kq=a=>aa(a,lr(bG),Kr),Kr=a=>new JW(G0(pH(a,{onFailure:ek({onNone:()=>FE,onSome:Fq}),onSuccess:a=>FF(fX(a))}))),Ks=(a,b)=>{let c=b?.maxChunkSize??JY;if(b?.scoped){let d=lp(a.subscribe,a=>Kw(a,{maxChunkSize:c,shutdown:!0}));return b.shutdown?lp(d,Kb(a.shutdown)):d}let d=Kh(K0(a.subscribe),a=>Kw(a,{maxChunkSize:c}));return b?.shutdown?Kb(d,a.shutdown):d},Kt=a=>K1(()=>fT(a)?Kp(a):Ku(a[Symbol.iterator]())),Ku=(a,b=JY)=>aa(lA(()=>{let c=[],d=a=>aa(lA(()=>{let e=a.next();if(1===b)return e.done?FE:aa(FF(fX(e.value)),Ft(()=>d(a)));c=[];let f=0;for(;!1===e.done&&(c.push(e.value),!((f+=1)>=b));)e=a.next();return f>0?aa(FF(f1(c)),Ft(()=>d(a))):FE}),G0);return new JW(d(a))}),Ld),Kv=a=>aa(a,lp(KR),Le),Kw=(a,b)=>aa(DW(a,1,b?.maxChunkSize??JY),kY(b=>aa(a.isShutdown,lb(a=>a&&j8(b)?k5(ej()):lr(k7(b),bG)))),KR,b?.shutdown?Kb(Ea(a)):X),Kx=((a,b)=>{let c=a=>aa(a.poll,lp(ek({onNone:()=>Fy({onInput:b=>Ft(FF(b),()=>c(a)),onFailure:Fq,onDone:()=>FE}),onSome:m4({onFailure:Fr,onSuccess:()=>FE})})),G0);return new JW(G2(d=>b.pipe(u4(d),lp(b=>Ko(a).pipe(Fw(c(b)))))))},W(2,(a,b)=>new JW(aa(Ko(a),GG(b))))),Ky=((a,b)=>new JW(aa(Ko(a),GH(b))),W(2,(a,b)=>new JW(aa(Ko(a),GM(gk(b)))))),Kz=W(3,(a,b,c)=>K1(()=>{let d=a=>Fy({onInput:b=>aa(lz(()=>{let e=[];return aa(b,pW(a,(a,b)=>aa(c(a,b),lb(([a,b])=>aa(lA(()=>{e.push(b)}),kS(a))))),pH({onFailure:a=>0!==e.length?G7(FF(f1(e)),Fq(a)):Fq(a),onSuccess:a=>Ft(FF(f1(e)),()=>d(a))}))}),G0),onFailure:Fq,onDone:()=>FE});return new JW(aa(Ko(a),GT(d(b))))})),KA=W(2,(a,b)=>new JW(aa(Ko(a),GM(b)))),KB=((a,b)=>aa(a,KA(gc(b))),W(2,(a,b)=>{let c=a=>{let d=a.next();return d.done?Fz({onInput:a=>c(a[Symbol.iterator]()),onFailure:Fr,onDone:FA}):G0(lp(b(d.value),b=>Ft(FF(fX(b)),()=>c(a))))};return new JW(aa(Ko(a),Fw(FC(()=>c(fV()[Symbol.iterator]())))))})),KC=W(3,(a,b,c)=>new JW(aa(Ko(a),Gx(G3),GO(c,b),GM(fX)))),KD=W(2,(a,b)=>new JW(aa(Ko(a),GK(b)))),KE=((a=>JX(a[1]),(a,b,c)=>KG(a,b,{onSelf:X,onOther:X,haltStrategy:c?.haltStrategy})),W(a=>Symbol.iterator in a[0],(a,b)=>Kk(Kt(a),b))),KF=W(2,(a,b)=>KG(a,b,{onSelf:ds,onOther:dt})),KG=W(3,(a,b,c)=>{let d=c.haltStrategy?(a=>{switch(a){case"left":return Hg;case"right":return Hh;case"both":return Hi;case"either":return Hj;default:return a}})(c.haltStrategy):Hi,e=a=>b=>a||!mV(b)?F7(lz(()=>b)):F8(a=>lz(()=>a));return new JW(GR(Ko(Ky(a,c.onSelf)),{other:Ko(Ky(b,c.onOther)),onSelfDone:e("Either"===d._tag||"Left"===d._tag),onOtherDone:e("Either"===d._tag||"Right"===d._tag)}))}),KH=((a,b)=>new JW(aa(Ko(a),GS(()=>Ko(b())))),W(2,(a,b)=>{let c=Fy({onInput:a=>gf(a)?FC(()=>c):aa(FF(a),G7(GF())),onFailure:Fq,onDone:()=>FC(()=>Ko(b()))});return new JW(aa(Ko(a),Fw(c)))})),KI=((a=>"function"==typeof a[1],(a,b,c)=>aa(KB(a,b),J5({size:2,maximumLag:c?.bufferSize??16,decide:dy({onLeft:()=>ly(a=>0===a),onRight:()=>ly(a=>1===a)})}),lb(([a,b])=>ly([Kg(Kl(Kw(a,{shutdown:!0})),a=>dy(a,{onLeft:bG,onRight:ej})),Kg(Kl(Kw(b,{shutdown:!0})),a=>dy(a,{onLeft:ej,onRight:bG}))])))),W(2,(a,b)=>new JW(Fw(Ko(a),b)))),KJ=W(2,(a,b)=>new JW(aa(Ko(a),Fx(b)))),KK=((a,b)=>KN(a,bX(b)),W(2,(a,b)=>new JW(G2(c=>v7(b,c).pipe(lp(b=>aa(Ko(a),Fx(b)))))))),KL=W(3,(a,b,c)=>KM(a,b,Kq(c))),KM=W(3,(a,b,c)=>Kd(d=>Kh(c,c=>aa(a,KJ(bS(d,b,c)))))),KN=W(2,(a,b)=>Kd(c=>aa(a,KJ(b(c))))),KO=((a,b)=>aa(a,KK(aa(wb(),wj(b)))),W(2,(a,b)=>K1(()=>{let c=Math.max(b,1),d=KP(new KQ(c),c);return new JW(aa(Ko(a),Fw(d)))}))),KP=(a,b)=>Fz({onInput:c=>{if(c.length===b&&a.isEmpty())return Ft(FF(c),()=>KP(a,b));if(c.length>0){let d,e=[],f=0;for(;f<c.length;){for(;f<c.length&&void 0===d;)d=a.write(aa(c,f3(f))),f+=1;void 0!==d&&(e.push(d),d=void 0)}return Ft(((...a)=>G3(fY(a)))(...e),()=>KP(a,b))}return FC(()=>KP(a,b))},onFailure:b=>G7(a.emitIfNotEmpty(),Fr(b)),onDone:()=>a.emitIfNotEmpty()});class KQ{constructor(a){this.builder=[],this.pos=0,this.n=a}isEmpty(){return 0===this.pos}write(a){if(this.builder.push(a),this.pos+=1,this.pos===this.n){let a=f1(this.builder);return this.builder=[],this.pos=0,a}}emitIfNotEmpty(){return 0!==this.pos?FF(f1(this.builder)):FE}}(a,b,c)=>new JW(Gw(Ko(a),a=>ek(b(a),{onNone:()=>Fr(j2(c(a))),onSome:Fq})));let KR=a=>Lc(a,a=>aa(lp(a,b=>bG([b,a])),kZ(ek({onNone:()=>ly(ej()),onSome:k5})))),KS=a=>KR(aa(a,lp(fX))),KT=((a,b)=>KT(a,b,{onElement:a=>dt(a),onSchedule:ds}),W(3,(a,b,c)=>aa(wT(b),lp(b=>{let d=aa(a,KL(wI,b.iterationMeta.get),Ky(c.onElement),Ko),e=G0(pH(b.next(void 0),{onFailure:()=>FE,onSuccess:a=>Ft(d,()=>G7(FF(fX(c.onSchedule(a))),e))}));return new JW(G7(d,e))}),Ld))),KU=((a,b)=>wT(b).pipe(lp(b=>{let c=Ko(KL(wI,b.iterationMeta.get)(a)).pipe(GN(a=>kS(b.reset,a)),Gw(a=>b.next(a).pipe(pH({onFailure:()=>Fq(a),onSuccess:()=>c}),G0)));return c}),G0,Kn),W(2,(a,b)=>Ko(a).pipe(GT(HJ(b)),GV))),KV=((a,b,c,d)=>KU(a,Ht(b,c,d)),W(2,(a,b)=>KU(a,HC(b)))),KW=W(2,(a,b)=>KU(a,HD(b))),KX=W(2,(a,b)=>aa(a,K_(HC(b)))),KY=W(2,(a,b)=>aa(a,K$(b))),KZ=((a,b)=>aa(a,K$(b),xS),W(2,(a,b)=>{let c=Fz({onInput:a=>Ft(Fv(DT(b,gk(a,m6))),()=>c),onFailure:a=>Fv(DS(b,m_(kh(a,bG)))),onDone:()=>Fv(DS(b,m$(ej())))});return aa(Fw(Ko(a),c),Gz,GW,kT)})),K$=W(2,(a,b)=>{let c=Fz({onInput:a=>Ft(FF(JO(a)),()=>c),onFailure:a=>FF(JR(a)),onDone:()=>FF(JQ)});return aa(Fw(Ko(a),c),GN(a=>DS(b,a)),Gz,GW,kT)}),K_=W(2,(a,b)=>aa(Ko(a),GT(HJ(b)),Gz,GW)),K0=((a,b)=>aa(a,Kz(ej(),(a,c)=>{switch(a._tag){case"None":return ly([bG(c),c]);case"Some":return aa(b(a.value,c),lp(a=>[bG(a),a]))}})),a=>new JW(GA(GX(aa(a,lp(fX))),lF))),K1=((a,b,c)=>b<=0||c<=0?Kq(k1(new mM("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero"))):new JW(FC(()=>{let d=new Jd(b),e=(a,e)=>{if(a<b){let a=d.toChunk();return aa(FF(gf(a)?fV():fX(a)),Ft(()=>e))}let f=a-(a-b)%c;if(f===a)return e;let g=aa(d.toChunk(),go(a-(f-b+c)));return aa(FF(gf(g)?fV():fX(g)),Ft(()=>e))},f=a=>Fz({onInput:e=>Ft(FF(ga(e,(e,f)=>{d.put(e);let g=a+f+1;return g<b||(g-b)%c>0?ej():bG(d.toChunk())})),()=>f(a+e.length)),onFailure:b=>e(a,Fr(b)),onDone:()=>e(a,FE)});return aa(Ko(a),Fw(f(0)))})),a=>new JW(FC(()=>Ko(a())))),K2=W(2,(a,b)=>{let c=Fy({onInput:a=>{let d=aa(a,gp(b));return d.length===a.length?aa(FF(d),Ft(()=>c)):FF(d)},onFailure:Fq,onDone:FA});return new JW(aa(Ko(a),GT(c)))}),K3=((a,b)=>KB(a,a=>kS(b(a),a)),(a,b,c,d,e)=>{let f=(a,g)=>Fz({onInput:h=>aa(b(h),uF(oB),lp(([b,i])=>{let j=a+(i-g)/g3(d)*c,k=c+e<0?1/0:c+e,l=j<0?k:Math.min(j,k);return b<=l?aa(FF(h),Ft(()=>f(l-b,i))):f(a,g)}),G0),onFailure:Fr,onDone:()=>FE}),g=aa(oB,lp(a=>f(c,a)),G0);return new JW(aa(Ko(a),GT(g)))}),K4=(a,b,c,d,e)=>{let f=(a,g)=>Fz({onInput:h=>aa(b(h),uF(oB),lp(([b,i])=>{let j=a+(i-g)/g3(d)*c,k=c+e<0?1/0:c+e,l=(j<0?k:Math.min(j,k))-b,m=gZ(Math.max(0,(l>=0?0:-l/c)*g3(d)));return ha(m,gV)?aa(Fv(oV(m)),G7(FF(h)),Ft(()=>f(l,i))):Ft(FF(h),()=>f(l,i))}),G0),onFailure:Fr,onDone:()=>FE}),g=aa(oB,lp(a=>f(c,a)),G0);return new JW(aa(Ko(a),GT(g)))},K5=W(3,(a,b,c)=>aa(K8(a),lp(u8({onTimeout:()=>kh(b(),bG),duration:c})),Kv)),K6=((a,b,c)=>{let d=new mH("Stream Timeout");return aa(a,K5(()=>j2(d),b),J1(a=>"Die"===a._tag&&ap(a.defect,mG)&&void 0!==a.defect.message&&"Stream Timeout"===a.defect.message?bG(c):ej()))},a=>{if("number"==typeof a)return EQ(a);if("unbounded"===a.capacity){let b;return b={replay:a.replay},lz(()=>Ey((a=>new Et(a?.replay?new EN(a.replay):void 0))(b),new EJ))}switch(a.strategy){case"dropping":return lz(()=>Ey(Em(a),new EJ));case"sliding":return lz(()=>Ey(Em(a),new EK));default:return EQ(a)}}),K7=W(2,(a,b)=>aa(un(K6(b),a=>a.shutdown),lB(b=>aa(a,KY(b),u5)))),K8=a=>{let b;return lp((b=Ko(a),lb(uK,a=>GZ(b,a))),a=>aa(a,lr(bG),lb(dy({onLeft:()=>k5(ej()),onRight:ly}))))},K9=W(a=>JX(a[0]),(a,b)=>lB(un(b?.strategy==="unbounded"?D9():b?.strategy==="dropping"?D7(b.capacity??2):b?.strategy==="sliding"?D8(b.capacity??2):D6(b?.capacity??2),a=>Ea(a)),b=>u5(K$(a,b)))),La=((a=>JX(a[0]),(a,b)=>lB(un(D6(b?.capacity??2),a=>Ea(a)),b=>u5(KZ(a,b)))),W(a=>JX(a[0]),(a,b)=>lp(vU(),c=>Lb(a,c,b)))),Lb=W(a=>JX(a[0]),(a,b,c)=>{let d,e,f=vG(b),g=new u0(!1??!1);return new ReadableStream({start(b){(e=f(KW(a,a=>0===a.length?lF:g.whenOpen(lA(()=>{for(let c of(g.unsafeClose(),a))b.enqueue(c);d(),d=void 0}))))).addObserver(a=>{try{"Failure"===a._tag?b.error(oU(a.cause)):b.close()}catch{}})},pull:()=>new Promise(a=>{d=a,vZ(g.open)}),cancel(){if(e)return vX(kT(lR(e)))}},c?.strategy)}),Lc=(a,b)=>K1(()=>{let c=a=>G0(lp(b(a),ek({onNone:()=>FE,onSome:([a,b])=>Ft(FF(a),()=>c(b))})));return new JW(c(a))}),Ld=a=>Kk(Kq(a)),Le=a=>Kk(K0(a)),Lf=a=>{let b;return Kk((b=b=>a(b),new JW(GY(a=>b(a).pipe(lp(fX))))))},Lg=((a,b)=>aa(Kq(b),Kh(b=>b?a:Ka)),W(3,(a,b,c)=>{let d=(a,b,c)=>{switch(a._tag){case JF:return aa(J2(b),uF(J2(c),{concurrent:!0}),lh({onFailure:a=>ly(m$(bG(a))),onSuccess:([a,f])=>bE(a)&&bE(f)?gf(a.value)&&gf(f.value)?d(JI,b,c):gf(a.value)?d(JJ(f.value),b,c):gf(f.value)?d(JK(a.value),b,c):ly(m6(e(a.value,f.value))):ly(m$(ej()))}));case JG:return lh(b,{onFailure:a=>ly(m$(a)),onSuccess:f=>gf(f)?d(JJ(a.rightChunk),b,c):gf(a.rightChunk)?d(JK(f),b,c):ly(m6(e(f,a.rightChunk)))});case JH:return lh(c,{onFailure:a=>ly(m$(a)),onSuccess:f=>gf(f)?d(JK(a.leftChunk),b,c):gf(a.leftChunk)?d(JJ(f),b,c):ly(m6(e(a.leftChunk,f)))})}},e=(a,b)=>{let[d,e]=c(a,b);switch(e._tag){case"Left":if(gf(e.left))return[d,JI];return[d,JK(e.left)];case"Right":if(gf(e.right))return[d,JI];return[d,JJ(e.right)]}};return aa(a,J3(b,JI,d))})),Lh=(a,b,c)=>a.length>b.length?[aa(a,f6(b.length),gq(b,c)),ds(aa(a,f7(b.length)))]:[aa(a,gq(aa(b,f6(a.length)),c)),dt(aa(b,f7(a.length)))],Li=W(a=>JX(a[0]),(a,b="utf-8")=>K1(()=>{let c=new TextDecoder(b);return Ky(a,a=>c.decode(a))})),Lj=Symbol.for("effect/GroupBy"),Lk={_R:a=>a,_E:a=>a,_K:a=>a,_V:a=>a},Ll=W(a=>ap(a[0],Lj),(a,b,c)=>Kh(a.grouped,([a,c])=>b(a,Km(Kw(c,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:c?.bufferSize??16})),Lm=W(a=>"function"!=typeof a[0],(a,b,c)=>c?.key?Ll(Lo(a,c.key,{bufferSize:c.bufferSize}),(a,c)=>KB(c,b)):Ki(c?.concurrency,()=>KB(a,b),d=>c?.unordered?Kh(a,a=>Kq(b(a)),{concurrency:d}):KC(a,d,b)));class Ln extends b2{static{p=DG}constructor(a,b){super(),this[p]={_Out:a=>a},this.dequeue=a,this.f=b}capacity(){return this.dequeue.capacity()}get size(){return this.dequeue.size}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return this.dequeue.awaitShutdown}isActive(){return this.dequeue.isActive()}get isShutdown(){return this.dequeue.isShutdown}get shutdown(){return Ea(this.dequeue)}get isFull(){return this.dequeue.isFull}get isEmpty(){return this.dequeue.isEmpty}get take(){return aa(DU(this.dequeue),lp(a=>this.f(a)))}get takeAll(){return aa(this.dequeue.takeAll,lp(gk(a=>this.f(a))))}takeUpTo(a){return aa(DV(this.dequeue,a),lp(gk(a=>this.f(a))))}takeBetween(a,b){return aa(DW(this.dequeue,a,b),lp(gk(a=>this.f(a))))}takeN(a){return aa(DX(this.dequeue,a),lp(gk(a=>this.f(a))))}poll(){return aa(lp(this.dequeue.takeUpTo(1),gh),lp(et(a=>this.f(a))))}pipe(){return a7(this,arguments)}commit(){return this.take}}let Lo=W(a=>"function"!=typeof a[0],(a,b,c)=>{let d=(a,e)=>Fz({onInput:f=>Ft(Fv(uq(Lp(f,b),([b,d])=>{let f=a.get(b);return void 0===f?aa(D6(c?.bufferSize??16),lb(c=>aa(lA(()=>{a.set(b,c)}),uH(DS(e,JT([b,c]))),uH(aa(DS(c,JO(d)),pA(a=>j9(a)?bG(lF):ej())))))):pA(DS(f,JO(d)),a=>j9(a)?bG(lF):ej())},{discard:!0})),()=>d(a,e)),onFailure:a=>Fv(DS(e,JR(a))),onDone:()=>aa(Fv(aa(uq(a.entries(),([a,b])=>aa(DS(b,JQ),pA(a=>j9(a)?bG(lF):ej())),{discard:!0}),uH(DS(e,JQ)))))});return{[Lj]:Lk,pipe(){return a7(this,arguments)},grouped:Lf(b=>xP(function*(){let c=new Map,e=yield*D9();return yield*mz(b,Ea(e)),yield*Ko(a).pipe(Fw(d(c,e)),Gz,F3(b),u4(b),kS(Km(Kw(e,{shutdown:!0}))))}))}}),Lp=W(2,(a,b)=>{let c,d=[],e=a[Symbol.iterator](),f=new Map;for(;(c=e.next())&&!c.done;){let a=c.value,e=b(a);if(f.has(e))f.get(e).push(a);else{let b=[a];d.push([e,b]),f.set(e,b)}}return f1(d.map(a=>[a[0],f1(a[1])]))}),Lq=(...a)=>{let b=1===a.length?a[0].evaluate:a[0],c=1===a.length?a[0].onError:a[1],d=1===a.length&&!0===a[0].releaseLockOnEnd;return Le(lp(un(lA(()=>b().getReader()),a=>d?lA(()=>a.releaseLock()):xQ(()=>a.cancel())),a=>KS(lb(p0({try:()=>a.read(),catch:a=>bG(c(a))}),({done:a,value:b})=>a?k5(ej()):ly(b)))))},Lr=a=>KU(a,Hr),Ls=Symbol.for("@effect/platform/Cookies"),Lt=a=>ap(a,Ls),Lu=Symbol.for("@effect/platform/Cookies/Cookie"),Lv=Symbol.for("@effect/platform/Cookies/CookieError");class Lw extends DA(Lv,"CookieError"){get message(){return this.reason}}let Lx={[Ls]:Ls,...a_,toJSON(){return{_id:"@effect/platform/Cookies",cookies:eH(this.cookies,a=>a.toJSON())}},pipe(){return a7(this,arguments)}},Ly=a=>{let b=Object.create(Lx);return b.cookies=a,b},Lz=a=>{let b={};for(let c of a)b[c.name]=c;return Ly(b)},LA=Lz([]),LB=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,LC={[Lu]:Lu,...a_,toJSON(){return{_id:"@effect/platform/Cookies/Cookie",name:this.name,value:this.value,options:this.options}}};function LD(a,b,c){if(!LB.test(a))return ds(new Lw({reason:"InvalidName"}));let d=encodeURIComponent(b);if(d&&!LB.test(d))return ds(new Lw({reason:"InvalidValue"}));if(void 0!==c){if(void 0!==c.domain&&!LB.test(c.domain))return ds(new Lw({reason:"InvalidDomain"}));if(void 0!==c.path&&!LB.test(c.path))return ds(new Lw({reason:"InvalidPath"}));if(void 0!==c.maxAge&&"Infinity"===gP(c.maxAge).value._tag)return ds(new Lw({reason:"InfinityMaxAge"}))}return dt(Object.assign(Object.create(LC),{name:a,value:b,valueEncoded:d,options:c}))}(a,b)=>Ly({...a.cookies,...b.cookies}),(a,b,c,d)=>Ly(eJ(a.cookies,b,dA(LD(b,c,d),X)));let LE=W(2,(a,b)=>{let c={...a.cookies};for(let[a,d,e]of b){let b=LD(a,d,e);if(dq(b))return b;c[a]=b.right}return dt(Ly(c))});function LF(a){let b=a.name+"="+a.valueEncoded;if(void 0===a.options)return b;let c=a.options;if(void 0!==c.maxAge&&(b+="; Max-Age="+Math.trunc(g5(c.maxAge,{onMillis:a=>a/1e3,onNanos:a=>Number(a)/1e9}))),void 0!==c.domain&&(b+="; Domain="+c.domain),void 0!==c.path&&(b+="; Path="+c.path),void 0!==c.priority)switch(c.priority){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High"}if(void 0!==c.expires&&(b+="; Expires="+c.expires.toUTCString()),c.httpOnly&&(b+="; HttpOnly"),c.secure&&(b+="; Secure"),c.partitioned&&(b+="; Partitioned"),void 0!==c.sameSite)switch(c.sameSite){case"lax":b+="; SameSite=Lax";break;case"strict":b+="; SameSite=Strict";break;case"none":b+="; SameSite=None"}return b}(a,b)=>dA(LE(a,b),X);let LG=a=>{try{return decodeURIComponent(a)}catch{return a}},LH=Symbol.for("@effect/platform/Headers"),LI=Object.assign(Object.create(null),{[LH]:LH,[a3](a){return LQ(this,o2(a,LR))}}),LJ=a=>Object.assign(Object.create(LI),a),LK=Object.create(LI),LL=a=>{if(void 0===a)return LK;if(Symbol.iterator in a){let b=Object.create(LI);for(let[c,d]of a)b[c.toLowerCase()]=d;return b}let b=Object.create(LI);for(let[c,d]of Object.entries(a))Array.isArray(d)?b[c.toLowerCase()]=d.join(", "):void 0!==d&&(b[c.toLowerCase()]=d);return b},LM=W(3,(a,b,c)=>{let d=LJ(a);return d[b.toLowerCase()]=c,d}),LN=W(2,(a,b)=>LJ({...a,...LL(b)})),LO=W(2,(a,b)=>{let c=LJ(a);return Object.assign(c,b),c}),LP=W(2,(a,b)=>{let c=LJ(a),d=b=>{if("string"==typeof b){let d=b.toLowerCase();d in a&&delete c[d]}else for(let d in a)b.test(d)&&delete c[d]};if(Array.isArray(b))for(let a=0;a<b.length;a++)d(b[a]);else d(b);return c}),LQ=W(2,(a,b)=>{let c={...a},d=b=>{if("string"==typeof b){let d=b.toLowerCase();d in a&&(c[d]=dY(a[d]))}else for(let d in a)b.test(d)&&(c[d]=dY(a[d]))};if(Array.isArray(b))for(let a=0;a<b.length;a++)d(b[a]);else d(b);return c}),LR=ad("@effect/platform/Headers/currentRedactedNames",()=>md(["authorization","cookie","set-cookie","x-api-key"])),LS=a=>{let b=LT(a),c=[];for(let a=0;a<b.length;a++)if(Array.isArray(b[a][0])){let[d,e]=b[a];c.push([`${d[0]}[${d.slice(1).join("][")}]`,e])}else c.push(b[a]);return c},LT=a=>{let b=Symbol.iterator in a?eO(a):Object.entries(a),c=[];for(let[a,d]of b)if(Array.isArray(d))for(let b=0;b<d.length;b++)void 0!==d[b]&&c.push([a,String(d[b])]);else if("object"==typeof d)for(let[b,e]of LT(d))c.push([[a,..."string"==typeof b?[b]:b],e]);else void 0!==d&&c.push([a,String(d)]);return c},LU=((a,b,c)=>eT(fm(a,([a])=>a!==b),[b,String(c)]),W(2,(a,b)=>{let c=LS(b),d=c.map(([a])=>a);return eU(fm(a,([a])=>d.includes(a)),c)})),LV=W(3,(a,b,c)=>eT(a,[b,String(c)])),LW=((a,b)=>eU(a,LS(b)),bY("@effect/platform/FileSystem")),LX=Symbol.for("@effect/platform/HttpBody"),LY=Symbol.for("@effect/platform/HttpBody/HttpBodyError");class LZ{constructor(){this[LX]=LX}[aY](){return this.toJSON()}toString(){return a$(this)}}class L$ extends LZ{toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Empty"}}constructor(...a){super(...a),this._tag="Empty"}}let L_=new L$;class L0 extends LZ{constructor(a,b){super(),this._tag="Uint8Array",this.body=a,this.contentType=b}get contentLength(){return this.body.length}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Uint8Array",body:this.contentType.startsWith("text/")||this.contentType.endsWith("json")?new TextDecoder().decode(this.body):`Uint8Array(${this.body.length})`,contentType:this.contentType,contentLength:this.contentLength}}}let L1=new TextEncoder,L2=(a,b)=>{let c;return c=L1.encode(a),new L0(c,b??"text/plain"??"application/octet-stream")},L3=a=>pz({try:()=>L2(JSON.stringify(a),"application/json"),catch:a=>(a=>{let b=void 0===a?Object.create(bs):iU(a);return b._tag="HttpBodyError",b})({[LY]:LY,reason:{_tag:"JsonError",error:a}})}),L4=Symbol.for("@effect/platform/HttpServerResponse"),L5=Symbol.for("@effect/platform/HttpServerRespondable");class L6 extends b3{constructor(a,b,c,d,e){if(super(),this.status=a,this.statusText=b,this.cookies=d,this.body=e,this[L4]=L4,e.contentType||e.contentLength){let a={...c};e.contentType&&(a["content-type"]=e.contentType),e.contentLength&&(a["content-length"]=e.contentLength.toString()),this.headers=a}else this.headers=c}commit(){return ly(this)}[L5](){return ly(this)}[aY](){return this.toJSON()}toString(){return a$(this)}toJSON(){return{_id:"@effect/platform/HttpServerResponse",status:this.status,statusText:this.statusText,headers:a6(this.headers),cookies:this.cookies.toJSON(),body:this.body.toJSON()}}}let L7=a=>"object"==typeof a&&null!==a&&L4 in a,L8=a=>new L6(a?.status??204,a?.statusText,a?.headers?LL(a.headers):LK,a?.cookies??LA,L_),L9=W(3,(a,b,c)=>new L6(a.status,a.statusText,LM(a.headers,b,c),a.cookies,a.body)),Ma=(a,b)=>lp(L3(a),a=>new L6(b?.status??200,b?.statusText,b?.headers?LL(b.headers):LK,b?.cookies??LA,a)),Mb=Symbol.for("@effect/platform/HttpServerRespondable"),Mc=a=>ap(a,Mb),Md=L8({status:400}),Me=L8({status:404}),Mf=a=>L7(a)?ly(a):lv(a[Mb]()),Mg=Symbol.for("@effect/platform/HttpServerError"),Mh=ad("@effect/platform/HttpServerError/clientAbortFiberId",()=>iy(-499,0)),Mi=L8({status:500}),Mj=L8({status:499}),Mk=L8({status:503}),Ml=Mg;class Mm extends DA(Ml,"RequestError"){[Mb](){return L8({status:400})}get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class Mn extends DA(Ml,"RouteNotFound"){constructor(a){super(a),this.stack=`${this.name}: ${this.message}`}[Mb](){return L8({status:404})}get message(){return`${this.request.method} ${this.request.url} not found`}}let Mo=a=>{let[b,c]=ks(a,[ly(Mi),j0],(a,b)=>{switch(b._tag){case"Empty":return bG(a);case"Fail":return bG([((a,b)=>L7(a)?ly(a):Mc(a)?kY(a[Mb](),()=>ly(b)):ap(a,Av)?ly(Md):ap(a,mN)?ly(Me):ly(b))(b.error,Mi),b]);case"Die":return bG([((a,b)=>L7(a)?ly(a):Mc(a)?kY(a[Mb](),()=>ly(b)):ly(b))(b.defect,Mi),b]);case"Interrupt":if("Empty"!==a[1]._tag)return ej();return bG([ly(b.fiberId===Mh?Mj:Mk),b]);default:return ej()}});return lp(b,a=>c._tag===jU?[a,j2(a)]:[a,j5(c,j2(a))])},Mp=Symbol.for("@effect/platform/HttpIncomingMessage"),Mq=(a,b)=>{let c=Bn(a,b);return a=>lb(a.json,c)},Mr=ad("@effect/platform/HttpIncomingMessage/maxBodySize",()=>md(ej())),Ms=(a,b)=>{let c,d=a.headers["content-type"]??"";if(d.includes("application/json"))try{c=vZ(a.json)}catch{}else if(d.includes("text/")||d.includes("urlencoded"))try{c=vZ(a.text)}catch{}let e={...b,headers:a6(a.headers),remoteAddress:a.remoteAddress.toJSON()};return void 0!==c&&(e.body=c),e},Mt=Symbol.for("effect/Mailbox"),Mu=Symbol.for("effect/Mailbox/ReadonlyMailbox"),Mv=fV(),Mw=m6(Mv),Mx=m6(!1),My=m6(!0),Mz=[Mv,!0];class MA extends b2{constructor(a,b,c){super(),this[Mt]=Mt,this[Mu]=Mu,this.state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set},this.messages=[],this.messagesChunk=fV(),this.shutdown=lA(()=>{if("Done"===this.state._tag)return!0;this.messages=[],this.messagesChunk=Mv;let a=this.state.offers;if(this.finalize("Open"===this.state._tag?m7:this.state.exit),a.size>0){for(let b of a)"Single"===b._tag?b.resume(Mx):b.resume(m6(f1(b.remaining.slice(b.offset))));a.clear()}return!0}),this.end=this.done(m7),this.clear=lz(()=>{if("Done"===this.state._tag)return mW(this.state.exit,Mv);let a=this.unsafeTakeAll();return this.releaseCapacity(),ly(a)}),this.takeAll=lz(()=>{if("Done"===this.state._tag)return mW(this.state.exit,Mz);let a=this.unsafeTakeAll();return 0===a.length?lO(this.awaitTake,this.takeAll):ly([a,this.releaseCapacity()])}),this.take=lz(()=>this.unsafeTake()??lO(this.awaitTake,this.take)),this.await=kW(a=>"Done"===this.state._tag?a(this.state.exit):(this.state.awaiters.add(a),lA(()=>{"Done"!==this.state._tag&&this.state.awaiters.delete(a)}))),this.size=lA(()=>this.unsafeSize()),this.awaitTake=kW(a=>"Done"===this.state._tag?a(this.state.exit):(this.state.takers.add(a),lA(()=>{"Done"!==this.state._tag&&this.state.takers.delete(a)}))),this.scheduleRunning=!1,this.releaseTaker=()=>{if(this.scheduleRunning=!1,"Done"===this.state._tag||0===this.state.takers.size)return;let a=(a=>{let b=a[Symbol.iterator]().next();if(b.done)throw Error("unsafeHead: empty iterable");return b.value})(this.state.takers);this.state.takers.delete(a),a(m7)},this.scheduler=a,this.capacity=b,this.strategy=c}offer(a){return lz(()=>{if("Open"!==this.state._tag)return Mx;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return Mx;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(a),this.releaseTaker(),My;return this.offerRemainingSingle(a);case"sliding":return this.unsafeTake(),this.messages.push(a),My}return this.messages.push(a),this.scheduleReleaseTaker(),My})}unsafeOffer(a){return"Open"===this.state._tag&&(this.messages.length+this.messagesChunk.length>=this.capacity?"sliding"===this.strategy?(this.unsafeTake(),this.messages.push(a),!0):this.capacity<=0&&this.state.takers.size>0&&(this.messages.push(a),this.releaseTaker(),!0):(this.messages.push(a),this.scheduleReleaseTaker(),!0))}offerAll(a){return lz(()=>{if("Open"!==this.state._tag)return ly(fY(a));let b=this.unsafeOfferAllArray(a);return 0===b.length?Mw:"dropping"===this.strategy?ly(f1(b)):this.offerRemainingArray(b)})}unsafeOfferAll(a){return f1(this.unsafeOfferAllArray(a))}unsafeOfferAllArray(a){if("Open"!==this.state._tag)return eO(a);if(this.capacity===1/0||"sliding"===this.strategy)return this.messages.length>0&&(this.messagesChunk=f9(this.messagesChunk,f1(this.messages))),"sliding"===this.strategy?this.messagesChunk=this.messagesChunk.pipe(f9(fY(a)),go(this.capacity)):fT(a)?this.messagesChunk=f9(this.messagesChunk,a):this.messages=eO(a),this.scheduleReleaseTaker(),[];let b=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(0===b)return eO(a);let c=[],d=0;for(let e of a)d<b?this.messages.push(e):c.push(e),d++;return this.scheduleReleaseTaker(),c}fail(a){return this.done(m$(a))}failCause(a){return this.done(m_(a))}unsafeDone(a){return"Open"===this.state._tag&&(0===this.state.offers.size&&0===this.messages.length&&0===this.messagesChunk.length?this.finalize(a):this.state={...this.state,_tag:"Closing",exit:a},!0)}done(a){return lA(()=>this.unsafeDone(a))}takeN(a){return lz(()=>{let b;if("Done"===this.state._tag)return mW(this.state.exit,Mz);if(a<=0)return ly([Mv,!1]);if((a=Math.min(a,this.capacity))<=this.messagesChunk.length)b=f6(this.messagesChunk,a),this.messagesChunk=f7(this.messagesChunk,a);else{if(!(a<=this.messages.length+this.messagesChunk.length))return lO(this.awaitTake,this.takeN(a));this.messagesChunk=f9(this.messagesChunk,f1(this.messages)),this.messages=[],b=f6(this.messagesChunk,a),this.messagesChunk=f7(this.messagesChunk,a)}return ly([b,this.releaseCapacity()])})}unsafeTake(){let a;if("Done"===this.state._tag)return m9(this.state.exit,m$(new mO));if(this.messagesChunk.length>0)a=gi(this.messagesChunk),this.messagesChunk=f7(this.messagesChunk,1);else if(this.messages.length>0)a=this.messages[0],this.messagesChunk=f7(f1(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?m6(this.messages.pop()):void 0;else return;return this.releaseCapacity(),m6(a)}unsafeSize(){let a=this.messages.length+this.messagesChunk.length;return"Done"===this.state._tag?ej():bG(a)}commit(){return this.takeAll}pipe(){return a7(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return a$(this)}[aY](){return a$(this)}offerRemainingSingle(a){return kW(b=>{if("Open"!==this.state._tag)return b(Mx);let c={_tag:"Single",message:a,resume:b};return this.state.offers.add(c),lA(()=>{"Open"===this.state._tag&&this.state.offers.delete(c)})})}offerRemainingArray(a){return kW(b=>{if("Open"!==this.state._tag)return b(m6(f1(a)));let c={_tag:"Array",remaining:a,offset:0,resume:b};return this.state.offers.add(c),lA(()=>{"Open"===this.state._tag&&this.state.offers.delete(c)})})}releaseCapacity(){if("Done"===this.state._tag)return"Success"===this.state.exit._tag;if(0===this.state.offers.size)return"Closing"===this.state._tag&&0===this.messages.length&&0===this.messagesChunk.length&&(this.finalize(this.state.exit),"Success"===this.state.exit._tag);let a=this.capacity-this.messages.length-this.messagesChunk.length;for(let b of this.state.offers)if(0===a)break;else if("Single"===b._tag)this.messages.push(b.message),a--,b.resume(My),this.state.offers.delete(b);else{for(;b.offset<b.remaining.length;b.offset++){if(0===a)return!1;this.messages.push(b.remaining[b.offset]),a--}b.resume(Mw),this.state.offers.delete(b)}return!1}scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}unsafeTakeAll(){if(this.messagesChunk.length>0){let a=this.messages.length>0?f9(this.messagesChunk,f1(this.messages)):this.messagesChunk;return this.messagesChunk=Mv,this.messages=[],a}if(this.messages.length>0){let a=f1(this.messages);return this.messages=[],a}return"Done"!==this.state._tag&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,fX(this.messages.pop())):Mv}finalize(a){if("Done"===this.state._tag)return;let b=this.state;for(let c of(this.state={_tag:"Done",exit:a},b.takers))c(a);for(let c of(b.takers.clear(),b.awaiters))c(a);b.awaiters.clear()}}let MB=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,MC=/\\([\v\u0020-\u00ff])/gu,MD=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,ME=/^[!#$%&'*+.^\w|~-]+$/u,MF={value:"",parameters:Object.create(null)};function MG(a,b=!1){let c,d,e;if("string"!=typeof a)return MF;let f=a.indexOf(";"),g=-1!==f?a.slice(0,f).trim():a.trim();if(!1===(b?ME:MD).test(g))return MF;let h={value:g.toLowerCase(),parameters:Object.create(null)};if(-1===f)return h;for(MB.lastIndex=f;d=MB.exec(a);){if(d.index!==f)return MF;f+=d[0].length,c=d[1].toLowerCase(),'"'===(e=d[2])[0]&&(e=e.slice(1,e.length-1),!b&&MC.test(e)&&(e=e.replace(MC,"$1"))),h.parameters[c]=e}return f!==a.length?MF:h}!function(a){a[a.key=0]="key",a[a.whitespace=1]="whitespace",a[a.value=2]="value"}(A||(A={}));let MH={_tag:"Continue"},MI=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1],MJ=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];!function(a){a[a.headers=0]="headers",a[a.body=1]="body"}(B||(B={}));let MK={_tag:"InvalidDisposition"},ML={_tag:"EndNotReached"},MM={_tag:"ReachedLimit",limit:"MaxParts"},MN={_tag:"ReachedLimit",limit:"MaxTotalSize"},MO={_tag:"ReachedLimit",limit:"MaxPartSize"},MP={_tag:"ReachedLimit",limit:"MaxFieldSize"},MQ=new TextEncoder().encode("\r\n");function MR(a){return void 0!==a.filename||"application/octet-stream"===a.contentType}function MS(a){}let MT=new TextDecoder("utf-8"),MU=function({headers:a,onFile:b,onField:c,onError:d,onDone:e,isFile:f=MR,maxParts:g=1/0,maxTotalSize:h=1/0,maxPartSize:i=1/0,maxFieldSize:j=1048576}){let k=MG(a["content-type"]).parameters.boundary;if(void 0===k)return d({_tag:"InvalidBoundary"}),{write:MS,end(){}};let l={state:B.headers,index:0,parts:0,onChunk:MS,info:void 0,headerSkip:0,partSize:0,totalSize:0,isFile:!1,fieldChunks:[],fieldSize:0};function m(){l.state=B.body,l.isFile=!0,l.onChunk=MS}let n=function(){let a=new TextDecoder,b={state:A.key,headers:Object.create(null),key:"",value:void 0,crlf:0,previousChunk:void 0,pairs:0,size:0};function c(a){return b.state=A.key,b.headers=Object.create(null),b.key="",b.value=void 0,b.crlf=0,b.previousChunk=void 0,b.pairs=0,b.size=0,a}function d(a,b){let c=new Uint8Array(a.length+b.length);return c.set(a),c.set(b,a.length),c}function e(a){return c({_tag:"Failure",reason:a,headers:b.headers})}return function(f,g){let h,i=0;if(void 0!==b.previousChunk){h=i=b.previousChunk.length;let a=new Uint8Array(f.length+i);a.set(b.previousChunk),a.set(f,i),b.previousChunk=void 0,f=a}let j=f.length;a:for(;g<j;){if(b.state===A.key){let c=g;for(;c<j;c++){if(b.size++>16384)return e("HeaderTooLarge");if(58===f[c]){if(b.key+=a.decode(f.subarray(g,c)).toLowerCase(),0===b.key.length)return e("InvalidHeaderName");32===f[c+1]&&32!==f[c+2]&&9!==f[c+2]?(g=c+2,b.state=A.value,b.size++):32!==f[c+1]&&9!==f[c+1]?(g=c+1,b.state=A.value):(g=c+1,b.state=A.whitespace);break}if(1!==MI[f[c]])return e("InvalidHeaderName")}if(c===j)return b.key+=a.decode(f.subarray(g,j)).toLowerCase(),MH}if(b.state===A.whitespace){for(;g<j;g++){if(b.size++>16384)return e("HeaderTooLarge");if(32!==f[g]&&9!==f[g]){b.state=A.value;break}}if(g===j)return MH}if(b.state===A.value){let k=g;for(void 0!==h&&(k=h,h=void 0);k<j;k++){if(b.size++>16384)return e("HeaderTooLarge");if(13===f[k]||b.crlf>0){let h=f[k];if(13===h&&0===b.crlf&&(b.crlf=1,k++,b.size++,h=f[k]),10===h&&1===b.crlf&&(b.crlf=2,k++,b.size++,h=f[k]),13===h&&2===b.crlf&&(b.crlf=3,k++,b.size++,h=f[k]),10===h&&3===b.crlf&&(b.crlf=4,k++,b.size++),b.crlf<4&&k>=j)return b.previousChunk=f.subarray(g),MH;if(b.crlf>=2){b.value=void 0===b.value?f.subarray(g,k-b.crlf):d(b.value,f.subarray(g,k-b.crlf));let h=a.decode(b.value);if(void 0===b.headers[b.key]?b.headers[b.key]=h:"string"==typeof b.headers[b.key]?b.headers[b.key]=[b.headers[b.key],h]:b.headers[b.key].push(h),g=k,b.size--,4!==b.crlf&&100===b.pairs)return e("TooManyHeaders");if(3===b.crlf)return e("InvalidHeaderValue");if(4===b.crlf)return c({_tag:"Headers",headers:b.headers,endPosition:g-i});b.pairs++,b.key="",b.value=void 0,b.crlf=0,b.state=A.key;continue a}}else if(1!==MJ[f[k]])return e("InvalidHeaderValue")}if(k===j)return b.value=void 0===b.value?f.subarray(g,j):d(b.value,f.subarray(g,j)),MH}}return g>j&&(b.size+=j-g),MH}}(),o=function(a,b,c){let d=function(a){let b=new TextEncoder().encode(a),c=b.length,d={};for(let a=0;a<c;a++){let c=b[a];void 0===d[c]&&(d[c]=[]),d[c].push(a)}return{needle:b,needleLength:c,indexes:d,firstByte:b[0],previousChunk:void 0,previousChunkLength:0,matchIndex:0}}(a);void 0!==c&&(d.previousChunk=c,d.previousChunkLength=c.length);let e=function(){if("Buffer"in globalThis&&!("Bun"in globalThis||"Deno"in globalThis))return function(a,b,c){return Buffer.prototype.indexOf.call(a,b,c)};let a=new Uint8Array(256).fill(d.needle.length);for(let b=0,c=d.needle.length-1;b<c;++b)a[d.needle[b]]=c-b;return function(b,c,e){let f=b.length,g=e+d.needleLength-1;for(;g<f;){for(let a=d.needleLength-1,e=g;a>=0&&b[e]===c[a];a--,e--)if(0===a)return e;g+=a[b[g]]}return -1}}();return{write:function(a){let c=a.length;if(void 0!==d.previousChunk){let b=new Uint8Array(d.previousChunkLength+c);b.set(d.previousChunk),b.set(a,d.previousChunkLength),a=b,c=d.previousChunkLength+c,d.previousChunk=void 0}if(c<d.needleLength){d.previousChunk=a,d.previousChunkLength=c;return}let f=0;for(;f<c;){let g=e(a,d.needle,f);if(g>-1){g>f&&b(d.matchIndex,a.subarray(f,g)),d.matchIndex+=1,f=g+d.needleLength;continue}if(a[c-1]in d.indexes){let e=d.indexes[a[c-1]],g=-1;for(let b=0,f=e.length;b<f;b++){let f=e[b];a[c-1-f]===d.firstByte&&b>g&&(g=f)}-1===g?0===f?b(d.matchIndex,a):b(d.matchIndex,a.subarray(f)):(c-1-g>f&&b(d.matchIndex,a.subarray(f,c-1-g)),d.previousChunk=a.subarray(c-1-g),d.previousChunkLength=g+1)}else 0===f?b(d.matchIndex,a):b(d.matchIndex,a.subarray(f));break}},end:function(){void 0!==d.previousChunk&&d.previousChunk!==c&&b(d.matchIndex,d.previousChunk),d.previousChunk=c,d.previousChunkLength=c?.length??0,d.matchIndex=0}}}(`\r
--${k}`,function(a,h){if(0===a)return void m();if(a!==l.index){if(l.index>0)if(l.isFile)l.onChunk(null),l.partSize=0;else{if(1===l.fieldChunks.length)c(l.info,l.fieldChunks[0]);else{let a=new Uint8Array(l.fieldSize),b=0;for(let c=0;c<l.fieldChunks.length;c++){let d=l.fieldChunks[c];a.set(d,b),b+=d.length}c(l.info,a)}l.fieldSize=0,l.fieldChunks=[]}if(l.state=B.headers,l.index=a,l.headerSkip=2,45===h[0]&&45===h[1])return e();l.parts++,l.parts>g&&d(MM)}if((l.partSize+=h.length)>i&&d(MO),l.state===B.headers){let a,c=n(h,l.headerSkip);if(l.headerSkip=0,"Continue"===c._tag)return;if("Failure"===c._tag)return m(),d({_tag:"BadHeaders",error:c});let e=MG(c.headers["content-type"]),g=MG(c.headers["content-disposition"],!0);if("form-data"===g.value&&!("name"in g.parameters))return m(),d(MK);if("filename*"in g.parameters){let b=g.parameters["filename*"].split("''");2===b.length&&(a=decodeURIComponent(b[1]))}if(l.info={name:g.parameters.name??"",filename:a??g.parameters.filename,contentType:""===e.value?void 0!==g.parameters.filename?"application/octet-stream":"text/plain":e.value,contentTypeParameters:e.parameters,contentDisposition:g.value,contentDispositionParameters:g.parameters,headers:c.headers},l.state=B.body,l.isFile=f(l.info),l.isFile&&(l.onChunk=b(l.info)),c.endPosition<h.length)if(l.isFile)l.onChunk(h.subarray(c.endPosition));else{let a=h.subarray(c.endPosition);(l.fieldSize+=a.length)>j&&d(MP),l.fieldChunks.push(a)}}else l.isFile?l.onChunk(h):((l.fieldSize+=h.length)>j&&d(MP),l.fieldChunks.push(h))},MQ);return{write:a=>(l.totalSize+=a.length)>h?d(MN):o.write(a),end(){o.end(),l.state===B.body&&d(ML),l.state=B.headers,l.index=0,l.parts=0,l.onChunk=MS,l.info=void 0,l.totalSize=0,l.partSize=0,l.fieldChunks=[],l.fieldSize=0}}},MV=Symbol.for("@effect/platform/Path"),MW=bY("@effect/platform/Path");function MX(a,b){let c,d="",e=0,f=-1,g=0;for(let h=0;h<=a.length;++h){if(h<a.length)c=a.charCodeAt(h);else if(47===c)break;else c=47;if(47===c){if(f===h-1||1===g);else if(f!==h-1&&2===g){if(d.length<2||2!==e||46!==d.charCodeAt(d.length-1)||46!==d.charCodeAt(d.length-2)){if(d.length>2){let a=d.lastIndexOf("/");if(a!==d.length-1){-1===a?(d="",e=0):e=(d=d.slice(0,a)).length-1-d.lastIndexOf("/"),f=h,g=0;continue}}else if(2===d.length||1===d.length){d="",e=0,f=h,g=0;continue}}b&&(d.length>0?d+="/..":d="..",e=2)}else d.length>0?d+="/"+a.slice(f+1,h):d=a.slice(f+1,h),e=h-f-1;f=h,g=0}else 46===c&&-1!==g?++g:g=-1}return d}let MY=function(){let a,b="",c=!1;for(let d=arguments.length-1;d>=-1&&!c;d--){let e;if(d>=0)e=arguments[d];else{let b=globalThis.process;void 0===a&&"process"in globalThis&&"object"==typeof b&&null!==b&&"function"==typeof b.cwd&&(a=b.cwd()),e=a}0!==e.length&&(b=e+"/"+b,c=47===e.charCodeAt(0))}if(b=MX(b,!c),c)if(b.length>0)return"/"+b;else return"/";return b.length>0?b:"."},MZ=/%/g,M$=/\\/g,M_=/\n/g,M0=/\r/g,M1=/\t/g,M2=MW.of({[MV]:MV,resolve:MY,normalize(a){if(0===a.length)return".";let b=47===a.charCodeAt(0),c=47===a.charCodeAt(a.length-1);return(0!==(a=MX(a,!b)).length||b||(a="."),a.length>0&&c&&(a+="/"),b)?"/"+a:a},isAbsolute:a=>a.length>0&&47===a.charCodeAt(0),join(){let a;if(0==arguments.length)return".";for(let b=0;b<arguments.length;++b){let c=arguments[b];c.length>0&&(void 0===a?a=c:a+="/"+c)}return void 0===a?".":M2.normalize(a)},relative(a,b){if(a===b||(a=M2.resolve(a),b=M2.resolve(b),a===b))return"";let c=1;for(;c<a.length&&47===a.charCodeAt(c);++c);let d=a.length,e=d-c,f=1;for(;f<b.length&&47===b.charCodeAt(f);++f);let g=b.length-f,h=e<g?e:g,i=-1,j=0;for(;j<=h;++j){if(j===h){if(g>h){if(47===b.charCodeAt(f+j))return b.slice(f+j+1);else if(0===j)return b.slice(f+j)}else e>h&&(47===a.charCodeAt(c+j)?i=j:0===j&&(i=0));break}let d=a.charCodeAt(c+j);if(d!==b.charCodeAt(f+j))break;47===d&&(i=j)}let k="";for(j=c+i+1;j<=d;++j)(j===d||47===a.charCodeAt(j))&&(0===k.length?k+="..":k+="/..");return k.length>0?k+b.slice(f+i):(f+=i,47===b.charCodeAt(f)&&++f,b.slice(f))},dirname(a){if(0===a.length)return".";let b=a.charCodeAt(0),c=47===b,d=-1,e=!0;for(let c=a.length-1;c>=1;--c)if(47===(b=a.charCodeAt(c))){if(!e){d=c;break}}else e=!1;return -1===d?c?"/":".":c&&1===d?"//":a.slice(0,d)},basename(a,b){let c,d=0,e=-1,f=!0;if(void 0!==b&&b.length>0&&b.length<=a.length){if(b.length===a.length&&b===a)return"";let g=b.length-1,h=-1;for(c=a.length-1;c>=0;--c){let i=a.charCodeAt(c);if(47===i){if(!f){d=c+1;break}}else -1===h&&(f=!1,h=c+1),g>=0&&(i===b.charCodeAt(g)?-1==--g&&(e=c):(g=-1,e=h))}return d===e?e=h:-1===e&&(e=a.length),a.slice(d,e)}for(c=a.length-1;c>=0;--c)if(47===a.charCodeAt(c)){if(!f){d=c+1;break}}else -1===e&&(f=!1,e=c+1);return -1===e?"":a.slice(d,e)},extname(a){let b=-1,c=0,d=-1,e=!0,f=0;for(let g=a.length-1;g>=0;--g){let h=a.charCodeAt(g);if(47===h){if(!e){c=g+1;break}continue}-1===d&&(e=!1,d=g+1),46===h?-1===b?b=g:1!==f&&(f=1):-1!==b&&(f=-1)}return -1===b||-1===d||0===f||1===f&&b===d-1&&b===c+1?"":a.slice(b,d)},format:function(a){if(null===a||"object"!=typeof a)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof a);let b=a.dir||a.root,c=a.base||(a.name||"")+(a.ext||"");return b?b===a.root?b+c:b+"/"+c:c},parse(a){let b,c={root:"",dir:"",base:"",ext:"",name:""};if(0===a.length)return c;let d=a.charCodeAt(0),e=47===d;e?(c.root="/",b=1):b=0;let f=-1,g=0,h=-1,i=!0,j=a.length-1,k=0;for(;j>=b;--j){if(47===(d=a.charCodeAt(j))){if(!i){g=j+1;break}continue}-1===h&&(i=!1,h=j+1),46===d?-1===f?f=j:1!==k&&(k=1):-1!==f&&(k=-1)}return -1===f||-1===h||0===k||1===k&&f===h-1&&f===g+1?-1!==h&&(0===g&&e?c.base=c.name=a.slice(1,h):c.base=c.name=a.slice(g,h)):(0===g&&e?(c.name=a.slice(1,f),c.base=a.slice(1,h)):(c.name=a.slice(g,f),c.base=a.slice(g,h)),c.ext=a.slice(f,h)),g>0?c.dir=a.slice(0,g-1):e&&(c.dir="/"),c},sep:"/",fromFileUrl:function(a){if("file:"!==a.protocol)return k5(new DC({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));if(""!==a.hostname)return k5(new DC({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let b=a.pathname;for(let a=0;a<b.length;a++)if("%"===b[a]){let c=32|b.codePointAt(a+2);if("2"===b[a+1]&&102===c)return k5(new DC({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return ly(decodeURIComponent(b))},toFileUrl:function(a){var b;let c=new URL("file://"),d=MY(a);return 47===a.charCodeAt(a.length-1)&&"/"!==d[d.length-1]&&(d+="/"),(b=d).includes("%")&&(b=b.replace(MZ,"%25")),b.includes("\\")&&(b=b.replace(M$,"%5C")),b.includes("\n")&&(b=b.replace(M_,"%0A")),b.includes("\r")&&(b=b.replace(M0,"%0D")),b.includes("	")&&(b=b.replace(M1,"%09")),c.pathname=b,ly(c)},toNamespacedPath:X}),M3=Symbol.for("@effect/platform/Multipart"),M4=Symbol.for("@effect/platform/Multipart/MultipartError");class M5 extends DA(M4,"MultipartError"){get message(){return this.reason}}let M6=ad("@effect/platform/Multipart/maxParts",()=>md(ej())),M7=ad("@effect/platform/Multipart/maxFieldSize",()=>md((a=>"bigint"==typeof a?a:BigInt(a))(0xa00000))),M8=ad("@effect/platform/Multipart/maxFileSize",()=>md(ej())),M9=ad("@effect/platform/Multipart/fieldMimeTypes",()=>md(fW("application/json"))),Na=a=>"Success"===a._tag?FE:Fr(a.cause);class Nb extends a0{constructor(){super(),this[M3]=M3}}class Nc extends Nb{constructor(a,b,c){super(),this._tag="Field",this.key=a,this.contentType=b,this.value=c}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"Field",key:this.key,contentType:this.contentType,value:this.value}}}class Nd extends Nb{constructor(a,b){super(),this._tag="File",this.key=a.name,this.name=a.filename??a.name,this.contentType=a.contentType,this.content=Kn(b),this.contentEffect=b.pipe(Fw(Nf),GU,lr(a=>new M5({reason:"InternalError",cause:a})))}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"File",key:this.key,name:this.name,contentType:this.contentType}}}let Ne=(a,b)=>lb(LW,c=>lr(KU(b.content,c.sink(a)),a=>new M5({reason:"InternalError",cause:a}))),Nf=FC(()=>{let a=new Uint8Array(0),b=Fz({onInput(c){for(let b of c){let c=new Uint8Array(a.length+b.length);c.set(a,0),c.set(b,a.length),a=c}return b},onFailure:a=>Fr(a),onDone:()=>FA(a)});return b});class Ng extends Nb{constructor(a,b,c,d){super(),this._tag="PersistedFile",this.key=a,this.name=b,this.contentType=c,this.path=d}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"PersistedFile",key:this.key,name:this.name,contentType:this.contentType,path:this.path}}}let Nh=Symbol.for("@effect/platform/HttpServerRequest"),Ni=bY("@effect/platform/HttpServerRequest"),Nj=bY("@effect/platform/HttpServerRequest/ParsedSearchParams");class Nk extends a0{constructor(a,b,c,d){super(),this.source=a,this.url=b,this.headersOverride=c,this.remoteAddressOverride=d,this[Nh]=Nh,this[Mp]=Mp}toJSON(){return Ms(this,{_id:"@effect/platform/HttpServerRequest",method:this.method,url:this.originalUrl})}modify(a){return new Nk(this.source,a.url??this.url,a.headers??this.headersOverride,a.remoteAddress??this.remoteAddressOverride)}get method(){return this.source.method.toUpperCase()}get originalUrl(){return this.source.url}get remoteAddress(){return this.remoteAddressOverride?bG(this.remoteAddressOverride):ej()}get headers(){return this.headersOverride??=LL(this.source.headers),this.headersOverride}get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=function(a){let b={},c=a.length,d=0,e=0;for(;e!==c;){-1===(e=a.indexOf(";",d))&&(e=c);let f=a.indexOf("=",d);if(-1===f)break;if(f>e){d=e+1;continue}let g=a.substring(d,f++).trim();if(void 0===b[g]){let c=34===a.charCodeAt(f)?a.substring(f+1,e-1).trim():a.substring(f,e).trim();b[g]=-1!==c.indexOf("%")?LG(c):c}d=e+1}return b}(this.headers.cookie??"")}get stream(){return this.source.body?Lq(()=>this.source.body,a=>new Mm({request:this,reason:"Decode",cause:a})):Ke(new Mm({request:this,reason:"Decode",description:"can not create stream from empty body"}))}get text(){return this.textEffect||(this.textEffect=vZ(xO(p0({try:()=>this.source.text(),catch:a=>new Mm({request:this,reason:"Decode",cause:a})})))),this.textEffect}get json(){return p1(this.text,{try:a=>JSON.parse(a),catch:a=>new Mm({request:this,reason:"Decode",cause:a})})}get urlParamsBody(){return lb(this.text,a=>pz({try:()=>LS(new URLSearchParams(a)),catch:a=>new Mm({request:this,reason:"Decode",cause:a})}))}get multipart(){return this.multipartEffect||(this.multipartEffect=vZ(xO(((a,b=Ne)=>xP(function*(){let c=yield*LW,d=yield*MW,e=yield*c.makeTempDirectoryScoped(),f=Object.create(null);return yield*KV(a,a=>{if("Field"===a._tag)return a.key in f?"string"==typeof f[a.key]?f[a.key]=[f[a.key],a.value]:f[a.key].push(a.value):f[a.key]=a.value,lF;if(""===a.name)return lF;let c=d.join(e,d.basename(a.name).slice(-128)),g=new Ng(a.key,a.name,a.contentType,c);return Array.isArray(f[a.key])?f[a.key].push(g):f[a.key]=[g],b(c,a)}),f}).pipe(pC({SystemError:a=>k5(new M5({reason:"InternalError",cause:a})),BadArgument:a=>k5(new M5({reason:"InternalError",cause:a}))})))(this.multipartStream)))),this.multipartEffect}get multipartStream(){return KI(KD(this.stream,a=>new M5({reason:"InternalError",cause:a})),((a,b=16)=>{let c,d,e,f;return c=up([kQ(b=>{let c=b.getFiberRef(M9);return ly({headers:a,maxParts:ep(b.getFiberRef(M6)),maxFieldSize:Number(b.getFiberRef(M7)),maxPartSize:b.getFiberRef(M8).pipe(et(Number),ep),maxTotalSize:b.getFiberRef(Mr).pipe(et(Number),ep),isFile:0===c.length?void 0:a=>!gs(c,b=>a.contentType.includes(b))&&MR(a)})}),(f=b,kQ(a=>ly(new MA(a.currentScheduler,"number"==typeof f?f:f?.capacity??1/0,"number"==typeof f?"suspend":f?.strategy??"suspend"))))]),d=([a,b])=>{let c=[],d=ej(),e=MU({...a,onField(a,b){c.push(new Nc(a.name,a.contentType,(function(a){if("utf-8"===a||"utf8"===a||""===a)return MT;try{return new TextDecoder(a)}catch(a){return MT}})(a.contentTypeParameters.charset??"utf-8").decode(b)))},onFile(a){let b=[],d=!1,e=FC(()=>{if(0===b.length)return d?FE:G7(f,e);let a=f1(b);return b=[],d?FF(a):G7(FF(a),G7(f,e))});return c.push(new Nd(a,e)),function(a){null===a?d=!0:b.push(a)}},onError(a){d=bG(m$(function(a){if("ReachedLimit"===a._tag)switch(a.limit){case"MaxParts":return new M5({reason:"TooManyParts",cause:a});case"MaxFieldSize":return new M5({reason:"FieldTooLarge",cause:a});case"MaxPartSize":return new M5({reason:"FileTooLarge",cause:a});case"MaxTotalSize":return new M5({reason:"BodyTooLarge",cause:a})}return new M5({reason:"Parse",cause:a})}(a)))},onDone(){d=bG(m7)}}),f=Ft(b.takeAll,([a,b])=>FD(()=>{gd(a,gd(e.write)),b&&e.end()})),g=Ft(f,()=>{if(0===c.length)return"None"===d._tag?g:Na(d.value);let a=f1(c);return c=[],G7(FF(a),"None"===d._tag?g:Na(d.value))});return Fo(g,{awaitRead:()=>lF,emit:a=>b.offer(a),error:a=>(d=bG(m_(a)),b.end),done:a=>b.end})},e=([,a])=>a.shutdown,Ft(Fv(pf(()=>lF)),a=>aa(Fv(lD(lB(c,b=>pg(a,a=>e(b,a))))),Ft(d),Fp(b=>lb(a.get,a=>a(b)))))})(this.headers))}get arrayBuffer(){return this.arrayBufferEffect||(this.arrayBufferEffect=vZ(xO(p0({try:()=>this.source.arrayBuffer(),catch:a=>new Mm({request:this,reason:"Decode",cause:a})})))),this.arrayBufferEffect}get upgrade(){return k5(new Mm({request:this,reason:"Decode",description:"Not an upgradeable ServerRequest"}))}}let Nl=(a,b)=>lb(Ni,Mq(a,b)),Nm=a=>{let b=a.headers.host??"localhost",c="https"===a.headers["x-forwarded-proto"]?"https":"http";try{return bG(new URL(a.url,`${c}://${b}`))}catch{return ej()}},Nn=ad(Symbol.for("@effect/platform/HttpApp/preResponseHandlers"),()=>md(ej())),No=/^[0-9a-f]{32}$/i,Np=/^[0-9a-f]{16}$/i,Nq=ad(Symbol.for("@effect/platform/HttpMiddleware/tracerDisabledWhen"),()=>md($)),Nr=b_()("@effect/platform/HttpMiddleware/SpanNameGenerator",{defaultValue:()=>a=>`http.server ${a.method}`}),Ns=a=>kQ(b=>{let c=bV(b.currentContext,Ni);if(b.getFiberRef(Nq)(c))return a;let d=ep(Nm(c));void 0!==d&&(""!==d.username||""!==d.password)&&(d.username="REDACTED",d.password="REDACTED");let e=b.getFiberRef(LR),f=LQ(c.headers,e);return p6(bV(b.currentContext,Nr)(c),{parent:ep((a=>{let b=(a=>{if(!a.traceparent)return ej();let b=a.traceparent.split("-");if(4!==b.length)return ej();let[c,d,e,f]=b;return"00"!==c||!1===No.test(d)||!1===Np.test(e)?ej():bG(pk({traceId:d,spanId:e,sampled:(1&parseInt(f,16))==1}))})(a);return"Some"===b._tag||"Some"===(b=(a=>{if(!("b3"in a))return ej();let b=a.b3.split("-");return b.length<2?ej():bG(pk({traceId:b[0],spanId:b[1],sampled:!b[2]||"1"===b[2]}))})(a))._tag?b:(a=>a["x-b3-traceid"]&&a["x-b3-spanid"]?bG(pk({traceId:a["x-b3-traceid"],spanId:a["x-b3-spanid"],sampled:!a["x-b3-sampled"]||"1"===a["x-b3-sampled"]})):ej())(a)})(c.headers)),kind:"server",captureStackTrace:!1},b=>{for(let a in b.attribute("http.request.method",c.method),void 0!==d&&(b.attribute("url.full",d.toString()),b.attribute("url.path",d.pathname),""!==d.search.slice(1)&&b.attribute("url.query",d.search.slice(1)),b.attribute("url.scheme",d.protocol.slice(0,-1))),void 0!==c.headers["user-agent"]&&b.attribute("user_agent.original",c.headers["user-agent"]),f)b.attribute(`http.request.header.${a}`,String(f[a]));return"Some"===c.remoteAddress._tag&&b.attribute("client.address",c.remoteAddress.value),lb(k4(p7(a,b)),a=>{let c=(a=>"Success"===a._tag?a.value:(a=>{let b,c=kg(a,a=>L7(a)?(b=a,bG(j0)):ej());return[b??Mi,c]})(a.cause)[0])(a);b.attribute("http.response.status_code",c.status);let d=LQ(c.headers,e);for(let a in d)b.attribute(`http.response.header.${a}`,String(d[a]));return a})})}),Nt=Symbol.for("@effect/platform/HttpApp/handled"),Nu=a=>{let b=vG(a);return(c,d)=>{let e=Symbol.for("@effect/platform/HttpApp/resolve"),f=((a,b,c)=>{let d=kY(kQ(c=>lb(a,a=>{let d=bV(c.currentContext,Ni),e=c.getFiberRef(Nn);return"None"===e._tag?(d[Nt]=!0,kS(b(d,a),a)):lB(e.value(d,a),a=>(d[Nt]=!0,b(d,a)))})),a=>kQ(c=>lb(Mo(a),([a,d])=>{let e=bV(c.currentContext,Ni),f=c.getFiberRef(Nn);return"None"===f._tag?(e[Nt]=!0,uH(b(e,a),k7(d))):uH(lB(f.value(e,a),a=>(e[Nt]=!0,b(e,a))),k7(d))})));return lD(xS(X(void 0===c?Ns(d):lg(c(Ns(d)),{onFailure:a=>kQ(c=>{let d=bV(c.currentContext,Ni);return Nt in d?lF:lg(Mo(a),{onFailure:a=>b(d,L8({status:500})),onSuccess:([a])=>b(d,a)})}),onSuccess:a=>kQ(c=>{let d=bV(c.currentContext,Ni);return Nt in d?lF:b(d,a)})}))))})(c,(b,c)=>(b[e](((a,b)=>{let c=new globalThis.Headers(a.headers);if(0!==eI(a.cookies.cookies).length)for(let b of Object.values(a.cookies.cookies).map(LF))c.append("set-cookie",b);if(b?.withoutBody)return new Response(void 0,{status:a.status,statusText:a.statusText,headers:c});let d=a.body;switch(d._tag){case"Empty":return new Response(void 0,{status:a.status,statusText:a.statusText,headers:c});case"Uint8Array":case"Raw":if(d.body instanceof Response)return d.body;return new Response(d.body,{status:a.status,statusText:a.statusText,headers:c});case"FormData":return new Response(d.formData,{status:a.status,statusText:a.statusText,headers:c});case"Stream":return new Response(Lb(d.stream,b?.runtime??vV),{status:a.status,statusText:a.statusText,headers:c})}})(c,{withoutBody:"HEAD"===b.method,runtime:a})),lF),d);return(c,d)=>new Promise(g=>{let h=new Map(a.context.unsafeMap);if(bP(d))for(let[a,b]of d.unsafeMap)h.set(a,b);let i=(a=>new Nk(a,(a=>{if("/"===a[0])return a;let b=a.indexOf("/",a.indexOf("//")+2);return -1===b?"/":a.slice(b)})(a.url)))(c);h.set(Ni.key,i),i[e]=g;let j=b(mb(f,mg,bO(h)));c.signal?.addEventListener("abort",()=>{j.unsafeInterruptAsFork(Mh)},{once:!0})})}},Nv=Symbol.for("@effect/platform/HttpClientError");class Nw extends DA(Nv,"RequestError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class Nx extends DA(Nv,"ResponseError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){let a=`${this.response.status} ${this.methodAndUrl}`;return this.description?`${this.reason}: ${this.description} (${a})`:`${this.reason} error (${a})`}}let Ny=Symbol.for("@effect/platform/HttpClientRequest"),Nz={[Ny]:Ny,...a_,toJSON(){return{_id:"@effect/platform/HttpClientRequest",method:this.method,url:this.url,urlParams:this.urlParams,hash:this.hash,headers:a6(this.headers),body:this.body.toJSON()}},pipe(){return a7(this,arguments)}};function NA(a,b,c,d,e,f){let g=Object.create(Nz);return g.method=a,g.url=b,g.urlParams=c,g.hash=d,g.headers=e,g.body=f,g}let NB=NA("GET","",[],ej(),LK,L_),NC=a=>(b,c)=>NK(NB,{method:a,url:b,...c??void 0}),ND=NC("GET"),NE=NC("POST"),NF=NC("PUT"),NG=NC("PATCH"),NH=NC("DELETE"),NI=NC("HEAD"),NJ=NC("OPTIONS"),NK=W(2,(a,b)=>{let c=a;return b.method&&(c=NP(c,b.method)),b.url&&(c=NQ(c,b.url)),b.headers&&(c=NM(c,b.headers)),b.urlParams&&(c=NT(c,b.urlParams)),b.hash&&(c=NU(c,b.hash)),b.body&&(c=NV(c,b.body)),b.accept&&(c=NN(c,b.accept)),b.acceptJson&&(c=NO(c)),c}),NL=W(3,(a,b,c)=>NA(a.method,a.url,a.urlParams,a.hash,LM(a.headers,b,c),a.body)),NM=W(2,(a,b)=>NA(a.method,a.url,a.urlParams,a.hash,LN(a.headers,b),a.body)),NN=W(2,(a,b)=>NL(a,"Accept",b)),NO=NN("application/json"),NP=W(2,(a,b)=>NA(b,a.url,a.urlParams,a.hash,a.headers,a.body)),NQ=W(2,(a,b)=>{if("string"==typeof b)return NA(a.method,b,a.urlParams,a.hash,a.headers,a.body);let c=new URL(b.toString()),d=LS(c.searchParams),e=c.hash?bG(c.hash.slice(1)):ej();return c.search="",c.hash="",NA(a.method,c.toString(),d,e,a.headers,a.body)}),NR=W(2,(a,b)=>NA(a.method,b.endsWith("/")&&a.url.startsWith("/")?b+a.url.slice(1):b+a.url,a.urlParams,a.hash,a.headers,a.body)),NS=W(3,(a,b,c)=>NA(a.method,a.url,LV(a.urlParams,b,c),a.hash,a.headers,a.body)),NT=W(2,(a,b)=>NA(a.method,a.url,LU(a.urlParams,b),a.hash,a.headers,a.body)),NU=W(2,(a,b)=>NA(a.method,a.url,a.urlParams,bG(b),a.headers,a.body)),NV=W(2,(a,b)=>{let c=a.headers;if("Empty"===b._tag||"FormData"===b._tag)c=LP(c,["Content-type","Content-length"]);else{let a=b.contentType;a&&(c=LM(c,"content-type",a));let d=b.contentLength;d&&(c=LM(c,"content-length",d.toString()))}return NA(a.method,a.url,a.urlParams,a.hash,c,b)}),NW=W(2,(a,b)=>lp(L3(b),b=>NV(a,b))),NX=Symbol.for("@effect/platform/HttpClientResponse");class NY extends a0{constructor(a,b){super(),this.request=a,this.source=b,this[Mp]=Mp,this[NX]=NX}toJSON(){return Ms(this,{_id:"@effect/platform/HttpClientResponse",request:this.request.toJSON(),status:this.status})}get status(){return this.source.status}get headers(){return LL(this.source.headers)}get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=(a=>{let b=[];for(let c of"string"==typeof a?[a]:a){let a=function(a){let b=a.split(";").map(a=>a.trim()).filter(a=>""!==a);if(0===b.length)return ej();let c=b[0].indexOf("=");if(-1===c)return ej();let d=b[0].slice(0,c);if(!LB.test(d))return ej();let e=b[0].slice(c+1),f=LG(e);if(1===b.length)return bG(Object.assign(Object.create(LC),{name:d,value:f,valueEncoded:e}));let g={};for(let a=1;a<b.length;a++){let c=b[a],d=c.indexOf("="),e=-1===d?c:c.slice(0,d).trim(),f=-1===d?void 0:c.slice(d+1).trim();switch(e.toLowerCase()){case"domain":{if(void 0===f)break;let a=f.trim().replace(/^\./,"");a&&(g.domain=a);break}case"expires":{if(void 0===f)break;let a=new Date(f);isNaN(a.getTime())||(g.expires=a);break}case"max-age":{if(void 0===f)break;let a=parseInt(f,10);isNaN(a)||(g.maxAge=g$(a));break}case"path":if(void 0===f)break;"/"===f[0]&&(g.path=f);break;case"priority":if(void 0===f)break;switch(f.toLowerCase()){case"low":g.priority="low";break;case"medium":g.priority="medium";break;case"high":g.priority="high"}break;case"httponly":g.httpOnly=!0;break;case"secure":g.secure=!0;break;case"partitioned":g.partitioned=!0;break;case"samesite":if(void 0===f)break;switch(f.toLowerCase()){case"lax":g.sameSite="lax";break;case"strict":g.sameSite="strict";break;case"none":g.sameSite="none"}}}return bG(Object.assign(Object.create(LC),{name:d,value:f,valueEncoded:e,options:Object.keys(g).length>0?g:void 0}))}(c.trim());bE(a)&&b.push(a.value)}return Lz(b)})(this.source.headers.getSetCookie())}get remoteAddress(){return ej()}get stream(){return this.source.body?Lq(()=>this.source.body,a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})):Ke(new Nx({request:this.request,response:this,reason:"EmptyBody",description:"can not create stream from empty body"}))}get json(){return p1(this.text,{try:a=>""===a?null:JSON.parse(a),catch:a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})})}get text(){return this.textBody??=p0({try:()=>this.source.text(),catch:a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})}).pipe(xO,vZ)}get urlParamsBody(){return lb(this.text,a=>pz({try:()=>LS(new URLSearchParams(a)),catch:a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})}))}get formData(){return this.formDataBody??=p0({try:()=>this.source.formData(),catch:a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})}).pipe(xO,vZ)}get arrayBuffer(){return this.arrayBufferBody??=p0({try:()=>this.source.arrayBuffer(),catch:a=>new Nx({request:this.request,response:this,reason:"Decode",cause:a})}).pipe(xO,vZ)}}(a,b)=>lz(()=>b(a.status)?ly(a):k5(new Nx({response:a,request:a.request,reason:"StatusCode",description:"invalid status code"})));let NZ=a=>a.status>=200&&a.status<300?ly(a):k5(new Nx({response:a,request:a.request,reason:"StatusCode",description:"non 2xx status code"})),N$=Symbol.for("@effect/platform/HttpClient"),N_=bY("@effect/platform/HttpClient"),N0=ad(Symbol.for("@effect/platform/HttpClient/tracerDisabledWhen"),()=>md($)),N1=ad(Symbol.for("@effect/platform/HttpClient/currentTracerPropagation"),()=>md(!0)),N2=b_()("@effect/platform/HttpClient/SpanNameGenerator",{defaultValue:()=>a=>`http.client ${a.method}`}),N3={[N$]:N$,pipe(){return a7(this,arguments)},...a_,toJSON:()=>({_id:"@effect/platform/HttpClient"}),get(a,b){return this.execute(ND(a,b))},head(a,b){return this.execute(NI(a,b))},post(a,b){return this.execute(NE(a,b))},put(a,b){return this.execute(NF(a,b))},patch(a,b){return this.execute(NG(a,b))},del(a,b){return this.execute(NH(a,b))},options(a,b){return this.execute(NJ(a,b))}},N4=(a,b)=>{let c=Object.create(N3);return c.preprocess=b,c.postprocess=a,c.execute=function(c){return a(b(c))},c},N5=ad("@effect/platform/HttpClient/responseRegistry",()=>{if("FinalizationRegistry"in globalThis&&globalThis.FinalizationRegistry){let a=new FinalizationRegistry(a=>{a.abort()});return{register(b,c){a.register(b,c,b)},unregister(b){a.unregister(b)}}}let a=new Map;return{register(b,c){a.set(b,setTimeout(()=>c.abort(),5e3))},unregister(b){let c=a.get(b);void 0!==c&&(clearTimeout(c),a.delete(b))}}}),N6=ad("@effect/platform/HttpClient/scopedRequests",()=>new WeakMap);class N7{static{q=NX,r=Mp}constructor(a,b){this[q]=NX,this[r]=Mp,this.original=a,this.controller=b}applyInterrupt(a){return lz(()=>(N5.unregister(this.original),lt(a,()=>lA(()=>{this.controller.abort()}))))}get request(){return this.original.request}get status(){return this.original.status}get headers(){return this.original.headers}get cookies(){return this.original.cookies}get remoteAddress(){return this.original.remoteAddress}get formData(){return this.applyInterrupt(this.original.formData)}get text(){return this.applyInterrupt(this.original.text)}get json(){return this.applyInterrupt(this.original.json)}get urlParamsBody(){return this.applyInterrupt(this.original.urlParamsBody)}get arrayBuffer(){return this.applyInterrupt(this.original.arrayBuffer)}get stream(){return K1(()=>(N5.unregister(this.original),Kc(this.original.stream,a=>((a=>{switch(a._tag){case ba:return j8(a.effect_instruction_i0);case be:return!1}})(a)&&this.controller.abort(),lF))))}toJSON(){return this.original.toJSON()}[aY](){return this.original[aY]()}}let{del:N8,execute:N9,get:Oa,head:Ob,options:Oc,patch:Od,post:Oe,put:Of}=new Proxy({},{get:(a,b,c)=>(...a)=>lb(N_,c=>c[b](...a))}),Og=W(2,(a,b)=>N4(c=>b(a.postprocess(c)),a.preprocess)),Oh=W(2,(a,b)=>N4(a.postprocess,c=>lp(a.preprocess(c),b))),Oi=a=>Og(a,lb(NZ)),Oj=a=>Ld(lp(a,a=>a.stream)),Ok=/\+/g,Ol=function(){};Ol.prototype=Object.create(null);let Om=/^https?:\/\/.*?\//,On=/(\/:[^/()]*?)\?(\/?)/;class Oo{constructor(a={}){this.options={ignoreTrailingSlash:!0,ignoreDuplicateSlashes:!0,caseSensitive:!1,maxParamLength:100,...a}}options;routes=[];trees={};on(a,b,c){let d=b.match(On);if(d&&void 0!==d.index){Ov(b.length===d.index+d[0].length,"Optional Parameter needs to be the last parameter of the path");let e=b.replace(On,"$1$2"),f=b.replace(On,"$2");this.on(a,e,c),this.on(a,f,c);return}for(let d of(this.options.ignoreDuplicateSlashes&&(b=Ow(b)),this.options.ignoreTrailingSlash&&(b=Ox(b)),"string"==typeof a?[a]:a))this._on(d,b,c)}all(a,b){this.on(OA,a,b)}_on(a,b,c){void 0===this.trees[a]&&(this.trees[a]=new Os("/"));let d=b;if("*"===d&&0!==this.trees[a].prefix.length){let b=this.trees[a];this.trees[a]=new Os(""),this.trees[a].staticChildren["/"]=b}let e=this.trees[a].prefix.length,f=this.trees[a],g=[];for(let a=0;a<=d.length;a++){if(58===d.charCodeAt(a)&&58===d.charCodeAt(a+1)){a++;continue}let b=58===d.charCodeAt(a)&&58!==d.charCodeAt(a+1),c=42===d.charCodeAt(a);if(b||c||a===d.length&&a!==e){let b=d.slice(e,a);this.options.caseSensitive||(b=b.toLowerCase()),b=(b=b.split("::").join(":")).split("%").join("%25"),f=f.createStaticChild(b)}if(b){let b=!1,c=[],i=a+1;for(let j=i;;j++){let k=d.charCodeAt(j),l=40===k,m=45===k||46===k,n=47===k||j===d.length;if(l||m||n){let k=d.slice(i,j);if(g.push(k),b=b||l||m,l){var h;let a=function(a,b){let c=1;for(;b<a.length;){if("\\"===a[++b]){b++;continue}if(")"===a[b]?c--:"("===a[b]&&c++,!c)return b}throw TypeError('Invalid regexp expression in "'+a+'"')}(d,j),b=d.slice(j,a+1);c.push((94===(h=b).charCodeAt(1)&&(h=h.slice(0,1)+h.slice(2)),36===h.charCodeAt(h.length-2)&&(h=h.slice(0,h.length-2)+h.slice(h.length-1)),h)),j=a+1}else c.push("(.*?)");let o=j;for(;j<d.length;j++){let a=d.charCodeAt(j);if(47===a)break;if(58===a)if(58===d.charCodeAt(j+1))j++;else break}let p=d.slice(o,j);if(p&&(p=(p=p.split("::").join(":")).split("%").join("%25"),c.push(p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),i=j+1,n||47===d.charCodeAt(j)||j===d.length){let g=b?"()"+p:p,h=d.slice(a,j);d=d.slice(0,a+1)+g+d.slice(j),a+=g.length;let i=b?RegExp("^"+c.join("")+"$"):void 0;f=f.createParametricChild(i,p,h),e=a+1;break}}}}else if(c&&(g.push("*"),f=f.createWildcardChild(),e=a+1,a!==d.length-1))throw Error("Wildcard must be the last character in the route")}for(let b of(this.options.caseSensitive||(d=d.toLowerCase()),"*"===d&&(d="/*"),this.routes))if(b.method===a&&b.pattern===d)throw Error(`Method '${a}' already declared for route '${d}'`);let i={method:a,path:b,pattern:d,params:g,handler:c};this.routes.push(i),f.addRoute(i)}has(a,b){let c=this.trees[a];if(void 0===c)return!1;let d=c.getStaticChild(b);return void 0!==d&&d.isLeafNode}find(a,b){let c,d,e,f=this.trees[a];if(void 0===f)return;47!==b.charCodeAt(0)&&(b=b.replace(Om,"/")),this.options.ignoreDuplicateSlashes&&(b=Ow(b));try{b=(c=function(a){let b=!1,c=!1,d="";for(let e=1;e<a.length;e++){let f=a.charCodeAt(e);if(37===f){let d=a.charCodeAt(e+1),f=a.charCodeAt(e+2);void 0===Oy(d,f)?b=!0:(c=!0,50===d&&53===f&&(b=!0,a=a.slice(0,e+1)+"25"+a.slice(e+1),e+=2),e+=2)}else if(63===f||59===f||35===f){d=a.slice(e+1),a=a.slice(0,e);break}}return{path:b?decodeURI(a):a,querystring:d,shouldDecodeParam:c}}(b)).path,d=c.querystring,e=c.shouldDecodeParam}catch(a){return}this.options.ignoreTrailingSlash&&(b=Ox(b));let g=b;!1===this.options.caseSensitive&&(b=b.toLowerCase());let h=this.options.maxParamLength,i=f.prefix.length,j=[],k=b.length,l=[];for(;;){if(i===k&&f.isLeafNode){let a=f.handlerStorage?.find();if(void 0!==a)return{handler:a.handler,params:a.createParams(j),searchParams:function(a){let b=new Ol;if("string"!=typeof a)return b;let c=a.length,d="",e="",f=-1,g=-1,h=!1,i=!1,j=!1,k=!1,l=!1,m=0;for(let n=0;n<c+1;n++)if(38===(m=n!==c?a.charCodeAt(n):38)){if((l=g>f)||(g=n),d=a.slice(f+1,g),l||d.length>0){if(j&&(d=d.replace(Ok," ")),h)try{d=decodeURIComponent(d)||d}catch{}if(l&&(e=a.slice(g+1,n),k&&(e=e.replace(Ok," ")),i))try{e=decodeURIComponent(e)||e}catch{}let c=b[d];void 0===c?b[d]=e:c.pop?c.push(e):b[d]=[c,e]}e="",f=n,g=n,h=!1,i=!1,j=!1,k=!1}else 61===m?g<=f?g=n:i=!0:43===m?g>f?k=!0:j=!0:37===m&&(g>f?i=!0:h=!0);return b}(d)}}let a=f.getNextNode(b,i,l,j.length);if(void 0===a){if(0===l.length)return;let b=l.pop();i=b.brotherPathIndex,j.splice(b.paramsCount),a=b.brotherNode}if("StaticNode"===(f=a)._tag){i+=f.prefix.length;continue}if("WildcardNode"===f._tag){let a=g.slice(i);e&&(a=Oz(a)),j.push(a),i=k;continue}if("ParametricNode"===f._tag){let a=g.indexOf("/",i);-1===a&&(a=k);let b=g.slice(i,a);if(e&&(b=Oz(b)),void 0!==f.regex){let a=f.regex.exec(b);if(null===a)continue;for(let b=1;b<a.length;b++){let c=a[b];if(c.length>h)return;j.push(c)}}else{if(b.length>h)return;j.push(b)}i=a}}}}class Op{handlers=[];unconstrainedHandler;find(){return this.unconstrainedHandler}add(a){let b={params:a.params,handler:a.handler,createParams:function(a){let b=a.length;return function(c){let d={};for(let e=0;e<b;e++)d[a[e]]=c[e];return d}}(a.params)};this.handlers.push(b),this.unconstrainedHandler=this.handlers[0]}}class Oq{isLeafNode=!1;routes;handlerStorage;addRoute(a){void 0===this.routes?this.routes=[a]:this.routes.push(a),void 0===this.handlerStorage&&(this.handlerStorage=new Op),this.isLeafNode=!0,this.handlerStorage.add(a)}}class Or extends Oq{staticChildren={};findStaticMatchingChild(a,b){let c=this.staticChildren[a.charAt(b)];if(void 0!==c&&c.matchPrefix(a,b))return c}getStaticChild(a,b=0){if(a.length===b)return this;let c=this.findStaticMatchingChild(a,b);if(void 0!==c)return c.getStaticChild(a,b+c.prefix.length)}createStaticChild(a){if(0===a.length)return this;let b=this.staticChildren[a.charAt(0)];if(b){let c=1;for(;c<b.prefix.length;c++)if(a.charCodeAt(c)!==b.prefix.charCodeAt(c)){b=b.split(this,c);break}return b.createStaticChild(a.slice(c))}let c=a.charAt(0);return this.staticChildren[c]=new Os(a),this.staticChildren[c]}}class Os extends Or{_tag="StaticNode";constructor(a){super(),this.setPrefix(a)}prefix;matchPrefix;parametricChildren=[];wildcardChild;setPrefix(a){if(this.prefix=a,1===a.length)this.matchPrefix=(a,b)=>!0;else{let b=a.length;this.matchPrefix=function(a,c){for(let d=1;d<b;d++)if(a.charCodeAt(c+d)!==this.prefix.charCodeAt(d))return!1;return!0}}}getParametricChild(a){if(void 0===a)return this.parametricChildren.find(a=>!1===a.isRegex);let b=a.source;return this.parametricChildren.find(a=>void 0!==a.regex&&a.regex.source===b)}createParametricChild(a,b,c){let d=this.getParametricChild(a);return void 0!==d?d.nodePaths.add(c):(d=new Ot(a,b,c),this.parametricChildren.push(d),this.parametricChildren.sort((a,b)=>a.isRegex?b.isRegex?void 0===a.staticSuffix?1:void 0===b.staticSuffix?-1:b.staticSuffix.endsWith(a.staticSuffix)?1:a.staticSuffix.endsWith(b.staticSuffix)?-1:0:-1:1)),d}createWildcardChild(){return void 0===this.wildcardChild&&(this.wildcardChild=new Ou),this.wildcardChild}split(a,b){let c=this.prefix.slice(0,b),d=this.prefix.slice(b);this.setPrefix(d);let e=new Os(c);return e.staticChildren[d.charAt(0)]=this,a.staticChildren[c.charAt(0)]=e,e}getNextNode(a,b,c,d){let e=this.findStaticMatchingChild(a,b),f=0;if(void 0===e){if(0===this.parametricChildren.length)return this.wildcardChild;e=this.parametricChildren[0],f=1}void 0!==this.wildcardChild&&c.push({paramsCount:d,brotherPathIndex:b,brotherNode:this.wildcardChild});for(let a=this.parametricChildren.length-1;a>=f;a--)c.push({paramsCount:d,brotherPathIndex:b,brotherNode:this.parametricChildren[a]});return e}}class Ot extends Or{regex;staticSuffix;_tag="ParametricNode";constructor(a,b,c){super(),this.regex=a,this.staticSuffix=b,this.isRegex=!!a,this.nodePaths=new Set([c])}isRegex;nodePaths;getNextNode(a,b){return this.findStaticMatchingChild(a,b)}}class Ou extends Oq{_tag="WildcardNode";getNextNode(a,b,c,d){}}let Ov=(a,b)=>{if(!a)throw Error(b)};function Ow(a){return a.replace(/\/\/+/g,"/")}function Ox(a){return a.length>1&&47===a.charCodeAt(a.length-1)?a.slice(0,-1):a}function Oy(a,b){return 50===a?53===b?"%":51===b?"#":52===b?"$":54===b?"&":66===b||98===b?"+":67===b||99===b?",":70===b||102===b?"/":void 0:51===a?65===b||97===b?":":66===b||98===b?";":68===b||100===b?"=":70===b||102===b?"?":void 0:52===a&&48===b?"@":void 0}function Oz(a){let b=a.indexOf("%");if(-1===b)return a;let c="",d=b;for(let e=b;e<a.length;e++)if(37===a.charCodeAt(e)){let b=Oy(a.charCodeAt(e+1),a.charCodeAt(e+2));c+=a.slice(d,e)+b,d=e+3}return a.slice(0,b)+c+a.slice(d)}let OA=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"],OB=Symbol.for("@effect/platform/Etag/Generator"),OC=bY("@effect/platform/Etag/Generator");lb(bY("@effect/platform/HttpServer"),a=>(a=>lb(N_,b=>{if("UnixAddress"===a._tag)return k1(Error("HttpServer.layerTestClient: UnixAddress not supported"));let c="0.0.0.0"===a.hostname?"127.0.0.1":a.hostname;return ly(Oh(b,NR(`http://${c}:${a.port}`)))}))(a.address));let OD=Symbol.for("@effect/platform/HttpRouter"),OE=Symbol.for("@effect/platform/HttpRouter/Route"),OF=Symbol.for("@effect/platform/HttpRouter/RouteContext"),OG=bY("@effect/platform/HttpRouter/RouteContext"),OH=ad("@effect/platform/HttpRouter/currentRouterConfig",()=>md({}));class OI extends b3{constructor(a,b){super(),this.routes=a,this.mounts=b,this[OD]=OD,this.httpApp=l2(OH).pipe(lb(a=>this.httpApp=OJ(this,a)))}commit(){return this.httpApp}toJSON(){return{_id:"Router",routes:this.routes.toJSON(),mounts:this.mounts.toJSON()}}toString(){return a$(this)}[aY](){return this.toJSON()}}let OJ=(a,b)=>{let c=((a={})=>new Oo(a))(b),d=f$(a.mounts).map(([a,b,c])=>[a,new OM(new OL("*",c?.includePrefix?`${a}/*`:"/*",b,c?.includePrefix?ej():bG(a),!1),{}),c]),e=d.length;return gd(a.routes,a=>{"*"===a.method?c.all(a.path,a):c.on(a.method,a.path,a)}),kQ(a=>{let b=bO(new Map(a.getFiberRef(mg).unsafeMap)),f=bV(b,Ni);if(e>0)for(let a=0;a<e;a++){let[c,e,g]=d[a];if(f.url.startsWith(c))return b.unsafeMap.set(OG.key,e),g?.includePrefix!==!0&&b.unsafeMap.set(Ni.key,OK(f,c)),mb(lb(e.route.handler,Mf),mg,b)}let g=c.find(f.method,f.url);if(void 0===g&&"HEAD"===f.method&&(g=c.find("GET",f.url)),void 0===g)return k5(new Mn({request:f}));let h=g.handler;"Some"===h.prefix._tag&&b.unsafeMap.set(Ni.key,OK(f,h.prefix.value)),b.unsafeMap.set(Nj.key,g.searchParams),b.unsafeMap.set(OG.key,new OM(h,g.params));let i=bW(b,or);"Some"===i._tag&&"Span"===i.value._tag&&i.value.attribute("http.route",h.path);let j=lb(h.handler,Mf);return mb(h.uninterruptible?j:ln(j),mg,b)})};function OK(a,b){let c=b.length;return a.modify({url:a.url.length<=c?"/":a.url.slice(c)})}class OL extends a0{constructor(a,b,c,d=ej(),e=!1){super(),this.method=a,this.path=b,this.handler=c,this.prefix=d,this.uninterruptible=e,this[OE]=OE}toJSON(){return{_id:"@effect/platform/HttpRouter/Route",method:this.method,path:this.path,prefix:this.prefix.toJSON()}}}class OM{constructor(a,b){this.route=a,this.params=b,this[OF]=OF}}let ON=new OI(fV(),fV()),OO=((a,b)=>OO(a,b),(...a)=>new OI(a.reduce((a,b)=>f9(a,b.routes),fV()),a.reduce((a,b)=>f9(a,b.mounts),fV()))),OP=((a,b)=>(b=(a=>a.endsWith("/")?a.slice(0,-1):a)(b),new OI(gk(a.routes,a=>new OL(a.method,"/"===a.path?b:b+a.path,a.handler,em(et(a.prefix,a=>b+a),()=>bG(b)),a.uninterruptible)),gk(a.mounts,([a,c])=>["/"===a?b:b+a,c]))),a=>W(a=>ap(a[0],OD),(b,c,d,e)=>new OI(f4(b.routes,new OL(a,c,d,ej(),e?.uninterruptible??!1)),b.mounts))),OQ=OP("GET"),OR=OP("POST"),OS=W(2,(a,b)=>new OI(gk(a.routes,a=>new OL(a.method,a.path,b(lb(a.handler,Mf)),a.prefix,a.uninterruptible)),gk(a.mounts,([a,c])=>[a,b(c)]))),OT=((a,b)=>new OI(gk(a.routes,a=>new OL(a.method,a.path,b(a.handler),a.prefix,a.uninterruptible)),gk(a.mounts,([a,c])=>[a,lb(b(c),Mf)])),Symbol.for("@effect/matcher/Matcher")),OU={[OT]:{_input:X,_filters:X,_remaining:X,_result:X,_return:X},_tag:"TypeMatcher",add(a){return function(a){let b=Object.create(OU);return b.cases=a,b}([...this.cases,a])},pipe(){return a7(this,arguments)}},OV={[OT]:{_input:X,_filters:X,_remaining:X,_result:X,_provided:X,_return:X},_tag:"ValueMatcher",add(a){return"Right"===this.value._tag?this:"When"===a._tag&&!0===a.guard(this.provided)||"Not"===a._tag&&!1===a.guard(this.provided)?OW(this.provided,dt(a.evaluate(this.provided))):this},pipe(){return a7(this,arguments)}};function OW(a,b){let c=Object.create(OV);return c.provided=a,c.value=b,c}let OX=(a,b)=>({_tag:"When",guard:a,evaluate:b}),OY=a=>{if("function"==typeof a)return a;if(Array.isArray(a)){let b=a.map(OY),c=b.length;return a=>{if(!Array.isArray(a))return!1;for(let d=0;d<c;d++)if(!1===b[d](a[d]))return!1;return!0}}if(null!==a&&"object"==typeof a){let b=Object.entries(a).map(([a,b])=>[a,OY(b)]),c=b.length;return a=>{if("object"!=typeof a||null===a)return!1;for(let d=0;d<c;d++){let[c,e]=b[d];if(!(c in a)||!1===e(a[c]))return!1}return!0}}return b=>b===a},OZ=a=>{if("ValueMatcher"===a._tag)return a.value;let b=a.cases.length;if(1===b){let b=a.cases[0];return a=>"When"===b._tag&&!0===b.guard(a)||"Not"===b._tag&&!1===b.guard(a)?dt(b.evaluate(a)):ds(a)}return c=>{for(let d=0;d<b;d++){let b=a.cases[d];if("When"===b._tag&&!0===b.guard(c)||"Not"===b._tag&&!1===b.guard(c))return dt(b.evaluate(c))}return ds(c)}},O$=(a,b)=>c=>c.add(OX(OY(a),b)),O_=W(2,(a,b)=>a.log({fiberId:io,logLevel:lX,message:b,cause:j0,context:oW(),spans:iM(),annotations:hy,date:new Date})),O0=rX,O1=rZ,O2=Ec,O3=Ed,O4=Ee,O5=r$,O6=r_,O7=r0,O8=r1,O9=um,Pa=ue,Pb=a=>rZ(b=>{let c=bV(o2(b.context,oy),oi).unsafe;switch(b.logLevel._tag){case"Debug":return c.debug(a.log(b));case"Info":return c.info(a.log(b));case"Trace":return c.trace(a.log(b));case"Warning":return c.warn(a.log(b));case"Error":case"Fatal":return c.error(a.log(b));default:return c.log(a.log(b))}}),Pc=a=>rZ(b=>{bV(o2(b.context,oy),oi).unsafe.error(a.log(b))}),Pd={[rX]:rY,log:_,pipe(){return a7(this,arguments)}},Pe=Ef,Pf=Eg,Pg=Eh,Ph=Ei,Pi=r2,Pj=a=>r2(()=>a),Pk=a=>r2(a),Pl=O_,Pm=Eb,Pn=a=>r_(a,a=>{let b=eu(o1(a.context,mg),bW(or));return"None"===b._tag?a:{...a,annotations:aa(a.annotations,hD("effect.traceId",b.value.traceId),hD("effect.spanId",b.value.spanId),"Span"===b.value._tag?hD("effect.spanName",b.value.name):X)}}),Po=r3,Pp=r4,Pq=r5,Pr=uf,Ps=sc,Pt=r9,Pu=r8,Pv=sm,Pw=sp,Px=sa,Py=uk,Pz=Pf(uf,ug),PA=Pf(uf,uh),PB=Pf(uf,ui),PC=Pf(uf,uj),PD=a=>wm(uQ(ud,a)),PE=a=>"object"==typeof a&&null!=a&&rX in a,PF="@effect/platform/FetchHttpClient/Fetch",PG=(a=>N4(b=>lb(b,b=>kQ(c=>{let d=N6.get(b),e=d??new AbortController,f=((a,b,c)=>{try{let d=new URL(a,(()=>{if("location"in globalThis&&void 0!==globalThis.location&&void 0!==globalThis.location.origin&&void 0!==globalThis.location.pathname)return location.origin+location.pathname})());for(let a=0;a<b.length;a++){let[c,e]=b[a];void 0!==e&&d.searchParams.append(c,e)}return"Some"===c._tag&&(d.hash=c.value),dt(d)}catch(a){return ds(a)}})(b.url,b.urlParams,b.hash);if("Left"===f._tag)return k5(new Nw({request:b,reason:"InvalidUrl",cause:f.left}));let g=f.right;if(!c.getFiberRef(mt)||c.getFiberRef(N0)(b)){let f=a(b,g,e.signal,c);return d?f:lE(a=>lg(a(f),{onSuccess:a=>(N5.register(a,e),ly(new N7(a,e))),onFailure:a=>(j8(a)&&e.abort(),k7(a))}))}return p6(bV(c.currentContext,N2)(b),{kind:"client",captureStackTrace:!1},f=>{f.attribute("http.request.method",b.method),f.attribute("server.address",g.origin),""!==g.port&&f.attribute("server.port",+g.port),f.attribute("url.full",g.toString()),f.attribute("url.path",g.pathname),f.attribute("url.scheme",g.protocol.slice(0,-1));let h=g.search.slice(1);""!==h&&f.attribute("url.query",h);let i=c.getFiberRef(LR),j=LQ(b.headers,i);for(let a in j)f.attribute(`http.request.header.${a}`,String(j[a]));return b=c.getFiberRef(N1)?NM(b,(a=>Object.setPrototypeOf({b3:`${a.traceId}-${a.spanId}-${a.sampled?"1":"0"}${"Some"===a.parent._tag?`-${a.parent.value.spanId}`:""}`,traceparent:`00-${a.traceId}-${a.spanId}-${a.sampled?"01":"00"}`},LI))(f)):b,lE(h=>h(a(b,g,e.signal,c)).pipe(p7(f),lg({onSuccess:a=>{f.attribute("http.response.status_code",a.status);let b=LQ(a.headers,i);for(let a in b)f.attribute(`http.response.header.${a}`,String(b[a]));return d?ly(a):(N5.register(a,e),ly(new N7(a,e)))},onFailure:a=>(!d&&j8(a)&&e.abort(),k7(a))})))})})),ly))((a,b,c,d)=>{let e=d.getFiberRef(mg),f=e.unsafeMap.get(PF)??globalThis.fetch,g=e.unsafeMap.get("@effect/platform/FetchHttpClient/FetchOptions")??{},h=g.headers?LO(LL(g.headers),a.headers):a.headers,i=d=>lp(p0({try:()=>f(b,{...g,method:a.method,headers:h,body:d,duplex:"Stream"===a.body._tag?"half":void 0,signal:c}),catch:b=>new Nw({request:a,reason:"Transport",cause:b})}),b=>new NY(a,b));switch(a.body._tag){case"Raw":case"Uint8Array":return i(a.body.body);case"FormData":return i(a.body.formData);case"Stream":return lb(La(a.body.stream),i)}return i(void 0)}),PH=(y=ly(PG),wf(N_,lb(nn,a=>lp(y,b=>Og(b,nr(b=>bX(a,b)))))));class PI extends b$(PF)(){}function PJ(a,b){return lb(a.runtimeEffect,a=>kQ(c=>(c.setFiberRefs(a.fiberRefs),c.currentRuntimeFlags=a.runtimeFlags,np(b,a.context))))}let PK={...bt,[vC]:vC,pipe(){return a7(this,arguments)},commit(){return this.runtimeEffect}},PL=n_().pipe(n6(()=>n0(new Map(Object.entries(Object.fromEntries(Object.entries({}).filter(a=>null!=a[1])))),{pathDelim:"_"})),n5("uploadthing"),a=>n3(a,nU)),PM=(a=>{let b=oL("a boolean property",a=>{switch(a){case"true":case"yes":case"on":case"1":return dt(!0);case"false":case"no":case"off":case"0":return dt(!1);default:return ds(gB([],`Expected a boolean value but received ${a}`))}});return void 0===a?b:oI(b,a)})("isDev").pipe(oJ(()=>oN("undefined"!=typeof process?"production":void 0).pipe(oF(a=>"development"===a))),oP(!1)),PN=((a,b)=>{let c,d=AH(b.ast,!0,c);return oM(a).pipe(oH(a=>d(a).pipe(dw(a=>gB([],A_.formatIssueSync(a))))))})("token",Dr).pipe(pC({ConfigError:a=>new ed({code:"InvalidData"===a._op?"INVALID_SERVER_CONFIG":"MISSING_ENV",message:"InvalidData"===a._op?"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.":"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.",cause:a})}));oM("apiUrl").pipe(oP("https://api.uploadthing.com"),oG(a=>new URL(a)),oF(a=>a.href.replace(/\/$/,"")));let PO=xW(function*(a){let{regions:b,ingestHost:c}=yield*PN,d=a?b.find(b=>b===a)??b[0]:b[0];return yield*oM("ingestUrl").pipe(oP(`https://${d}.${c}`),oG(a=>new URL(a)),oF(a=>a.href.replace(/\/$/,"")))});function PP(a){return{message:a.message}}function PQ(a,b){let c=Object.keys(b)[0];return(c?b[c]?.errorFormatter??PP:PP)(a)}oM("utfsHost").pipe(oP("utfs.io")),oM("ufsHost").pipe(oP("ufs.sh")),oQ("subdomain","path")("ufsAppIdLocation").pipe(oP("subdomain"));let PR=(a=>{let b=oH(oM(),a=>{let b=l_.find(b=>b._tag===a);return void 0===b?ds(gB([],`Expected a log level but received ${a}`)):dt(b)});return void 0===a?b:oI(b,a)})("logLevel").pipe(oP(lX),lc(a=>PD(a)),p$(a=>pP("Invalid log level").pipe(px("error",a))),pB("ConfigError",a=>new ed({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:a})),wv),PS=oQ("json","logFmt","structured","pretty")("logFormat"),PT=xP(function*(){let a=yield*PM;return C[yield*PS.pipe(oP(a?"pretty":"json"))]}).pipe(pB("ConfigError",a=>new ed({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:a})),wv),PU=(a,b)=>{let c=b?.mixin??"json",d=o7(b?.level??"Debug");return b=>lb("None"!==c?b[c]:lF,()=>((a,...b)=>pK(a)(...b))(d,`${a} (${b.status})`).pipe(px("response",b)))},PV=a=>b=>"ResponseError"===b._tag?PU(a,{level:"Error"})(b.response):pP(a).pipe(px("error",b));var PW=class extends oS("ParserError"){message="Input validation failed. The original error with it's validation issues is in the error cause."},PX=class extends oR{_tag="FileSizeMismatch";name="FileSizeMismatchError";constructor(a,b,c){super({reason:`You uploaded a ${a} file that was ${(a=>{if(0===a||-1===a)return"0B";let b=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,b)).toFixed(2)}${d8[b]}`})(c)}, but the limit for that type is ${b}`})}},PY=class extends oR{_tag="FileCountMismatch";name="FileCountMismatchError";constructor(a,b,c,d){super({reason:`You uploaded ${d} file(s) of type '${a}', but the ${b} for that type is ${c}`})}};let PZ=Symbol("uploadthing-region-symbol"),P$=Symbol("uploadthing-custom-id-symbol");var P_=class extends b$("uploadthing/AdapterArguments")(){};let P0=a=>xP(function*(){let{uploadable:b}=a,c=yield*Ni,{apiKey:d}=yield*PN,e=yield*eh((yield*c.text),c.headers["x-uploadthing-signature"]??null,d);if(yield*pM(`Signature verified: ${e}`),!e)return yield*pP("Invalid signature"),yield*new ed({code:"BAD_REQUEST",message:"Invalid signature"});let f=yield*Nl(B5({fileKey:BA,error:BA}));yield*pM("Handling error callback request with input:").pipe(px("json",f));let g=yield*P_;return{body:null,fiber:yield*p0({try:async()=>b.onUploadError({...g,error:new ed({code:"UPLOAD_FAILED",message:`Upload failed for ${f.fileKey}: ${f.error}`}),fileKey:f.fileKey}),catch:a=>new ed({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadError",cause:a})}).pipe(p$(a=>pP("Failed to run onUploadError. You probably shouldn't be throwing errors here.").pipe(px("error",a)))).pipe(xR,uu)}}).pipe(pQ("handleErrorRequest")),P1=a=>xP(function*(){let b,{uploadable:c,fePackage:d,beAdapter:e}=a,f=yield*Ni,{apiKey:g}=yield*PN,h=yield*eh((yield*f.text),f.headers["x-uploadthing-signature"]??null,g);if(yield*pM(`Signature verified: ${h}`),!h)return yield*pP("Invalid signature"),yield*new ed({code:"BAD_REQUEST",message:"Invalid signature"});let i=yield*Nl(B5({status:BA,file:Du,origin:BA,metadata:function a(b,c,d){return class extends B4({},[{key:b,value:c}],d){static annotations(d){return a(b,c,Bl(this.ast,d))}static{this.key=b}static{this.value=c}}}((b={key:BA,value:Bx}).key,b.value)}));return yield*pM("Handling callback request with input:").pipe(px("json",i)),{body:null,fiber:yield*xP(function*(){let a=yield*P_,b=yield*p0({try:async()=>c.onUploadComplete({...a,file:{...i.file,get url(){return V("`file.url` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),i.file.url},get appUrl(){return V("`file.appUrl` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),i.file.appUrl}},metadata:i.metadata}),catch:a=>new ed({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.",cause:a})}),f={fileKey:i.file.key,callbackData:b??null};yield*pM("'onUploadComplete' callback finished. Sending response to UploadThing:").pipe(px("callbackData",f));let h=(yield*N_).pipe(Oi);yield*NE("/callback-result").pipe(NR(i.origin),NM({"x-uploadthing-api-key":dZ(g),"x-uploadthing-version":U,"x-uploadthing-be-adapter":e,"x-uploadthing-fe-package":d}),NW(f),lb(h.execute),p$(PV("Failed to register callback result")),lb(Mq(Dx)),lB(pL("Sent callback result to UploadThing")),xS)}).pipe(xR,uu)}}).pipe(pQ("handleCallbackRequest")),P2=a=>xP(function*(){let b,c,d=(yield*N_).pipe(Oi),{uploadable:e,fePackage:f,beAdapter:g,slug:h}=a,i=yield*Nl(Dy);yield*pM("Handling upload request").pipe(px("json",i)),yield*pM("Parsing user input");let j=yield*p0({try:()=>(function(a){if("parseAsync"in a&&"function"==typeof a.parseAsync)return a.parseAsync;if(Bo(a))return b=>((a,b)=>{let c=Bn(a,b);return(a,b)=>vX(c(a,b))})(a)(b).catch(a=>{throw new PW({cause:oU(a[vL])})});if("~standard"in a)return async b=>{let c=await a["~standard"].validate(b);if(c.issues)throw new PW({cause:c.issues});return c.value};throw Error("Invalid parser")})(e.inputParser)(i.input),catch:a=>new ed({code:"BAD_REQUEST",message:"Invalid input",cause:a})});yield*pM("Input parsed successfully").pipe(px("input",j));let{metadata:k,filesWithCustomIds:l,preferredRegion:m}=yield*(b={json:{input:j,files:i.files},uploadable:e},xP(function*(){let{json:{files:a,input:c},uploadable:d}=b;yield*pM("Running middleware");let e=yield*P_,f=yield*p0({try:async()=>d.middleware({...e,input:c,files:a}),catch:a=>a instanceof ed?a:new ed({code:"INTERNAL_SERVER_ERROR",message:"Failed to run middleware",cause:a})});if(f[P$]&&f[P$].length!==a.length){let b=`Expected files override to have the same length as original files, got ${f[P$].length} but expected ${a.length}`;return yield*pP(b),yield*new ed({code:"BAD_REQUEST",message:"Files override must have the same length as files",cause:b})}let g=yield*uq(a,(a,b)=>xP(function*(){let c=f[P$]?.[b];return c&&c.size!==a.size&&(yield*pO("File size mismatch. Reverting to original size")),{name:c?.name??a.name,size:a.size,type:a.type,customId:c?.customId,lastModified:c?.lastModified??Date.now()}}));return{metadata:f,filesWithCustomIds:g,preferredRegion:f[PZ]}}).pipe(pQ("runRouteMiddleware")));yield*pM("Parsing route config").pipe(px("routerConfig",e.routerConfig));let n=yield*d6(e.routerConfig).pipe(pB("InvalidRouteConfig",a=>new ed({code:"BAD_REQUEST",message:"Invalid route config",cause:a})));yield*pM("Route config parsed successfully").pipe(px("routeConfig",n)),yield*pM("Validating files meet the config requirements").pipe(px("files",i.files)),yield*(c=i.files,xP(function*(){let a={};for(let b of c){let c=yield*d7(b,ea(n));a[c]=(a[c]??0)+1;let d=n[c]?.maxFileSize;if(!d)return yield*new d1(c,"maxFileSize");let e=yield*d9(d);if(b.size>e)return yield*new PX(c,d,b.size)}for(let b in a){let c=n[b];if(!c)return yield*new d1(b);let d=a[b],e=c.minFileCount,f=c.maxFileCount;if(e>f)return yield*new ed({code:"BAD_REQUEST",message:"Invalid config during file count - minFileCount > maxFileCount",cause:`minFileCount must be less than maxFileCount for key ${b}. got: ${e} > ${f}`});if(null!=d&&d<e)return yield*new PY(b,"minimum",e,d);if(null!=d&&d>f)return yield*new PY(b,"maximum",f,d)}return null})).pipe(lr(a=>new ed({code:"BAD_REQUEST",message:`Invalid config: ${a._tag}`,cause:"reason"in a?a.reason:a.message}))),yield*pM("Files validated.");let o=yield*uq(l,a=>lp(d7(a,ea(n)),b=>({name:a.name,size:a.size,type:a.type||b,lastModified:a.lastModified,customId:a.customId,contentDisposition:n[b]?.contentDisposition??"inline",acl:n[b]?.acl}))).pipe(pC({InvalidFileType:a=>k1(a),UnknownFileType:a=>k1(a)})),p=e.routeOptions,{apiKey:q,appId:r}=yield*PN,s=yield*PO(m),t=yield*PM;yield*pM("Generating presigned URLs").pipe(px("fileUploadRequests",o),px("ingestUrl",s));let u=yield*uq(o,a=>xP(function*(){let b,c,d,e=yield*(b=p.getFileHashParts,cB(()=>{let c=JSON.stringify(b?.(a)??[a.name,a.size,a.type,a.lastModified,Date.now()]),d=function(a,b){let c,d,e=a.split(""),f=aQ(b);for(let a=0;a<e.length;a++)d=(f%(a+1)+a)%e.length,c=e[a],e[a]=e[d],e[d]=c;return e.join("")}(d_.alphabet,r),e=new d0({alphabet:d,minLength:36}).encode([Math.abs(aQ(c))]);return new d0({alphabet:d,minLength:12}).encode([Math.abs(aQ(r))])+e}).pipe(c4("generateKey")));return{url:yield*(c=`${s}/${e}`,d={ttlInSeconds:p.presignedURLTTL,data:{"x-ut-identifier":r,"x-ut-file-name":a.name,"x-ut-file-size":a.size,"x-ut-file-type":a.type,"x-ut-slug":h,"x-ut-custom-id":a.customId,"x-ut-content-disposition":a.contentDisposition,"x-ut-acl":a.acl}},cK(function*(){let a,b=new URL(c),e=d.ttlInSeconds?function(a){if("number"==typeof a)return a;let b=a.split(/(\d+)/).filter(Boolean);return Number(b[0])*({s:1,m:60,h:3600,d:86400})[(b[1]??"s").trim().slice(0,1)]}(d.ttlInSeconds):3600,f=Date.now()+1e3*e;b.searchParams.append("expires",f.toString()),d.data&&Object.entries(d.data).forEach(([a,c])=>{if(null==c)return;let d=encodeURIComponent(c);b.searchParams.append(a,d)});let g=yield*(a=b.toString(),cK(function*(){let b=yield*cG({try:()=>crypto.subtle.importKey("raw",eg.encode(dZ(q)),ef,!1,["sign"]),catch:a=>new ed({code:"BAD_REQUEST",message:"Invalid signing secret",cause:a})}),c=yield*cO(cG({try:()=>crypto.subtle.sign(ef,b,eg.encode(a)),catch:a=>new ed({code:"BAD_REQUEST",cause:a})}),a=>{let b;return"string"==typeof(b=new Uint8Array(a))?dL(dF.encode(b)):dL(b)});return`${ee}${c}`}).pipe(c4("signPayload")));return b.searchParams.append("signature",g),b.href}).pipe(c4("generateSignedURL"))),key:e}}),{concurrency:"unbounded"}),v=yield*Ni,w=yield*Nm(v),x=yield*oM("callbackUrl").pipe(oP(w.origin+w.pathname),lp(a=>NE(a).pipe(NS("slug",h)))),y=NE("/route-metadata").pipe(NR(s),NM({"x-uploadthing-api-key":dZ(q),"x-uploadthing-version":U,"x-uploadthing-be-adapter":g,"x-uploadthing-fe-package":f}),NW({fileKeys:u.map(({key:a})=>a),metadata:k,isDev:t,callbackUrl:x.url,callbackSlug:h,awaitServerData:p.awaitServerData??!0}),lb(d.execute)),z=xW("handleDevStreamError")(function*(a,b){let c=CB(B5({file:Du})),e=(yield*Bn(c)(b)).file.key;yield*pP("Failed to forward callback request from dev stream").pipe(px({fileKey:e,error:a.message}));let h=yield*NE("/callback-result").pipe(NR(s),NM({"x-uploadthing-api-key":dZ(q),"x-uploadthing-version":U,"x-uploadthing-be-adapter":g,"x-uploadthing-fe-package":f}),NW({fileKey:e,error:`Failed to forward callback request from dev stream: ${a.message}`}),lb(d.execute));yield*PU("Reported callback error to UploadThing")(h)}),A=yield*lk(t,{onTrue:()=>{let a;return y.pipe(pZ({onSuccess:PU("Registered metadata",{mixin:"None"}),onFailure:PV("Failed to register metadata")}),Oj,(a=a=>x.pipe(NM({"uploadthing-hook":a.hook,"x-uploadthing-signature":a.signature}),NV(L2(a.payload,"application/json")),d.execute,lB(PU("Successfully forwarded callback request from dev stream")),pB("ResponseError",b=>z(b,a.payload)),px(a),kT,xR,xS),b=>{let c="";return b.pipe(Li(),Lm(a=>xP(function*(){let b=(c+=a).split("\n"),d=[];for(let a of b)try{d.push(JSON.parse(a)),c=c.slice(a.length+1)}catch{}return yield*pM("Received chunks").pipe(px("chunk",a),px("parsedChunks",d),px("buf",c)),d})),Lm(Bn(BL(Dv))),Lm(uq(b=>a(b))),Lr,pQ("handleJsonLineStream"))}))},onFalse:()=>y.pipe(pZ({onSuccess:PU("Registered metadata"),onFailure:PV("Failed to register metadata")}),lb(Mq(Dw)),xS)}).pipe(uu),B=u.map((a,b)=>({url:a.url,key:a.key,name:o[b].name,customId:o[b].customId??null}));return yield*pN("Sending presigned URLs to client").pipe(px("presignedUrls",B)),{body:B,fiber:A}}).pipe(pQ("handleUploadAction"));var P3=c(66169);let P4=(a=>(b,c)=>(function a(b={}){let c={$types:{},routerConfig:{image:{maxFileSize:"4MB"}},routeOptions:{awaitServerData:!0},inputParser:{parseAsync:()=>Promise.resolve(void 0),_input:void 0,_output:void 0},middleware:()=>({}),onUploadError:()=>{},onUploadComplete:()=>void 0,errorFormatter:b.errorFormatter??PP,...b};return{input:b=>a({...c,inputParser:b}),middleware:b=>a({...c,middleware:b}),onUploadComplete:a=>({...c,onUploadComplete:a}),onUploadError:b=>a({...c,onUploadError:b})}})({routerConfig:b,routeOptions:c??{},...a}))(),{GET:P5,POST:P6}=(a=>{let b=((a,b,c,d)=>{let e=((a,b)=>((a,b)=>{let c;b=b??v6();let d=vZ(uN()),e=kQ(e=>(c||(c=vW(lB(uO(wr(a,b),d),a=>{f.cachedRuntime=a}),{scope:d,scheduler:e.currentScheduler})),le(c.await))),f=Object.assign(Object.create(PK),{memoMap:b,scope:d,runtimeEffect:e,cachedRuntime:void 0,runtime:()=>void 0===f.cachedRuntime?vX(f.runtimeEffect):Promise.resolve(f.cachedRuntime),dispose:()=>vX(f.disposeEffect),disposeEffect:lz(()=>(f.runtimeEffect=k1("ManagedRuntime disposed"),f.cachedRuntime=void 0,mB(f.scope,m7))),runFork:(a,b)=>void 0===f.cachedRuntime?vW(PJ(f,a),b):vG(f.cachedRuntime)(a,b),runSyncExit:a=>void 0===f.cachedRuntime?v$(PJ(f,a)):vP(f.cachedRuntime)(a),runSync:a=>void 0===f.cachedRuntime?vZ(PJ(f,a)):vI(f.cachedRuntime)(a),runPromiseExit:(a,b)=>void 0===f.cachedRuntime?vY(PJ(f,a),b):vR(f.cachedRuntime)(a,b),runCallback:(a,b)=>void 0===f.cachedRuntime?vH(vV)(PJ(f,a),b):vH(f.cachedRuntime)(a,b),runPromise:(a,b)=>void 0===f.cachedRuntime?vX(PJ(f,a),b):vQ(f.cachedRuntime)(a,b)});return f})(ws(wk(PT,PR,wt(PH,wo(PI,a)),wg(lp(l6(LR,a=>a.concat(["x-uploadthing-api-key"])),()=>bQ))),wm(uR(oy,bS(nX,n0(new Map(ff((a=>{let b=(a,b)=>"string"==typeof b?eL([a,b]):"number"==typeof b||"boolean"==typeof b?eL([a,String(b)]):eV(b)?c(a,b):"object"==typeof b&&null!==b?d(a,b):fd(),c=(a,c)=>eQ(c,{onEmpty:()=>eL([a,"<nil>"]),onNonEmpty:fg((c,d)=>b(eT(a,{_tag:"KeyIndex",index:d}),c))}),d=(a,c)=>Object.entries(c).filter(([,a])=>ar(a)).flatMap(([c,d])=>{let e=eT(a,{_tag:"KeyName",name:c}),f=b(e,d);return 0===f.length?eL([e,""]):f});return d(fd(),a)})(b??{}),([a,b])=>[(a=>{let b=[],c=0;for(;c<a.length;){let d=a[c];if("KeyName"===d._tag)if(c+1<a.length){let e=a[c+1];"KeyIndex"===e._tag?(b.push(`${d.name}[${e.index}]`),c+=2):(b.push(d.name),c+=1)}else b.push(d.name),c+=1}return b})(a).join("\uFEFF"),b])),{pathDelim:"\uFEFF",seqDelim:"\uFEFF"}).pipe(n6(()=>PL))))))))(c.config?.fetch,c.config),f=xQ(()=>e.runtime().then(Nu));return async(...g)=>await f.pipe(xU(((...b)=>lp(xQ(()=>e.runPromise(((a,b)=>xP(function*(){let c,d=yield*PM,e=yield*uq(ea(c=a.router),a=>lp(d6(c[a].routerConfig),b=>({slug:a,config:b}))),f=a.config?.handleDaemonPromise?a.config.handleDaemonPromise:d?"void":"await";if(d&&"await"===f)return yield*new ed({code:"INVALID_SERVER_CONFIG",message:'handleDaemonPromise: "await" is forbidden in development.'});let g=xP(function*(){return yield*Ma(e)}),h=xP(function*(){var c;let d,e,{"uploadthing-hook":g,"x-uploadthing-package":h,"x-uploadthing-version":i}=yield*lb(Ni,((a,b)=>{let c=Bn(a,b);return a=>c(a.headers)})(B5({"uploadthing-hook":Do.pipe(B0),"x-uploadthing-package":BA.pipe(B1({default:()=>"unknown"})),"x-uploadthing-version":BA.pipe(B1({default:()=>U}))}),c));i!==U&&(yield*pO("Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.").pipe(px({clientVersion:i,serverVersion:U})));let{slug:j,actionType:k}=yield*((a,b)=>{let c=Bn(a,b);return lb(nn,a=>{let b=bV(a,Nj),d=bV(a,OG);return c({...b,...d.params})})})(B5({actionType:Dn.pipe(B0),slug:BA})),l=a.router[j];if(!l){let a=`No file route found for slug ${j}`;return yield*pP(a),yield*new ed({code:"NOT_FOUND",message:a})}let{body:m,fiber:n}=yield*OW(d={actionType:k,uploadthingHook:g},ds(d)).pipe(O$({actionType:"upload",uploadthingHook:void 0},()=>P2({uploadable:l,fePackage:h,beAdapter:b,slug:j})),O$({actionType:void 0,uploadthingHook:"callback"},()=>P1({uploadable:l,fePackage:h,beAdapter:b})),O$({actionType:void 0,uploadthingHook:"error"},()=>P0({uploadable:l})),(e=()=>ly({body:null,fiber:null}),a=>{let b=OZ(a);return dp(b)?"Right"===b._tag?b.right:e(b.left):a=>{let c=b(a);return"Right"===c._tag?c.right:e(c.left)}}));return n&&(yield*pM("Running fiber as daemon").pipe(px("handleDaemon",f)),"void"===f||("await"===f?yield*n.await:"function"==typeof f&&f(vX(n.await)))),yield*pM("Sending response").pipe(px("body",m)),yield*Ma(m)}).pipe(pC({ParseError:b=>Ma(PQ(new ed({code:"BAD_REQUEST",message:"Invalid input",cause:b.message}),a.router),{status:400}),UploadThingError:b=>Ma(PQ(b,a.router),{status:ec[b.code]})})),i=lp(L9("x-uploadthing-version",U));return ON.pipe(OQ("*",g),OR("*",h),OS(i))}).pipe(pQ("createRequestHandler")))(c,d??"custom"))),pV(P_,a(...b))))(...g)),xU(b(...g)),pQ("requestHandler"),e.runPromise)})(a=>ly({req:a}),a=>ly(a),a,"nextjs-app");return{POST:b,GET:b}})({router:{imageUploader:P4({image:{maxFileSize:"2MB",maxFileCount:1}}).middleware(async()=>{let a=await (0,P3.J)();if(!a.id)throw new ed("Unauthorized");return{userId:a.id}}).onUploadComplete(async({metadata:a,file:b})=>(console.log("Image upload complete for userId:",a.userId),console.log("File URL:",b.ufsUrl),{uploadedBy:a.userId})),resumeUploader:P4({"application/pdf":{maxFileSize:"4MB",maxFileCount:1}}).middleware(async()=>{let a=await (0,P3.J)();if(!a.id)throw new ed("Unauthorized");return{userId:a.id}}).onUploadComplete(async({metadata:a,file:b})=>(console.log("Resume upload complete for userId:",a.userId),console.log("File URL:",b.ufsUrl),{uploadedBy:a.userId}))}}),P7=new E.AppRouteRouteModule({definition:{kind:F.RouteKind.APP_ROUTE,page:"/api/uploadthing/route",pathname:"/api/uploadthing",filename:"route",bundlePath:"app/api/uploadthing/route"},distDir:".next",projectDir:"",resolvedPagePath:"C:\\Users\\Adminitss\\Desktop\\sikuruhate01\\30082025\\CarSalesAInew\\src\\app\\api\\uploadthing\\route.ts",nextConfigOutput:"",userland:D}),{workAsyncStorage:P8,workUnitAsyncStorage:P9,serverHooks:Qa}=P7;function Qb(){return(0,G.patchFetch)({workAsyncStorage:P8,workUnitAsyncStorage:P9})}async function Qc(a,b,c){var d;let e="/api/uploadthing/route";"/index"===e&&(e="/");let f=await P7.prepare(a,b,{srcPage:e,multiZoneDraftMode:"false"});if(!f)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:h,nextConfig:i,isDraftMode:j,prerenderManifest:k,routerServerContext:l,isOnDemandRevalidate:m,revalidateOnlyGenerated:n,resolvedPathname:o}=f,p=(0,J.normalizeAppPath)(e),q=!!(k.dynamicRoutes[p]||k.routes[o]);if(q&&!j){let a=!!k.routes[o],b=k.dynamicRoutes[p];if(b&&!1===b.fallback&&!a)throw new S.NoFallbackError}let r=null;!q||P7.isDev||j||(r="/index"===(r=o)?"/":r);let s=!0===P7.isDev||!q,t=q&&!s,u=a.method||"GET",v=(0,I.getTracer)(),w=v.getActiveScopeSpan(),x={params:h,prerenderManifest:k,renderOpts:{experimental:{dynamicIO:!!i.experimental.dynamicIO,authInterrupts:!!i.experimental.authInterrupts},supportsDynamicResponse:s,incrementalCache:(0,H.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=i.experimental)?void 0:d.cacheLife,isRevalidate:t,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>P7.onRequestError(a,b,d,l)},sharedContext:{buildId:g}},y=new K.NodeNextRequest(a),z=new K.NodeNextResponse(b),A=L.NextRequestAdapter.fromNodeNextRequest(y,(0,L.signalFromNodeResponse)(b));try{let d=async c=>P7.handle(A,x).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=v.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==M.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${u} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${u} ${a.url}`)}),f=async f=>{var g,h;let o=async({previousCacheEntry:g})=>{try{if(!(0,H.getRequestMeta)(a,"minimalMode")&&m&&n&&!g)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(f);a.fetchMetrics=x.renderOpts.fetchMetrics;let h=x.renderOpts.pendingWaitUntil;h&&c.waitUntil&&(c.waitUntil(h),h=void 0);let i=x.renderOpts.collectedTags;if(!q)return await (0,O.I)(y,z,e,x.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,P.toNodeOutgoingHttpHeaders)(e.headers);i&&(b[R.NEXT_CACHE_TAGS_HEADER]=i),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==x.renderOpts.collectedRevalidate&&!(x.renderOpts.collectedRevalidate>=R.INFINITE_CACHE)&&x.renderOpts.collectedRevalidate,d=void 0===x.renderOpts.collectedExpire||x.renderOpts.collectedExpire>=R.INFINITE_CACHE?void 0:x.renderOpts.collectedExpire;return{value:{kind:T.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==g?void 0:g.isStale)&&await P7.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,N.c)({isRevalidate:t,isOnDemandRevalidate:m})},l),b}},p=await P7.handleResponse({req:a,nextConfig:i,cacheKey:r,routeKind:F.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:m,revalidateOnlyGenerated:n,responseGenerator:o,waitUntil:c.waitUntil});if(!q)return null;if((null==p||null==(g=p.value)?void 0:g.kind)!==T.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(h=p.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,H.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",m?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),j&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let s=(0,P.fromNodeOutgoingHttpHeaders)(p.value.headers);return(0,H.getRequestMeta)(a,"minimalMode")&&q||s.delete(R.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||b.getHeader("Cache-Control")||s.get("Cache-Control")||s.set("Cache-Control",(0,Q.getCacheControlHeader)(p.cacheControl)),await (0,O.I)(y,z,new Response(p.value.body,{headers:s,status:p.value.status||200})),null};w?await f(w):await v.withPropagatedContext(a.headers,()=>v.trace(M.BaseServerSpan.handleRequest,{spanName:`${u} ${a.url}`,kind:I.SpanKind.SERVER,attributes:{"http.method":u,"http.target":a.url}},f))}catch(b){if(w||b instanceof S.NoFallbackError||await P7.onRequestError(a,b,{routerKind:"App Router",routePath:p,routeType:"route",revalidateReason:(0,N.c)({isRevalidate:t,isOnDemandRevalidate:m})}),q)throw b;return await (0,O.I)(y,z,new Response(null,{status:500})),null}}},72609:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{describeHasCheckingStringProperty:function(){return e},describeStringPropertyAccess:function(){return d},wellKnownProperties:function(){return f}});let c=/^[A-Za-z_$][A-Za-z0-9_$]*$/;function d(a,b){return c.test(b)?"`"+a+"."+b+"`":"`"+a+"["+JSON.stringify(b)+"]`"}function e(a,b){let c=JSON.stringify(b);return"`Reflect.has("+a+", "+c+")`, `"+c+" in "+a+"`, or similar"}let f=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","valueOf","toLocaleString","then","catch","finally","status","displayName","_debugInfo","toJSON","$$typeof","__esModule"])},76926:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(c(61120));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}let f={current:null},g="function"==typeof d.cache?d.cache:a=>a,h=console.warn;function i(a){return function(...b){h(a(...b))}}g(a=>{try{h(f.current)}finally{f.current=null}})},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96330:a=>{"use strict";a.exports=require("@prisma/client")},96487:()=>{},96559:(a,b,c)=>{"use strict";a.exports=c(44870)}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[73,190,999,68],()=>b(b.s=68687));module.exports=c})();